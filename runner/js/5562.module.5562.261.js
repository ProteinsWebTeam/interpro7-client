"use strict";(self.webpackChunkinterpro7_client=self.webpackChunkinterpro7_client||[]).push([[5562],{5562:(t,e,i)=>{i.d(e,{Z:()=>H}),i(64043),i(22462),i(752),i(76265),i(60429),i(278),i(268),i(51090);var a,r,s,n,o,l=i(77601),h=(i(86111),i(3950)),d=(i(48903),i(58457),i(86647)),c=i(77062),u=i(84041),g=(i(86544),function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(t,i):r?r.value=i:e.set(t,i),i}),p=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)};class f extends u.HQ{constructor(t){var{expanded:e,padding:i}=t;super(function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(t);r<a.length;r++)e.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(t,a[r])&&(i[a[r]]=t[a[r]])}return i}(t,["expanded","padding"])),a.add(this),s.set(this,new Map),n.set(this,new Map),this.maxYPos=0,this.expanded=!1,this.padding=1,this.expanded=e,this.padding=i}init(t,e){var i,r=0;if(g(this,s,new Map,"f"),g(this,n,new Map,"f"),this.maxYPos=0,t){for(var l={},h=0;h<t.length;h++){var d=t[h],c=(null===(i=null==d?void 0:d.residues)||void 0===i?void 0:i.length)||(null==e?void 0:e.length);p(this,s,"f").set(d.accession,c&&!this.expanded?16:14),p(this,n,"f").set(d.accession,this.padding),r=(p(this,s,"f").get(d.accession)||0)+2*this.padding,this.maxYPos=Math.max(this.maxYPos,r),d.accession in l||(l[d.accession]={}),d.residues&&(r=p(this,a,"m",o).call(this,d.residues,d.accession,this.expanded?r:p(this,n,"f").get(d.accession)||0,h,3,d.locations,l,this.expanded))}if(e)for(var u=0;u<e.length;u++){var f=e[u];p(this,s,"f").has(f.accession)||(p(this,s,"f").set(f.accession,10),p(this,n,"f").set(f.accession,(this.expanded?this.maxYPos:3)+this.padding),r+=this.expanded?2*this.padding+(p(this,s,"f").get(f.accession)||14):0,this.maxYPos=Math.max(this.maxYPos,r)),f.accession in l||(l[f.accession]={}),f.residues&&(r=p(this,a,"m",o).call(this,f.residues,f.accession,f.expanded?r:p(this,n,"f").get(f.accession)||0,u,3,f.locations,l,this.expanded&&f.expanded))}this.maxYPos+=this.padding}}static filterOutResidueFragmentsOutOfLocation(t,e){t.locations.forEach((t=>t.fragments=t.fragments.filter((t=>e.some((e=>e.fragments.some((e=>t.start>=e.start&&t.end<=e.end)))))))),t.locations=t.locations.filter((t=>t.fragments.length))}static getAccFromFeature(t){var e="";return"string"==typeof t?e=t:t.accession&&(e=t.accession),e}getFeatureYPos(t){var e=r.getAccFromFeature(t);return p(this,n,"f").get(e)||0}getFeatureHeight(t){var e=r.getAccFromFeature(t);return p(this,s,"f").get(e)||0}}r=f,s=new WeakMap,n=new WeakMap,a=new WeakSet,o=function(t,e,i,a,o,l,h,d){void 0===h&&(h={}),void 0===d&&(d=!0);for(var c=0;c<t.length;c++){var u=t[c];r.filterOutResidueFragmentsOutOfLocation(u,l||[]),u.accession in h[e]||(h[e][u.accession]={});for(var g=0;g<u.locations.length;g++){var f=u.locations[g].description;f in h[e][u.accession]||(h[e][u.accession][f]={height:d?10:(p(this,s,"f").get(e)||14)-2*o,yPos:d?this.maxYPos+this.padding:i+o},i=d?this.maxYPos+2*this.padding+10:i),p(this,s,"f").set(u.accession+"_"+a+"_"+c+"_"+g,h[e][u.accession][f].height),p(this,n,"f").set(u.accession+"_"+a+"_"+c+"_"+g,h[e][u.accession][f].yPos),this.maxYPos=Math.max(this.maxYPos,i)}}return d?i:this.maxYPos+2*this.padding};const m=f;var v,b,y,w,C,x,F,O,S=(t,e)=>{var i=Object.assign({value:1},t),a=[];for(var r of e)i?i.end<r.start?(a.push(i),i=null,a.push(r)):i.start<r.start&&i.end>=r.end?(a.push({start:i.start,end:r.start-1,value:i.value}),a.push({start:r.start,end:r.end,value:(r.value||0)+((null==i?void 0:i.value)||0)}),i=r.end===i.end?null:{start:r.end+1,end:i.end,value:i.value}):r.start<i.start&&r.end>i.end?(a.push({start:r.start,end:i.start-1,value:r.value}),a.push({start:i.start,end:i.end,value:(r.value||0)+((null==i?void 0:i.value)||0)}),a.push({start:i.end+1,end:r.end,value:r.value}),i=null):r.end>=i.start&&r.end<=i.end?(r.start<i.start&&a.push({start:r.start,end:i.start-1,value:r.value}),a.push({start:i.start,end:r.end,value:(r.value||0)+((null==i?void 0:i.value)||0)}),i=r.end<i.end?{start:r.end+1,end:i.end,value:i.value}:null):i.end>=r.start&&i.end<r.end?(a.push({start:i.start,end:r.start-1,value:i.value}),a.push({start:r.start,end:i.end,value:(r.value||0)+((null==i?void 0:i.value)||0)}),a.push({start:i.end+1,end:r.end,value:r.value}),i=null):a.push(r):a.push(r);return i&&a.push(i),a},j=t=>t.selectAll("g.residues-group").data((t=>{var e;return(null===(e=t.residues)||void 0===e?void 0:e.map(((e,i)=>Object.assign(Object.assign({},e),{feature:t,i}))))||[]})).enter().append("g").attr("class","residues-group").selectAll("g.residues-locations").data((t=>t.locations.map(((e,i)=>Object.assign(Object.assign({},e),{accession:t.accession,feature:t.feature,location:e,i:t.i,j:i}))))).enter().append("g").attr("class","residues-locations"),P=t=>{var{baseG:e,getResidueShape:i,getResidueTransform:a,getResidueFill:r,element:s}=t;return e.selectAll("path.residue").data((t=>t.fragments.map((e=>Object.assign(Object.assign({},e),{accession:t.accession,feature:Object.assign(Object.assign({},t.feature),{currentResidue:Object.assign(Object.assign({},e),{description:t.location.description})}),location:t.location,k:t.feature.k,i:t.i,j:t.j}))))).enter().append("path").attr("class","feature rectangle residue").attr("d",i).attr("transform",a).attr("fill",r).attr("stroke","transparent").call(c.sQ,s)},T=t=>{var{baseG:e,expanded:i,getResidueShape:a,getResidueTransform:r,getResidueFill:s}=t,n=e.selectAll("path.residue"),o=new Set(n.data().map((t=>{var e,i;return(null===(e=t.feature)||void 0===e?void 0:e.accession)+"-"+(null===(i=t.location)||void 0===i?void 0:i.description)}))).size;n.attr("d",a).attr("transform",r).style("pointer-events",(t=>i||t.feature&&t.feature.expanded?"auto":"none")).style("stroke",(()=>i?null:"none")).style("opacity",(()=>i?null:.8/o)).attr("fill",s)},M=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},R=function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(t,i):r?r.value=i:e.set(t,i),i},E=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},k={},L=O=class extends u.ZP{constructor(){super(),this.expanded=!1,this["show-label"]=!1,this.label=null,this.layout=void 0,v.set(this,void 0),b.set(this,void 0),y.set(this,!1),w.set(this,void 0),C.set(this,void 0),x.set(this,void 0),F.set(this,void 0),this["margin-top"]=2,this["margin-bottom"]=2}createTrack(){this.layoutObj&&(this.layoutObj.expanded=!!this.expanded,R(this,w,void 0,"f"),super.createTrack())}connectedCallback(){super.connectedCallback(),R(this,y,!1,"f")}attributeChangedCallback(t,e,i){if(super.attributeChangedCallback(t,e,i),"expanded"===t&&e!==i&&E(this,v,"f"))for(var a of E(this,v,"f"))a.expanded=!e}set contributors(t){R(this,v,O.normalizeLocations(t),"f"),R(this,b,function(t,e,i){void 0===e&&(e=100),void 0===i&&(i=!0);var a=[];return i&&(a=S({start:1,end:e,value:0},a)),t.forEach((t=>{var e;return null===(e=t.locations)||void 0===e?void 0:e.forEach((t=>t.fragments.forEach((t=>{a=S(t,a)}))))})),a}(E(this,v,"f"),this.length),"f"),this.data&&this.createTrack()}getLayout(){return new m({layoutHeight:this.height,expanded:!!this.expanded,padding:(this["margin-top"]+this["margin-bottom"])/2})}createFeatures(){var t,e,i,a,r,s;if(this.seqG){null===(t=this.layoutObj)||void 0===t||t.init(this.data,E(this,v,"f")),this.data.forEach(((t,e)=>t.k=e)),R(this,C,this.seqG.selectAll("g.feature-group").data(this.data).enter().append("g").attr("class","feature-group").attr("id",(t=>"g_"+t.accession)),"f");var n=E(this,C,"f").selectAll("g.location-group").data((t=>{var e;return(null===(e=t.locations)||void 0===e?void 0:e.map((e=>Object.assign(Object.assign({},e),{feature:t}))))||[]})).enter().append("g").attr("class","location-group").style("cursor",E(this,v,"f")?"pointer":"default");if(n.selectAll("line.cover").data((t=>[t.fragments.reduce(((e,i)=>({start:Math.min(e.start,i.start),end:Math.max(e.end,i.end),feature:t.feature})),{start:1/0,end:-1/0})])).enter().append("line").attr("class","cover"),n.selectAll("path.feature").data((t=>t.fragments.map((e=>Object.assign(Object.assign({},e),{feature:t.feature,fragments:t.fragments}))))).enter().append("path").attr("class",(t=>this.getShape(t)+" feature")).on("click.expanded",(()=>{this.expanded?this.removeAttribute("expanded"):this.setAttribute("expanded","expanded")})).call(c.sQ,this),n.selectAll("text.feature-label").data((t=>t.fragments.map((e=>Object.assign(Object.assign({},e),{feature:t.feature,fragments:t.fragments}))))).enter().append("text").attr("class","feature-label").attr("dominant-baseline","middle").attr("text-anchor","middle").style("cursor","inherit").style("pointer-events","none"),R(this,x,j(E(this,C,"f")),"f"),P({baseG:E(this,x,"f"),getResidueShape:t=>this.getResidueShape(t),getResidueTransform:t=>this.getResidueTransform(t),getResidueFill:t=>this.getResidueFill(t,!!this.expanded),element:this}),E(this,v,"f")){E(this,v,"f").forEach(((t,e)=>t.k=e)),E(this,w,"f")||R(this,w,null===(e=this.svg)||void 0===e?void 0:e.append("g").attr("class","children-features"),"f");var o=null===(i=E(this,w,"f"))||void 0===i?void 0:i.append("g").attr("class","children-group"),l=null==o?void 0:o.selectAll("g.child-group").data(E(this,v,"f")).enter().append("g").attr("class","child-group");if(!l)return;var h=l.selectAll("g.child-location-group").data((t=>(t.expanded=this.expanded,(t.locations||[]).map((e=>Object.assign(Object.assign({},e),{feature:t})))))).enter().append("g").attr("class",((t,e)=>"child-location-group clg-"+e));null==h||h.selectAll("line.cover").data((t=>[t.fragments.reduce(((e,i)=>({start:Math.min(e.start,i.start),end:Math.max(e.end,i.end),feature:t.feature})),{start:1/0,end:-1/0})])).enter().append("line").attr("class","cover"),null==h||h.selectAll("path.child-fragment").data((t=>t.fragments.map((e=>Object.assign(Object.assign({},e),{feature:t.feature,fragments:t.fragments}))))).enter().append("path").attr("class",(t=>this.getShape(t)+" child-fragment feature")).call(c.sQ,this).on("click.expanded",((t,e)=>{e.feature.expanded=!e.feature.expanded,this.refresh()})),h.selectAll("text.child-label").data((t=>t.fragments.map((e=>Object.assign(Object.assign({},e),{feature:t.feature,fragments:t.fragments}))))).enter().append("text").attr("class","child-label").attr("dominant-baseline","middle").attr("text-anchor","middle").style("cursor","default").style("pointer-events","none"),R(this,F,j(l),"f"),P({baseG:E(this,F,"f"),getResidueShape:t=>this.getResidueShape(t),getResidueTransform:t=>this.getResidueTransform(t),getResidueFill:t=>{var e;return this.getResidueFill(t,!!(null===(e=t.feature)||void 0===e?void 0:e.expanded))},element:this}),(null===(a=E(this,b,"f"))||void 0===a?void 0:a.length)&&(t=>{var e,i,a,r,{element:s,coverage:n}=t;s.accession=(null===(i=null===(e=null==s?void 0:s.data)||void 0===e?void 0:e[0])||void 0===i?void 0:i.accession)||"_";var o=null===(a=s.svg)||void 0===a?void 0:a.select("defs mask");(null==o?void 0:o.size())||(o=null===(r=s.svg)||void 0===r?void 0:r.append("defs").append("mask").attr("id","mask-"+s.accession)),null==o||o.selectAll("rect").data(n).enter().append("rect").attr("y",0).attr("height",s.height)})({element:this,coverage:E(this,b,"f")})}null===(r=this.svg)||void 0===r||r.attr("height",((null===(s=this.layoutObj)||void 0===s?void 0:s.maxYPos)||0)+this["margin-bottom"]),R(this,y,!0,"f")}}getResidueShape(t){var e;return this.featureShape.getFeatureShape(this.getSingleBaseWidth(),(null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureHeight(t.accession+"_"+t.k+"_"+t.i+"_"+t.j))||0,t.end&&t.start?t.end-t.start+1:1,"rectangle")}getResidueTransform(t){var e;return"translate("+this.getXFromSeqPosition(t.start||1)+","+(this["margin-top"]+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.accession+"_"+t.k+"_"+t.i+"_"+t.j))||0))+")"}getResidueFill(t,e){return e?this.getFeatureColor(t):"white"}getTextLabel(t){var e,i;return(null===(e=this.label)||void 0===e?void 0:e.length)?this.label.startsWith(".")?(0,d.Z)(t,this.label.slice(1),null):this.label:(null===(i=null==t?void 0:t.feature)||void 0===i?void 0:i.accession)||null}refreshLabels(t,e){var i,a,r,s,n;void 0===e&&(e=2),t.attr("x",(t=>{var e=A(this["display-start"],t.start),i=N(this["display-end"],t.end,this.length);return this.getXFromSeqPosition(e+(i-e)/2||1)})).attr("y",(t=>{var e,i;return this["margin-top"]+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+((null===(i=this.layoutObj)||void 0===i?void 0:i.getFeatureHeight(t.feature))||0)/2})).attr("fill",((t,e,i)=>{var a;return(null===(a=i[e].parentElement)||void 0===a?void 0:a.querySelector("path.feature"))?(0,c.en)(function(t){var e;if(k[t])return k[t];var i=document.createElement("div");i.style.color=t,document.body.appendChild(i);var a=window.getComputedStyle(i).color;document.body.removeChild(i);var r=(null===(e=null==a?void 0:a.match(/[.\d]+/g))||void 0===e?void 0:e.map(Number))||null;return k[t]=r,r}(this.getFeatureFillColor(t))):null})).attr("font-size",(t=>{var i;return((null===(i=this.layoutObj)||void 0===i?void 0:i.getFeatureHeight(t.feature))||2)-e})).text((t=>this["show-label"]?this.getTextLabel(t):null)).each((i=this["display-start"],a=this["display-end"],r=this.length,s=t=>this.getXFromSeqPosition(t),n=t=>{var e;return(null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureHeight(t))||0},function(t){for(var e,o,l,d=(0,h.Ys)(this),c=A(i,t.start),u=N(a,t.end,r),g=s(u)-s(c),p=n(t.feature)/2,f=(null===(o=null===(e=d.node())||void 0===e?void 0:e.getComputedTextLength)||void 0===o?void 0:o.call(e))||0,m=d.text();f>g-2*p&&m.length>0;)m=m.slice(0,-1),d.text(m.length?m+"â€¦":""),f=(null===(l=d.node())||void 0===l?void 0:l.getComputedTextLength())||0}))}refreshFeatures(t,e){void 0===e&&(e=!0);var i=new Set(t.data().map((t=>{var e;return null===(e=t.feature)||void 0===e?void 0:e.accession}))).size;t.attr("d",(t=>{var i;return this.featureShape.getFeatureShape(this.getSingleBaseWidth(),(null===(i=this.layoutObj)||void 0===i?void 0:i.getFeatureHeight(t.feature||""))||0,t.end&&t.start?t.end-t.start+1:1,e?this.getShape(t.shape?t:t.feature):"rectangle")})).style("fill",(t=>e?this.getFeatureColor(t.feature):"white")).attr("opacity",e?1:.8/i).style("stroke",(t=>e?this.getFeatureColor(t.feature):"none")).attr("transform",(t=>{var e;return"translate("+this.getXFromSeqPosition(t.start||1)+","+(this["margin-top"]+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0))+")"})).style("pointer-events",e?"auto":"none")}refreshCoverLine(t,e){void 0===e&&(e=!0),t.attr("x1",(t=>this.getXFromSeqPosition(t.start||1))).attr("x2",(t=>this.getXFromSeqPosition((t.end||0)+1))).attr("y1",(t=>{var e,i;return this["margin-top"]+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+((null===(i=this.layoutObj)||void 0===i?void 0:i.getFeatureHeight(t.feature))||0)/2})).attr("y2",(t=>{var e,i;return this["margin-top"]+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+((null===(i=this.layoutObj)||void 0===i?void 0:i.getFeatureHeight(t.feature))||0)/2})).attr("stroke",(t=>this.getFeatureColor(t.feature))).attr("visibility",e?"visible":"hidden")}refresh(){var t,e,i,a,r,s,n,o;if(E(this,y,"f")&&this.layoutObj){if(this.layoutObj.expanded=!!this.expanded,this.layoutObj.init(this.data,E(this,v,"f")),this.height=this.layoutObj.maxYPos,this.refreshCoverLine(null===(t=E(this,C,"f"))||void 0===t?void 0:t.selectAll("g.location-group line.cover")),this.refreshFeatures(null===(e=E(this,C,"f"))||void 0===e?void 0:e.selectAll("g.location-group path.feature")),this.refreshLabels(null===(i=E(this,C,"f"))||void 0===i?void 0:i.selectAll("g.location-group text.feature-label")),E(this,x,"f")&&T({baseG:E(this,x,"f"),expanded:!!this.expanded,getResidueShape:t=>this.getResidueShape(t),getResidueTransform:t=>this.getResidueTransform(t),getResidueFill:t=>this.getResidueFill(t,!!this.expanded)}),E(this,v,"f")){var l=null===(a=E(this,w,"f"))||void 0===a?void 0:a.select("g.children-group");null==l||l.attr("visibility",this.expanded?"visible":"hidden");var h=null==l?void 0:l.selectAll("g.child-group"),d=null==h?void 0:h.selectAll("g.child-location-group"),c=null==d?void 0:d.selectAll("line.cover"),u=null==d?void 0:d.selectAll("path.child-fragment");this.refreshCoverLine(c,this.expanded),this.refreshFeatures(u,this.expanded),this.refreshLabels(null==h?void 0:h.selectAll("g.child-location-group text.child-label"),0),null===(r=E(this,F,"f"))||void 0===r||r.attr("visibility",(()=>this.expanded?"visible":"hidden")),E(this,F,"f")&&T({baseG:E(this,F,"f"),expanded:!!this.expanded,getResidueShape:t=>this.getResidueShape(t),getResidueTransform:t=>this.getResidueTransform(t),getResidueFill:t=>{var e;return this.getResidueFill(t,!!(null===(e=t.feature)||void 0===e?void 0:e.expanded))}}),(null===(s=E(this,b,"f"))||void 0===s?void 0:s.length)&&(t=>{var e,{element:i,featuresG:a,contributorsLength:r}=t;null==a||a.attr("mask",i.expanded?null:"url(#mask-"+i.accession+")"),null===(e=i.svg)||void 0===e||e.selectAll("defs mask rect").attr("x",(t=>i.getXFromSeqPosition(t.start))).attr("width",(t=>i.getSingleBaseWidth()*(t.end-t.start+1))).attr("height",i.height).attr("fill","white").attr("opacity",(t=>((t.value||0)/(r||1)+.3)/1.3))})({element:this,featuresG:E(this,C,"f"),contributorsLength:null===(n=E(this,v,"f"))||void 0===n?void 0:n.length})}null===(o=this.svg)||void 0===o||o.attr("height",this.layoutObj.maxYPos+this["margin-bottom"]),this.updateHighlight(),this.renderMarginOnGroup(this.margins)}}};function A(t,e){var i=t&&t>0?t:0;return Math.max(e||0,i)}function N(t,e,i){var a=t&&t>0?t:i||0;return Math.min(e||0,a)}v=new WeakMap,b=new WeakMap,y=new WeakMap,w=new WeakMap,C=new WeakMap,x=new WeakMap,F=new WeakMap,M([(0,l.Cb)({type:Boolean})],L.prototype,"expanded",void 0),M([(0,l.Cb)({type:Boolean})],L.prototype,"show-label",void 0),M([(0,l.Cb)({type:String})],L.prototype,"label",void 0);const H=L=O=M([(0,l.Mo)("nightingale-interpro-track")],L)},77062:(t,e,i)=>{i.d(e,{sQ:()=>H,en:()=>D,y_:()=>W,ZP:()=>q,U6:()=>s,Rn:()=>j,YD:()=>y,vl:()=>p,Ds:()=>h,tG:()=>b,U_:()=>L,_5:()=>k}),i(752),i(76265);var a=i(77601),r=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n};const s=(t,e)=>{class i extends t{constructor(){super(...arguments),this.width=null==e?void 0:e.width,this.height=null==e?void 0:e.height}}return r([(0,a.Cb)({type:Number})],i.prototype,"width",void 0),r([(0,a.Cb)({type:Number,reflect:!0})],i.prototype,"height",void 0),i};i(60429),i(51090);var n=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},o=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},l={"display-start":1,"display-end":-1,length:0};const h=function(t,e){var i,r;void 0===e&&(e={});class s extends t{constructor(){super(...arguments),i.set(this,Object.assign(Object.assign({},l),e)),r.set(this,o(this,i,"f").length),this["display-start"]=o(this,i,"f")["display-start"],this["display-end"]=o(this,i,"f")["display-end"]}get length(){return o(this,r,"f")}set length(t){(function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?r.call(t,i):r?r.value=i:e.set(t,i)})(this,r,t,"f"),(this["display-end"]||0)>o(this,r,"f")&&(this["display-end"]=this.length)}}return i=new WeakMap,r=new WeakMap,n([(0,a.Cb)({type:Number,reflect:!0})],s.prototype,"length",null),n([(0,a.Cb)({type:Number,reflect:!0})],s.prototype,"display-start",void 0),n([(0,a.Cb)({type:Number,reflect:!0})],s.prototype,"display-end",void 0),s};var d=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},c=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},u="#FFFFFFDD",g={"margin-top":0,"margin-bottom":0,"margin-left":10,"margin-right":10,"margin-color":u};const p=function(t,e){var i,r;void 0===e&&(e={});class n extends(s(t)){constructor(){super(...arguments),i.set(this,Object.assign(Object.assign({},g),e)),this["margin-top"]=c(this,i,"f")["margin-top"],this["margin-bottom"]=c(this,i,"f")["margin-bottom"],this["margin-left"]=c(this,i,"f")["margin-left"],this["margin-right"]=c(this,i,"f")["margin-right"],this["margin-color"]=c(this,i,"f")["margin-color"],r.set(this,!1)}getWidthWithMargins(){return this.width?this.width-this["margin-left"]-this["margin-right"]:0}getHeightWithMargins(){return this.height?this.height-this["margin-top"]-this["margin-bottom"]:0}renderMarginOnGroup(t){t&&(c(this,r,"f")&&!t.select("rect").empty()||(t.append("rect").style("pointer-events","none").attr("class","margin-left").attr("x",0),t.append("rect").style("pointer-events","none").attr("class","margin-right"),t.append("rect").style("pointer-events","none").attr("class","margin-top").attr("width",this.width).attr("x",0).attr("y",0),t.append("rect").style("pointer-events","none").attr("class","margin-bottom").attr("width",this.width).attr("x",0),function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?r.call(t,i):r?r.value=i:e.set(t,i)}(this,r,!0,"f")),t.select("rect.margin-left").attr("fill",this["margin-color"]||u).attr("height",this.height).attr("width",this["margin-left"]),t.select("rect.margin-right").attr("fill",this["margin-color"]||u).attr("height",this.height).attr("x",this.width-this["margin-right"]).attr("width",this["margin-right"]),t.select("rect.margin-top").attr("fill",this["margin-color"]||u).attr("height",this["margin-top"]),t.select("rect.margin-bottom").attr("fill",this["margin-color"]||u).attr("y",this.height-this["margin-bottom"]).attr("height",this["margin-bottom"]))}}return i=new WeakMap,r=new WeakMap,d([(0,a.Cb)({type:Number})],n.prototype,"margin-top",void 0),d([(0,a.Cb)({type:Number})],n.prototype,"margin-bottom",void 0),d([(0,a.Cb)({type:Number})],n.prototype,"margin-left",void 0),d([(0,a.Cb)({type:Number})],n.prototype,"margin-right",void 0),d([(0,a.Cb)({type:String})],n.prototype,"margin-color",void 0),n};var f=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},m=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},v={"min-width":10,"min-height":10};const b=function(t,e){var i,r;void 0===e&&(e={});class n extends(s(t)){constructor(){super(...arguments),i.set(this,Object.assign(Object.assign({},v),e)),r.set(this,void 0),this["min-width"]=m(this,i,"f")["min-width"],this["min-height"]=m(this,i,"f")["min-height"],this.onResize=this.onResize.bind(this),this.listenForResize=this.listenForResize.bind(this)}useAvailableWidth(){null===this.getAttribute("width")&&(this.style.width="100%",this.width=Math.max(this.offsetWidth,this["min-width"]))}useAvailableHeight(){null===this.getAttribute("height")&&(this.style.height="100%",this.height=Math.max(this.offsetHeight,this["min-height"]))}onDimensionsChange(){}connectedCallback(){this.useAvailableWidth(),this.useAvailableHeight(),this.listenForResize(),super.connectedCallback()}disconnectedCallback(){m(this,r,"f")&&m(this,r,"f").unobserve(this),super.disconnectedCallback()}onResize(){var t=this.width,e=this.height;this.useAvailableWidth(),this.useAvailableHeight(),t===this.width&&e===this.height||this.onDimensionsChange()}listenForResize(){(function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?r.call(t,i):r?r.value=i:e.set(t,i)})(this,r,new ResizeObserver(this.onResize),"f"),m(this,r,"f").observe(this)}}return i=new WeakMap,r=new WeakMap,f([(0,a.Cb)({type:Number,reflect:!0})],n.prototype,"min-width",void 0),f([(0,a.Cb)({type:Number,reflect:!0})],n.prototype,"min-height",void 0),n},y=t=>class extends t{connectedCallback(){this.closest("nightingale-manager")&&customElements.whenDefined("nightingale-manager").then((()=>{this.manager=this.closest("nightingale-manager"),this.manager&&this.manager.register(this)})),super.connectedCallback()}disconnectedCallback(){this.manager&&this.manager.unregister(this),super.disconnectedCallback()}};class w{constructor(t){var{min:e=-1/0,max:i=1/0}=void 0===t?{}:t;this.segments=[],this.max=i,this.min=e,this.regionString=null}encode(t){return void 0===t&&(t=!1),this.segments.map((e=>{var{start:i,end:a}=e;return t?i+":"+a:(i===this.min?"":i)+":"+(a===this.max?"":a)})).join(",")}decode(t){void 0!==t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map((t=>{var[e,i,a]=t.split(":");if(void 0!==a)throw new Error("there should be at most 1 ':' per region. Region: "+t);var r=e?Number(e):this.min,s=i?Number(i):this.max;if(r>s&&([r,s]=[s,r]),r<this.min&&(r=this.min),s>this.max&&(s=this.max),Number.isNaN(r))throw new Error("The parsed value of "+e+" is NaN. Region: "+t);if(Number.isNaN(s))throw new Error("The parsed value of "+i+" is NaN. Region: "+t);return{start:r,end:s}})):this.segments=[]}}var C=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},x=function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(t,i):r?r.value=i:e.set(t,i),i},F=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},O=(t,e)=>t?e?t+","+e:t:e,S={highlight:null,"highlight-color":"#FFEB3B66"};const j=function(t,e){var i,r;void 0===e&&(e={});class s extends t{constructor(){super(...arguments),i.set(this,Object.assign(Object.assign({},S),e)),this.highlight=F(this,i,"f").highlight,this["highlight-color"]=F(this,i,"f")["highlight-color"],r.set(this,void 0),this.highlightedRegion=new w({min:1}),x(this,r,null,"f")}set fixedHighlight(t){x(this,r,t,"f"),this.highlightedRegion.decode(O(this.highlight||"",F(this,r,"f")||"")),this.updateHighlight()}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i),"null"===i&&(i=null),e!==i&&("length"===t&&(this.highlightedRegion.max=Number(i)),"highlight"===t&&this.highlightedRegion.decode(O(i||"",F(this,r,"f")||"")))}updateHighlight(){}}return i=new WeakMap,r=new WeakMap,C([(0,a.Cb)({type:String,reflect:!0})],s.prototype,"highlight",void 0),C([(0,a.Cb)({type:String,reflect:!0})],s.prototype,"highlight-color",void 0),s};i(86111);var P=i(80767),T=i(3950),M=(i(48903),i(58457)),R=(i(76801),function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n}),E=["length","width","height"];const k=t=>{class e extends(p(h(b(s(t))))){constructor(){super(...arguments),this["use-ctrl-to-zoom"]=!1,this.updateScaleDomain=this.updateScaleDomain.bind(this),this._initZoom=this._initZoom.bind(this),this.zoomed=this.zoomed.bind(this),this._applyZoomTranslation=this.applyZoomTranslation.bind(this);var t=!1;this.applyZoomTranslation=()=>{t||(t=!0,requestAnimationFrame((()=>{t=!1,this._applyZoomTranslation()})))}}connectedCallback(){this.updateScaleDomain(),this._initZoom(),super.connectedCallback(),this.onDimensionsChange()}disconnectedCallback(){super.disconnectedCallback()}get zoom(){return this._zoom}set svg(t){t&&this._zoom&&(this._svg=t,t.call(this._zoom).on("dblclick.zoom",null),this.applyZoomTranslation())}get svg(){return this._svg}updateScaleDomain(){var t,e,i;this.xScale=(0,P.BY)().domain([1,(this.length||0)+1]).range([0,this.getWidthWithMargins()]),this.originXScale=null===(t=this.xScale)||void 0===t?void 0:t.copy(),this.tmpXScale=null===(e=this.xScale)||void 0===e?void 0:e.copy(),null===(i=this.zoom)||void 0===i||i.translateExtent([[0,0],[this.getWidthWithMargins(),0]])}_initZoom(){this._zoom=(0,M.sP)().scaleExtent([1,1/0]).translateExtent([[0,0],[this.getWidthWithMargins(),0]]).extent([[0,0],[this.getWidthWithMargins(),0]]).filter((t=>"wheel"!==(null==t?void 0:t.type)||!this["use-ctrl-to-zoom"]||t.ctrlKey)).on("zoom",this.zoomed)}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i),e!==("null"===i?null:i)&&(E.includes(t)&&this.updateScaleDomain(),this.applyZoomTranslation())}zoomed(t){var e;this.originXScale&&(this.tmpXScale=t.transform.rescaleX(this.originXScale));var[i,a]=(null===(e=null==this?void 0:this.tmpXScale)||void 0===e?void 0:e.domain())||[0,0];this.tmpXScale&&(this.dontDispatch?this.xScale=this.tmpXScale:this.dispatchEvent(new CustomEvent("change",{detail:{"display-start":Math.max(1,i),"display-end":Math.min(this.length||0,Math.max(a-1,i+1))},bubbles:!0,cancelable:!0})))}applyZoomTranslation(){if(this.svg&&this.originXScale){var t=Math.max(1,(this.length||0)/(1+(this["display-end"]||0)-(this["display-start"]||0))),e=-this.originXScale(this["display-start"]||0);this.dontDispatch=!0,this.zoom&&this.svg.call(this.zoom.transform,M.CR.scale(t).translate(e,0)),this.dontDispatch=!1,this.zoomRefreshed()}}zoomRefreshed(){super.render()}render(){return this.applyZoomTranslation(),super.render()}onDimensionsChange(){var t,e;super.onDimensionsChange(),null===(t=this.svg)||void 0===t||t.attr("width",this.width),null===(e=this.svg)||void 0===e||e.attr("height",this.height),this.updateScaleDomain(),this.applyZoomTranslation()}getXFromSeqPosition(t){return this.xScale?this["margin-left"]+this.xScale(t):-1}getSingleBaseWidth(){return this.xScale?this.xScale(2)-this.xScale(1):-1}}return R([(0,a.Cb)({type:Boolean})],e.prototype,"use-ctrl-to-zoom",void 0),e},L=t=>{class e extends(k(j(t))){createHighlightGroup(){var t=(0,T.Ys)(this).selectAll("svg");this.highlighted=t.append("g").attr("class","highlighted")}updateHighlight(){if(this.highlighted){var t=this.highlighted.selectAll("rect").data(this.highlightedRegion.segments);t.enter().append("rect").style("pointer-events","none").merge(t).attr("fill",this["highlight-color"]).attr("height",this.height).attr("x",(t=>this.getXFromSeqPosition(t.start))).attr("width",(t=>Math.max(0,this.getSingleBaseWidth()*(t.end-t.start+1)))),t.exit().remove()}}}return e};var A="highlight-event";function N(t,e,i,a,r,s,n,o,l){void 0===e&&(e=null),void 0===i&&(i=!1),void 0===a&&(a=!1),e&&(e=(null==e?void 0:e.feature)||e);var h={eventType:t,feature:e,target:n,parentEvent:o};return i&&((null==e?void 0:e.fragments)?h.highlight=((null==e?void 0:e.fragments)||[]).map((t=>t.start+":"+t.end)).join(","):(null==o?void 0:o.shiftKey)&&(null==l?void 0:l.highlight)?h.highlight=l.highlight+","+r+":"+s:h.highlight=r&&s?r+":"+s:void 0),a&&(h.selectedId=null==e?void 0:e.protvistaFeatureId),new CustomEvent("change",{detail:h,bubbles:!0,cancelable:!0})}function H(t,e){t.on("mouseover",(function(t,i){var a,r;e.dispatchEvent(N("mouseover",i,"onmouseover"===e.getAttribute(A),!1,null!==(a=i.start)&&void 0!==a?a:i.position,null!==(r=i.end)&&void 0!==r?r:i.position,this,t))})).on("mouseout",(()=>{e.dispatchEvent(N("mouseout",null,"onmouseover"===e.getAttribute(A)))})).on("click",(function(t,i){var a,r;e.dispatchEvent(N("click",i,"onclick"===e.getAttribute(A),!0,null!==(a=i.start)&&void 0!==a?a:i.position,null!==(r=i.end)&&void 0!==r?r:i.position,this,t,e))}))}function D(t){return t?.2126*(e=t)[0]+.7152*e[1]+.0722*e[2]>=165?"black":"white":"black";var e}i(64043),i(22462);const W=t=>(e,i)=>{window.customElements.get(t)||(i?(0,a.Mo)(t)(e,i):(0,a.Mo)(t)(e))};var _=i(10134);class Z extends _.oi{connectedCallback(){super.connectedCallback(),this.style.display="inline-block",this.style.lineHeight="0"}createRenderRoot(){return this}}const q=Z},84041:(t,e,i)=>{i.d(e,{HQ:()=>v,ZP:()=>A}),i(752),i(76265),i(60429),i(76801),i(268),i(278),i(51090),i(86111);var a,r,s,n,o,l,h,d=i(3950),c=(i(48903),i(58457),i(77062)),u=i(10134),g=i(77601),p=function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(t,i):r?r.value=i:e.set(t,i),i},f=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)};r=new WeakMap,s=new WeakMap,n=new WeakMap,a=new WeakSet,o=function(t){return"M0,"+t+"L"+f(this,n,"f")+","+t+"Z"},l=function(){var t=f(this,s,"f")/4;return"L"+(f(this,n,"f")-t)+","+t+"L"+f(this,n,"f")+","+2*t+"L"+(f(this,n,"f")-t)+","+3*t+"L"+f(this,n,"f")+","+f(this,s,"f")},h=function(){var t=f(this,s,"f")/4;return"L"+t+","+3*t+"L0,"+2*t+"L"+t+","+t};const m=class{constructor(){a.add(this),r.set(this,1),s.set(this,1),n.set(this,1)}shape2function(t){switch(t){case"rectangle":default:return()=>this.rectangle();case"roundRectangle":return()=>this.roundRectangle();case"line":return()=>this.line();case"bridge":return()=>this.bridge();case"diamond":return()=>this.diamond();case"chevron":return()=>this.chevron();case"catFace":return()=>this.catFace();case"triangle":return()=>this.triangle();case"wave":return()=>this.wave();case"hexagon":return()=>this.hexagon();case"pentagon":return()=>this.pentagon();case"circle":return()=>this.circle();case"arrow":return()=>this.arrow();case"doubleBar":return()=>this.doubleBar();case"discontinuosStart":return()=>this.discontinuosStart();case"discontinuos":return()=>this.discontinuos();case"discontinuosEnd":return()=>this.discontinuosEnd();case"helix":return()=>this.helix();case"strand":return()=>this.strand()}}getFeatureShape(t,e,i,a){return a=a||"rectangle",p(this,r,i,"f"),p(this,s,e,"f"),p(this,n,t*i,"f"),this.shape2function(a)()}static isContinuous(t){return"bridge"!==t.toLowerCase()}rectangle(){return"M0,0L"+f(this,n,"f")+",0L"+f(this,n,"f")+","+f(this,s,"f")+"L0,"+f(this,s,"f")+"Z"}roundRectangle(){return"M6,0h"+(f(this,n,"f")-12)+",0a6,6 0 0 1 6,6v"+(f(this,s,"f")-12)+"a6,6 0 0 1 -6,6h"+(12-f(this,n,"f"))+"a6,6 0 0 1 -6,-6v"+(12-f(this,s,"f"))+"a6,6 0 0 1 6,-6Z"}line(){return"M0,"+f(this,s,"f")/2+" L"+f(this,n,"f")+","+f(this,s,"f")/2}bridge(){return 1!==f(this,r,"f")?"M0,"+f(this,s,"f")+"L0,0L"+f(this,n,"f")+",0L"+f(this,n,"f")+","+f(this,s,"f")+"L"+f(this,n,"f")+",2L0,2Z":"M0,"+f(this,s,"f")+"L0,"+f(this,s,"f")/2+"L"+f(this,n,"f")/2+","+f(this,s,"f")/2+"L"+f(this,n,"f")/2+",0L"+f(this,n,"f")/2+","+f(this,s,"f")/2+"L"+f(this,n,"f")+","+f(this,s,"f")/2+"L"+f(this,n,"f")+","+f(this,s,"f")+"Z"}diamond(){var t=f(this,n,"f")/2,e="M"+t+",0L"+(t+5)+",5L"+t+",10L"+(t-5)+",5";return 1!==f(this,r,"f")?e+f(this,a,"m",o).call(this,5):e+"Z"}chevron(){var t=f(this,n,"f")/2,e="M"+t+",5L"+(5+t)+",0L"+(5+t)+",5L"+t+",10L"+(-5+t)+",5L"+(-5+t)+",0";return 1!==f(this,r,"f")?e+"L"+t+",5"+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}catFace(){var t=f(this,n,"f")/2,e="M"+(-5+t)+",0L"+(-5+t)+",6L"+(-2+t)+",10L"+(2+t)+",10L"+(5+t)+",6L"+(5+t)+",0L"+(2+t)+",4L"+(-2+t)+",4";return 1!==f(this,r,"f")?e+"M"+t+",0"+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}triangle(){var t=f(this,n,"f")/2,e="M"+t+",0L"+(5+t)+",10L"+(-5+t)+",10";return 1!==f(this,r,"f")?e+"L"+t+",0"+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}wave(){var t=f(this,n,"f")/2,e="M"+(-5+t)+",5A2.5,5 0 1,1 "+t+",5A2.5,5 0 1,0 "+(5+t)+",5";return 1!==f(this,r,"f")?e+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}getPolygon(t){for(var e="M ",i=f(this,n,"f")/2,s=0;s<t;s++)e+=5*Math.cos(2*Math.PI*s/t)+i+","+(5*Math.sin(2*Math.PI*s/t)+5)+" ";return 1!==f(this,r,"f")?e+" "+(5*Math.cos(0)+i)+","+(5*Math.sin(0)+5)+" "+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}hexagon(){return this.getPolygon(6)}pentagon(){return this.getPolygon(5)}circle(){var t=f(this,n,"f")/2,e=Math.sqrt(10/Math.PI),i="M"+t+",0A"+e+","+e+" 0 1,1 "+t+",10A"+e+","+e+" 0 1,1 "+t+",0";return 1!==f(this,r,"f")?i+f(this,a,"m",o).call(this,5)+"Z":i+"Z"}arrow(){var t=f(this,n,"f")/2,e="M"+t+",0L"+(-1+t)+",0L"+(-5+t)+",4L"+(-1+t)+","+f(this,s,"f")+"L"+t+","+f(this,s,"f")+"L"+(4+t)+",4";return 1!==f(this,r,"f")?e+"L"+t+",0"+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}doubleBar(){var t=f(this,n,"f")/2,e="M"+t+",0L"+(-5+t)+",10L"+t+",10L"+(5+t)+",0";return 1!==f(this,r,"f")?e+"L"+t+",0"+f(this,a,"m",o).call(this,5)+"Z":e+"Z"}discontinuosStart(){return"M0,0L"+f(this,n,"f")+",0L"+f(this,n,"f")+","+f(this,s,"f")+"L0,"+f(this,s,"f")+f(this,a,"m",h).call(this)+"Z"}discontinuos(){return"M0,0L"+f(this,n,"f")+",0"+f(this,a,"m",l).call(this)+"L0,"+f(this,s,"f")+f(this,a,"m",h).call(this)+"Z"}discontinuosEnd(){return"M0,0L"+f(this,n,"f")+",0"+f(this,a,"m",l).call(this)+"L0,"+f(this,s,"f")+"Z"}helix(){for(var t=2.5,e=2.5,i=Math.round(f(this,n,"f")/5),a="",r=0;r<i;r++)a+="M"+(-2.5+e)+","+f(this,s,"f")+" C"+(e+t)+",7.5 "+(2.5+e)+","+t+" "+e+", 0 C"+(e-t)+","+t+" "+e+",7.5 "+(2.5+e)+","+f(this,s,"f"),e+=5;return a}strand(){var t=0;f(this,n,"f")>5&&(t=f(this,n,"f")-5);var e=f(this,s,"f")/4;return"M0,"+e+"L"+t+","+e+"L"+t+","+3*e+"L0,"+3*e+"L0,"+e+"M"+t+",0L"+f(this,n,"f")+","+2*e+"L"+t+","+f(this,s,"f")+"Z"}};class v{constructor(t){var{layoutHeight:e,margin:i={top:1,bottom:1,left:0,right:0},minHeight:a=17}=t;this.margin=i,this.minHeight=a,this.layoutHeight=e,this.features=[]}init(t){this.features=t}getFeatureYPos(t){var e=this.getFeatureHeight();return this.margin.top+(this.layoutHeight-this.margin.top-this.margin.bottom)/2-e/2}getFeatureHeight(){return Math.max(this.minHeight,this.layoutHeight-this.margin.top-this.margin.bottom)}}var b,y=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)};b=new WeakMap;const w=class extends v{constructor(t){super(t),this.featuresMap=new Map,b.set(this,void 0),this.rowHeight=0,this.minHeight=15,function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===a?r.call(t,i):r?r.value=i:e.set(t,i)}(this,b,[],"f")}init(t){t.forEach((t=>{var e=y(this,b,"f").findIndex((e=>!((t,e)=>e.some((e=>{return i=t,a=e,!(Number(a.start)>Number(i.end)||Number(a.end)<Number(i.start));var i,a})))(t,e)));e>=0?(y(this,b,"f")[e].push(t),this.featuresMap.set(t,e)):(y(this,b,"f").push([t]),this.featuresMap.set(t,y(this,b,"f").length-1))})),this.rowHeight=Math.min(this.layoutHeight/y(this,b,"f").length,this.minHeight)}getOffset(){return y(this,b,"f").length*this.rowHeight<this.layoutHeight?this.layoutHeight/2-y(this,b,"f").length*this.rowHeight/2:0}getFeatureYPos(t){var e=this.featuresMap.get(t);return this.getOffset()+this.rowHeight*e+this.margin.top+this.margin.bottom}getFeatureHeight(){return this.rowHeight-this.margin.top-this.margin.bottom}};var C,x,F,O,S,j={CHAIN:{name:"chain",label:"Chain",tooltip:"(aka mature region). This describes the extent of a polypeptide chain in the mature protein following processing",shape:"rectangle",color:"#CC9933"},TRANSIT:{name:"transit peptide",label:"Transit peptide",tooltip:"This describes the extent of a transit peptide",shape:"rectangle",color:"#009966"},INIT_MET:{name:"initiator methionine",label:"Initiator methionine",tooltip:"This indicates that the initiator methionine is cleaved from the mature protein",shape:"arrow",color:"#996633"},PROPEP:{name:"propeptide",label:"Propeptide",tooltip:"Part of a protein that is cleaved during maturation or activation",shape:"rectangle",color:"#99CCCC"},PEPTIDE:{name:"peptide",label:"Peptide",tooltip:"The position and length of an active peptide in the mature protein",shape:"rectangle",color:"#006699"},SIGNAL:{name:"signal peptide",label:"Signal peptide",tooltip:"N-terminal signal peptide",shape:"rectangle",color:"#CC0033"},HELIX:{name:"helix",label:"Helix",tooltip:"The positions of experimentally determined helical regions",shape:"rectangle",color:"#FF0066"},STRAND:{name:"strand",label:"Beta strand",tooltip:"The positions of experimentally determined beta strands",shape:"rectangle",color:"#FFCC00"},TURN:{name:"turn",label:"Turn",tooltip:"The positions of experimentally determined hydrogen-bonded turns",shape:"rectangle",color:"#0571AF"},DISULFID:{name:"disulfide bond",label:"Disulfide bond",tooltip:"The positions of cysteine residues participating in disulphide bonds",shape:"bridge",color:"#23B14D"},CROSSLNK:{name:"cross-link",label:"Cross-link",tooltip:"Covalent linkages of various types formed between two proteins or between two parts of the same protein",shape:"bridge",color:"#FF6600"},REGION:{name:"region of interest",label:"Region of interest",tooltip:"Regions in multifunctional enzymes or fusion proteins, or characteristics of a region, e.g., protein-protein interactions mediation",shape:"rectangle",color:"#B33E00"},COILED:{name:"coiled-coil region",label:"Coiled-coil region",tooltip:"Coiled coils are built by two or more alpha-helices that wind around each other to form a supercoil",shape:"rectangle",color:"#006699"},MOTIF:{name:"short sequence motif",label:"Short sequence motif",tooltip:"Short conserved sequence motif of biological significance",shape:"rectangle",color:"#402060"},REPEAT:{name:"repeat",label:"Repeat",tooltip:"Repeated sequence motifs or repeated domains within the protein",shape:"rectangle",color:"#9900FF"},CA_BIND:{name:"calcium-binding region",label:"Calcium-binding region",tooltip:"Calcium-binding regions, such as the EF-hand motif",shape:"rectangle",color:"#FF3399"},DNA_BIND:{name:"DNA-binding region",label:"DNA binding",tooltip:"DNA-binding domains such as AP2/ERF domain, the ETS domain, the Fork-Head domain, the HMG box and the Myb domain",shape:"rectangle",color:"#009933"},DOMAIN:{name:"other domain of interest",label:"Other domain of interest",tooltip:"Specific combination of secondary structures organized into a characteristic three-dimensional structure or fold",shape:"rectangle",color:"#9999FF"},ZN_FING:{name:"zinc finger region",label:"Zinc finger",tooltip:"Small, functional, independently folded domain that coordinates one or more zinc ions",shape:"rectangle",color:"#990066"},NP_BIND:{name:"nucleotide-binding region",label:"Nucleotide-binding region",tooltip:"(aka flavin-binding). Region in the protein which binds nucleotide phosphates",shape:"rectangle",color:"#FF9900"},METAL:{name:"metal ion-binding site",label:"Metal ion-binding site",tooltip:"Binding site for a metal ion",shape:"diamond",color:"#009900"},SITE:{name:"other site of interest",label:"Other site of interest",tooltip:"Any interesting single amino acid site on the sequence",shape:"chevron",color:"#660033"},BINDING:{name:"other binding site",label:"Other binding site",tooltip:"Binding site for any chemical group (co-enzyme, prosthetic group, etc.)",shape:"rectangle",color:"#catFace"},ACT_SITE:{name:"active site",label:"Active site",tooltip:"Amino acid(s) directly involved in the activity of an enzyme",shape:"circle",color:"#FF6666"},MOD_RES:{name:"Post-translationally modified residue",label:"Modified residue",tooltip:"Modified residues such as phosphorylation, acetylation, acylation, methylation",shape:"triangle",color:"#000066"},LIPID:{name:"lipid moiety-binding region",label:"Lipidation",tooltip:"Covalently attached lipid group(s)",shape:"wave",color:"#99CC33"},CARBOHYD:{name:"glycosylation site",label:"Glycosylation",tooltip:"Covalently attached glycan group(s)",shape:"hexagon",color:"#CC3366"},COMPBIAS:{name:"compositionally biased region",label:"Compositionally biased region",tooltip:"Position of regions of compositional bias within the protein and the particular amino acids that are over-represented within those regions",shape:"rectangle",color:"#FF3366"},CONFLICT:{name:"sequence conflict",label:"Sequence conflict",tooltip:"Sequence discrepancies of unknown origin",shape:"rectangle",color:"#6633CC"},NON_CONS:{name:"non-consecutive residues",label:"Non-adjacent residues",tooltip:"Indicates that two residues in a sequence are not consecutive and that there is an undetermined number of unsequenced residues between them",shape:"doubleBar",color:"#FF0033"},NON_TER:{name:"non-terminal residue",label:"Non-terminal residue",tooltip:"The sequence is incomplete. The residue is not the terminal residue of the complete protein",shape:"doubleBar",color:"#339933"},UNSURE:{name:"unsure residue",label:"Sequence uncertainty",tooltip:"Regions of a sequence for which the authors are unsure about the sequence assignment",shape:"rectangle",color:"#33FF00"},NON_STD:{name:"non-standard amino acid",label:"Non-standard residue",tooltip:"Non-standard amino acids (selenocysteine and pyrrolysine)",shape:"pentagon",color:"#330066"},MUTAGEN:{name:"mutagenesis site",label:"Mutagenesis",tooltip:"Site which has been experimentally altered by mutagenesis",shape:"rectangle",color:"#FF9900"},TOPO_DOM:{name:"topological domain",label:"Topological domain",tooltip:"Location of non-membrane regions of membrane-spanning proteins",shape:"rectangle",color:"#CC0000"},TRANSMEM:{name:"transmembrane region",label:"Transmembrane",tooltip:"Extent of a membrane-spanning region",shape:"rectangle",color:"#CC00CC"},INTRAMEM:{name:"intramembrane region",label:"Intramembrane",tooltip:"Extent of a region located in a membrane without crossing it",shape:"rectangle",color:"#0000CC"},VAR_SEQ:{name:"splice variant",label:"Splice variant",tooltip:"",shape:"rectangle",color:"#CC11CC"},VARIANT:{name:"sequence variant",label:"Natural variant",tooltip:"Natural variant of the protein, including polymorphisms, variations between strains, isolates or cultivars, disease-associated mutations and RNA editing events",shape:"circle",color:"black"},UNIQUE:{name:"unique",label:"Unique peptide",tooltip:"",shape:"rectangle",color:"#fc3133"},NON_UNIQUE:{name:"non-unique",label:"Non-unique peptide",tooltip:"",shape:"rectangle",color:"#8585fc"},ANTIGEN:{name:"antigen",label:"Antibody binding sequences",tooltip:"",shape:"rectangle",color:"#996699"},PDBE_COVER:{name:"pdbe coverage",label:"PDBe 3D structure coverage",tooltip:"",shape:"rectangle",color:"#669966"}},P=t=>{if(t.toUpperCase()in j)return j[t.toUpperCase()].shape;var e=Object.values(j).find((e=>e.name.toUpperCase()===t.toUpperCase()));return e?e.shape:"rectangle"},T=t=>{if(t.toUpperCase()in j)return j[t.toUpperCase()].color;var e=Object.values(j).find((e=>e.name.toUpperCase()===t.toUpperCase()));return e||console.log(t),e?e.color:"black"},M=function(t,e,i,a){var r,s=arguments.length,n=s<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,a);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(s<3?r(n):s>3?r(e,i,n):r(e,i))||n);return s>3&&n&&Object.defineProperty(e,i,n),n},R=function(t,e,i,a){if("a"===i&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?a:"a"===i?a.call(t):a?a.value:e.get(t)},E=function(t,e,i,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(t,i):r?r.value=i:e.set(t,i),i},k=["length","width","height"],L=S=class extends((0,c.YD)((0,c._5)((0,c.tG)((0,c.vl)((0,c.Ds)((0,c.U6)((0,c.Rn)(c.ZP)))))))){constructor(){super(...arguments),this.featureShape=new m,x.set(this,[]),F.set(this,[]),this.filters=null,O.set(this,void 0)}getLayout(){return"non-overlapping"===String(this.layout).toLowerCase()?new w({layoutHeight:this.height}):new v({layoutHeight:this.height,margin:{top:this["margin-top"],bottom:this["margin-bottom"],left:this["margin-left"],right:this["margin-right"]}})}connectedCallback(){super.connectedCallback(),this.layoutObj=this.getLayout(),R(this,F,"f")&&this.createTrack()}static normalizeLocations(t){return t.map((t=>{var{locations:e,start:i,end:a}=t;return e?t:Object.assign(t,{locations:[{fragments:[{start:i,end:a}]}]})}))}processData(t){E(this,x,S.normalizeLocations(t),"f")}set data(t){this.processData(t),this.applyFilters(),this.layoutObj=this.getLayout(),this.createTrack()}get data(){return R(this,F,"f")}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i),(k.includes(t)||t.startsWith("margin-"))&&(this.applyFilters(),this.layoutObj=this.getLayout(),this.createTrack())}getFeatureColor(t){var e,i,a,r="gray";return t.color?t.color||r:(null===(e=null==t?void 0:t.feature)||void 0===e?void 0:e.color)?(null===(i=null==t?void 0:t.feature)||void 0===i?void 0:i.color)||r:this.color?this.color:t.type?T(t.type):(null===(a=null==t?void 0:t.feature)||void 0===a?void 0:a.type)?T(t.feature.type):r}getFeatureFillColor(t){var e,i="gray";return t.fill?t.fill||i:(null===(e=null==t?void 0:t.feature)||void 0===e?void 0:e.fill)?t.feature.fill||i:this.getFeatureColor(t)}getShape(t){var e,i,a="rectangle";return t.shape?t.shape||a:(null===(e=null==t?void 0:t.feature)||void 0===e?void 0:e.shape)?t.feature.shape||a:this.shape?this.shape:t.type?P(t.type):(null===(i=t.feature)||void 0===i?void 0:i.type)?P(t.feature.type):a}createTrack(){var t,e;R(this,F,"f")&&(null===(t=this.layoutObj)||void 0===t||t.init(R(this,F,"f")),null===(e=this.svg)||void 0===e||e.selectAll("g").remove(),this.svg=(0,d.Ys)(this).selectAll("svg").attr("width",this.width).attr("height",this.height),this.svg&&(this.seqG=this.svg.append("g").attr("class","sequence-features"),this.createFeatures(),E(this,O,this.svg.append("g").attr("class","highlighted"),"f"),this.margins=this.svg.append("g").attr("class","margin")))}createFeatures(){var t;if(this.seqG){var e=this.seqG.selectAll("g.feature-group").data(R(this,F,"f")).enter().append("g").attr("class","feature-group").attr("id",(t=>"g_"+t.accession)).selectAll("g.location-group").data((t=>(t.locations||[]).map((e=>Object.assign({},e,{feature:t}))))).enter().append("g").attr("class","location-group").selectAll("g.fragment-group").data((t=>t.fragments.map((e=>Object.assign({},e,{feature:t.feature}))))).enter().append("g").attr("class","fragment-group");e.append("path").attr("class",(t=>this.getShape(t)+" feature")).attr("d",(t=>{var e;return this.featureShape.getFeatureShape(this.getSingleBaseWidth(),(null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureHeight())||0,t.end?t.end-t.start+1:1,this.getShape(t))})).attr("transform",(t=>{var e;return"translate("+this.getXFromSeqPosition(t.start)+","+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+")"})).style("fill",(t=>this.getFeatureFillColor(t))).attr("stroke",(t=>this.getFeatureColor(t))).style("fill-opacity",(t=>{var{feature:e}=t;return e.opacity?e.opacity:.9})).style("stroke-opacity",(t=>{var{feature:e}=t;return e.opacity?e.opacity:.9})),e.append("rect").attr("class","outer-rectangle feature").attr("width",(t=>Math.max(0,this.getSingleBaseWidth()*(t.end?t.end-t.start+1:1)))).attr("height",(null===(t=this.layoutObj)||void 0===t?void 0:t.getFeatureHeight())||0).attr("transform",(t=>{var e;return"translate("+this.getXFromSeqPosition(t.start)+","+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+")"})).style("fill","transparent").attr("stroke","transparent").call(c.sQ,this)}}applyFilters(){(this.filters||[]).length<=0&&E(this,F,R(this,x,"f"),"f")}refresh(){var t;if(this.xScale&&this.seqG){var e=this.seqG.selectAll("g.fragment-group").data(R(this,F,"f").reduce(((t,e)=>t.concat((e.locations||[]).reduce(((t,i)=>t.concat(i.fragments.map((t=>Object.assign({},t,{feature:e}))))),[]))),[]));e.selectAll("path.feature").attr("d",(t=>{var e;return this.featureShape.getFeatureShape(this.getSingleBaseWidth(),(null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureHeight())||0,(null==t?void 0:t.end)&&(null==t?void 0:t.start)?t.end-t.start+1:1,this.getShape(t))})).attr("transform",(t=>{var e;return"translate("+this.getXFromSeqPosition(t.start||0)+","+(null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))+")"})),e.selectAll("rect.outer-rectangle").attr("width",(t=>Math.max(0,this.getSingleBaseWidth()*((null==t?void 0:t.end)&&(null==t?void 0:t.start)?t.end-t.start+1:1)))).attr("height",(null===(t=this.layoutObj)||void 0===t?void 0:t.getFeatureHeight())||0).attr("transform",(t=>{var e;return"translate("+this.getXFromSeqPosition(t.start||0)+","+((null===(e=this.layoutObj)||void 0===e?void 0:e.getFeatureYPos(t.feature))||0)+")"}))}this.updateHighlight(),this.renderMarginOnGroup(this.margins)}updateHighlight(){if(R(this,O,"f")){var t=R(this,O,"f").selectAll("rect").data(this.highlightedRegion.segments);t.enter().append("rect").style("pointer-events","none").merge(t).attr("fill",this["highlight-color"]).attr("height",this.height).attr("x",(t=>this.getXFromSeqPosition(t.start))).attr("width",(t=>Math.max(0,this.getSingleBaseWidth()*(t.end-t.start+1)))),t.exit().remove()}}zoomRefreshed(){this.getWidthWithMargins()>0&&this.refresh()}firstUpdated(){this.createTrack()}render(){return(0,u.dy)(C||(t=['<svg class="container"></svg>'],e||(e=t.slice(0)),t.raw=e,C=t));var t,e}};x=new WeakMap,F=new WeakMap,O=new WeakMap,M([(0,g.Cb)({type:String})],L.prototype,"color",void 0),M([(0,g.Cb)({type:String})],L.prototype,"shape",void 0),M([(0,g.Cb)({type:String})],L.prototype,"layout",void 0);const A=L=S=M([(0,c.y_)("nightingale-track")],L)}}]);
//# sourceMappingURL=5562.module.5562.261.js.map