{"version":3,"file":"js/8678.module.8678.6ce.js","mappings":"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","sources":["webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-colored-sequence/src/utils/String2Object.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-colored-sequence/src/nightingale-colored-sequence.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-colored-sequence/src/utils/ColorScaleParser.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-colored-sequence/src/index.ts","webpack://interpro7-client/./node_modules/d3-array/src/max.js","webpack://interpro7-client/./node_modules/d3-array/src/min.js","webpack://interpro7-client/./node_modules/d3-shape/src/array.js","webpack://interpro7-client/./node_modules/d3-shape/src/constant.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/linear.js","webpack://interpro7-client/./node_modules/d3-shape/src/path.js","webpack://interpro7-client/./node_modules/d3-shape/src/point.js","webpack://interpro7-client/./node_modules/d3-shape/src/line.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/basis.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/cardinal.js","webpack://interpro7-client/./node_modules/d3-shape/src/noop.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/linearClosed.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/monotone.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/natural.js","webpack://interpro7-client/./node_modules/d3-shape/src/curve/step.js","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-linegraph-track/src/nightingale-linegraph-track.ts","webpack://interpro7-client/./node_modules/d3-shape/src/area.js","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-linegraph-track/src/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-manager/src/nightingale-manager.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-manager/src/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-navigation/src/nightingale-navigation.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-navigation/src/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-saver/src/nightingale-saver.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-saver/src/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-sequence/src/nightingale-sequence.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-sequence/src/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-variation/src/processVariants.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-variation/src/variationPlot.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-variation/src/proteinAPI.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-variation/src/nightingale-variation.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-variation/src/index.ts","webpack://interpro7-client/./node_modules/css-font-face-src/dist/css-font-face-src.js","webpack://interpro7-client/./node_modules/inlineresources/src/backgroundValueParser.js","webpack://interpro7-client/./node_modules/inlineresources/src/cssSupport.js","webpack://interpro7-client/./node_modules/inlineresources/src/inline.js","webpack://interpro7-client/./node_modules/inlineresources/src/inlineCss.js","webpack://interpro7-client/./node_modules/inlineresources/src/inlineImage.js","webpack://interpro7-client/./node_modules/inlineresources/src/inlineScript.js","webpack://interpro7-client/./node_modules/inlineresources/src/util.js","webpack://interpro7-client/./node_modules/rasterizehtml/dist/rasterizeHTML.js","webpack://interpro7-client/./node_modules/sane-domparser-error/index.js","webpack://interpro7-client/./node_modules/xmlserializer/xmlserializer.js","webpack://interpro7-client/./node_modules/core-js/modules/es.promise.finally.js","webpack://interpro7-client/./node_modules/lodash-es/_baseSlice.js","webpack://interpro7-client/./node_modules/lodash-es/_hasUnicode.js","webpack://interpro7-client/./node_modules/lodash-es/_unicodeToArray.js","webpack://interpro7-client/./node_modules/lodash-es/_stringToArray.js","webpack://interpro7-client/./node_modules/lodash-es/_asciiToArray.js","webpack://interpro7-client/./node_modules/lodash-es/upperFirst.js","webpack://interpro7-client/./node_modules/lodash-es/_createCaseFirst.js","webpack://interpro7-client/./node_modules/lodash-es/_castSlice.js","webpack://interpro7-client/./node_modules/lodash-es/capitalize.js","webpack://interpro7-client/./node_modules/d3-axis/src/identity.js","webpack://interpro7-client/./node_modules/d3-axis/src/axis.js","webpack://interpro7-client/./node_modules/d3-path/src/path.js","webpack://interpro7-client/./node_modules/d3-color/src/math.js","webpack://interpro7-client/./node_modules/d3-color/src/cubehelix.js","webpack://interpro7-client/./node_modules/d3-interpolate/src/cubehelix.js","webpack://interpro7-client/./node_modules/d3-scale-chromatic/src/sequential-multi/rainbow.js"],"sourcesContent":["const identity = (x: string) => x;\n\nexport default (\n  text: string | null = null,\n  options?: {\n    keyFormatter?: (x: string) => string;\n    valueFormatter?: (x: string) => unknown;\n  },\n): Record<string, unknown> => {\n  if (text !== null && typeof text !== \"string\")\n    throw new Error(\"The attribute text has to be of type string\");\n  const { keyFormatter, valueFormatter } = {\n    keyFormatter: identity,\n    valueFormatter: identity,\n    ...options,\n  };\n  if (text && text.trim() !== \"\") {\n    const blocks = text.split(\",\").map((bl) => bl.split(\":\"));\n    const obj: Record<string, unknown> = {};\n    blocks.forEach((bl) => {\n      if (bl.length !== 2)\n        throw new Error(\n          `Bad block: ${bl.join(\n            \":\",\n          )}\\n The blocks of the string should follow the format KEY:VALUE`,\n        );\n      obj[keyFormatter(bl[0])] = valueFormatter(bl[1]);\n    });\n    return obj;\n  }\n  return {};\n};\n","import { customElement, property } from \"lit/decorators.js\";\nimport { scaleLinear, Selection } from \"d3\";\n\nimport NightingaleSequence, {\n  SequenceBaseType,\n} from \"@nightingale-elements/nightingale-sequence\";\nimport { bindEvents } from \"@nightingale-elements/nightingale-new-core\";\n\nimport ColorScaleParser from \"./utils/ColorScaleParser\";\nimport String2Object from \"./utils/String2Object\";\n\nimport hydroInterfaceScale from \"./hydrophobicity-interface-scale.json\";\nimport hydroOctanoleScale from \"./hydrophobicity-octanol-scale.json\";\nimport hydroScale from \"./hydrophobicity-scale.json\";\nimport isoelectricPointScale from \"./isoelectric-point-scale.json\";\n\nconst supportedScales = new Map<string, Record<string, number>>([\n  [\"hydrophobicity-interface-scale\", hydroInterfaceScale],\n  [\"hydrophobicity-octanol-scale\", hydroOctanoleScale],\n  [\"hydrophobicity-scale\", hydroScale],\n  [\"isoelectric-point-scale\", isoelectricPointScale],\n]);\n\nconst defaultScale = {\n  domain: [-2, 2],\n  range: [\"#ffdd00\", \"#0000FF\"],\n};\n\nexport type DataBlock = {\n  start: number;\n  end: number;\n  aa: string;\n  value: unknown;\n  color: number;\n};\n\nconst MIN_BASE_SIZE = 8;\n\n@customElement(\"nightingale-colored-sequence\")\nclass NightingaleColoredSequence extends NightingaleSequence {\n  @property({ type: String, reflect: true })\n  scale?: string = undefined;\n  @property({ type: String, reflect: true })\n  \"color-range\"?: string = undefined;\n\n  #uniqueID = \"\";\n  #gradient?: Selection<\n    SVGLinearGradientElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #seq_bg?: Selection<\n    SVGGElement,\n    SequenceBaseType | unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #residues?: Selection<SVGRectElement, DataBlock, SVGGElement, unknown>;\n\n  colorScale: {\n    domain: number[];\n    range: string[];\n  } = defaultScale;\n\n  protected createSequence() {\n    super.createSequence();\n\n    this.#uniqueID = Math.random().toString(36).substring(7);\n\n    this.svg?.select(\"g.sequence\").attr(\"transform\", null);\n    this.#gradient = this.svg\n      ?.append(\"defs\")\n      .append(\"linearGradient\")\n      .attr(\"id\", `scale-gradient-${this.#uniqueID}`);\n    this.svg\n      ?.append(\"rect\")\n      .attr(\"class\", \"seq-gradient\")\n      .style(\"pointer-events\", \"none\");\n    // margins should be the last thing in the svg so they ar over anything else\n    this.svg?.selectAll(\"g.margin\").remove();\n    this.margins = this.svg?.append(\"g\").attr(\"class\", \"margin\");\n  }\n\n  getScaleFromAttribute() {\n    let scale = null;\n    const attributeScale = this.scale || \"\";\n    if (supportedScales.has(attributeScale)) {\n      return supportedScales.get(attributeScale);\n    }\n    if (\n      /([ILFVMPWHTEQCYASNDRGK]:-?\\d+\\.?\\d*)(,[ILFVMPWHTEQCYASNDRGK]:-?\\d+\\.?\\d*)*/.test(\n        attributeScale,\n      )\n    ) {\n      try {\n        scale = String2Object(attributeScale, {\n          keyFormatter: (x) => x.toUpperCase(),\n          valueFormatter: (x) => parseFloat(x),\n        });\n      } catch (error) {\n        console.error(\n          `Couldn't parse the given scale \"${attributeScale}\"`,\n          error,\n        );\n      }\n    }\n    return scale;\n  }\n\n  renderD3() {\n    if (this.seq_g) {\n      this.svg?.attr(\"width\", this.width).attr(\"height\", this.height);\n\n      this.seq_g.attr(\"width\", this.width);\n\n      const scale = this.getScaleFromAttribute();\n      if (scale === null) {\n        console.error(\"The attribute scale is not valid.\");\n        return;\n      }\n      const colorScale = scaleLinear<string, number>();\n      if (this[\"color-range\"]) {\n        this.colorScale = ColorScaleParser(this[\"color-range\"]);\n      }\n      colorScale.domain(this.colorScale.domain).range(this.colorScale.range);\n\n      const ftWidth = this.getSingleBaseWidth();\n      const first = Math.round(Math.max(0, this.getStart() - 2));\n      const last = Math.round(\n        Math.min(this.sequence?.length || 0, this.getEnd() + 1),\n      );\n      const bases =\n        this.sequence\n          ?.slice(first, last)\n          .split(\"\")\n          .map<DataBlock>((aa, i) => {\n            // use 0 if the base is not in the given scale\n            const value =\n              scale && aa.toUpperCase() in scale ? scale[aa.toUpperCase()] : 0;\n            return {\n              start: 1 + first + i,\n              end: 1 + first + i,\n              aa,\n              value,\n              color: colorScale(value as number),\n            };\n          }) || [];\n\n      this.#residues = this.seq_g\n        .selectAll<SVGRectElement, DataBlock>(\"rect.base_bg\")\n        .data(ftWidth < MIN_BASE_SIZE ? [] : bases, (d) => d.start);\n\n      this.#residues\n        .enter()\n        .append(\"rect\")\n        .attr(\"class\", \"base_bg feature\")\n        .attr(\"data-base\", ({ aa }) => aa)\n        .attr(\"data-pos\", ({ start }) => start)\n        .attr(\"height\", this.height)\n        .merge(this.#residues)\n        .attr(\"width\", ftWidth)\n        .attr(\"fill\", ({ color }) => color)\n        .attr(\"x\", ({ start }) => this.getXFromSeqPosition(start))\n        .call(bindEvents, this);\n\n      this.#residues.exit().remove();\n\n      const stops = this.#gradient\n        ?.selectAll<SVGStopElement, string[]>(\"stop\")\n        .data((this.sequence || \"\").split(\"\"));\n\n      if (stops) {\n        stops\n          .enter()\n          .append(\"stop\")\n          .merge(stops)\n          .attr(\n            \"offset\",\n            (_, pos) => (pos + 0.5) / (this.sequence?.length || 1),\n          )\n          .attr(\"stop-color\", (base) =>\n            colorScale(\n              scale && base.toUpperCase() in scale\n                ? (scale[base.toUpperCase()] as number)\n                : 0, // if the base is not in the given scale\n            ),\n          );\n      }\n      this.#gradient?.exit().remove();\n\n      this.svg\n        ?.select(\"rect.seq-gradient\")\n        .attr(\"x\", this.getXFromSeqPosition(1))\n        .attr(\"y\", 0)\n        .attr(\"height\", this.height)\n        .attr(\n          \"width\",\n          Math.max(\n            0,\n            this.getXFromSeqPosition(this.sequence?.length || 0) -\n              this.getXFromSeqPosition(0),\n          ),\n        )\n        .style(\"opacity\", ftWidth < MIN_BASE_SIZE ? 1 : MIN_BASE_SIZE / ftWidth)\n        .attr(\"fill\", `url(#scale-gradient-${this.#uniqueID})`);\n\n      this.updateHighlight();\n      this.renderMarginOnGroup(this.margins);\n    }\n  }\n}\n\nexport default NightingaleColoredSequence;\n","export function isColorValid(color: string): boolean {\n  const fakeElement = document.createElement(\"div\");\n  fakeElement.style.borderColor = \"\";\n  fakeElement.style.borderColor = color;\n  if (fakeElement.style.borderColor === \"\") return false;\n  return true;\n}\n\nexport default (\n  text: string | null = null,\n): {\n  range: string[];\n  domain: number[];\n} => {\n  let range: string[] = [];\n  let domain: number[] = [];\n  if (text !== null && typeof text !== \"string\")\n    throw new Error(\"The attribute text has to be of type string\");\n  if (text && text.trim() !== \"\") {\n    const blocks = text.split(\",\").map((bl) => bl.split(\":\"));\n    if (blocks.length < 2)\n      throw new Error(\"There should be at least 2 points to create a scale\");\n\n    range = blocks.map((bl) => {\n      const color = bl[0].trim().toUpperCase();\n      if (!isColorValid(color)) {\n        throw new Error(`The color '${color} is not valid'`);\n      }\n      return color;\n    });\n    domain = blocks.map((bl, i) => {\n      const number = parseFloat(bl[1]);\n      if (Number.isNaN(number))\n        throw new Error(\n          `The second part of every point should be a number. Error in point ${i}: ${bl}`,\n        );\n      return number;\n    });\n  }\n  return {\n    range,\n    domain,\n  };\n};\n","import NightingaleColoredSequence from \"./nightingale-colored-sequence\";\nexport {\n  default as ColorScaleParser,\n  isColorValid,\n} from \"./utils/ColorScaleParser\";\nexport type { DataBlock } from \"./nightingale-colored-sequence\";\nexport default NightingaleColoredSequence;\n","export default function max(values, valueof) {\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (max < value || (max === undefined && value >= value))) {\n        max = value;\n      }\n    }\n  }\n  return max;\n}\n","export default function min(values, valueof) {\n  let min;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null\n          && (min > value || (min === undefined && value >= value))) {\n        min = value;\n      }\n    }\n  }\n  return min;\n}\n","export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","import {Path} from \"d3-path\";\n\nexport function withPath(shape) {\n  let digits = 3;\n\n  shape.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) {\n      digits = null;\n    } else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    return shape;\n  };\n\n  return () => new Path(digits);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(line);\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    (2 * that._x0 + that._x1) / 3,\n    (2 * that._y0 + that._y1) / 3,\n    (that._x0 + 2 * that._x1) / 3,\n    (that._y0 + 2 * that._y1) / 3,\n    (that._x0 + 4 * that._x1 + x) / 6,\n    (that._y0 + 4 * that._y1 + y) / 6\n  );\n}\n\nexport function Basis(context) {\n  this._context = context;\n}\n\nBasis.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 3: point(this, this._x1, this._y1); // falls through\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6); // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n  }\n};\n\nexport default function(context) {\n  return new Basis(context);\n}\n","export function point(that, x, y) {\n  that._context.bezierCurveTo(\n    that._x1 + that._k * (that._x2 - that._x0),\n    that._y1 + that._k * (that._y2 - that._y0),\n    that._x2 + that._k * (that._x1 - x),\n    that._y2 + that._k * (that._y1 - y),\n    that._x2,\n    that._y2\n  );\n}\n\nexport function Cardinal(context, tension) {\n  this._context = context;\n  this._k = (1 - tension) / 6;\n}\n\nCardinal.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 = this._x2 =\n    this._y0 = this._y1 = this._y2 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x2, this._y2); break;\n      case 3: point(this, this._x1, this._y1); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; this._x1 = x, this._y1 = y; break;\n      case 2: this._point = 3; // falls through\n      default: point(this, x, y); break;\n    }\n    this._x0 = this._x1, this._x1 = this._x2, this._x2 = x;\n    this._y0 = this._y1, this._y1 = this._y2, this._y2 = y;\n  }\n};\n\nexport default (function custom(tension) {\n\n  function cardinal(context) {\n    return new Cardinal(context, tension);\n  }\n\n  cardinal.tension = function(tension) {\n    return custom(+tension);\n  };\n\n  return cardinal;\n})(0);\n","export default function() {}\n","import noop from \"../noop.js\";\n\nfunction LinearClosed(context) {\n  this._context = context;\n}\n\nLinearClosed.prototype = {\n  areaStart: noop,\n  areaEnd: noop,\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._point) this._context.closePath();\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    if (this._point) this._context.lineTo(x, y);\n    else this._point = 1, this._context.moveTo(x, y);\n  }\n};\n\nexport default function(context) {\n  return new LinearClosed(context);\n}\n","function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic Bzier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n","function Natural(context) {\n  this._context = context;\n}\n\nNatural.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = [];\n    this._y = [];\n  },\n  lineEnd: function() {\n    var x = this._x,\n        y = this._y,\n        n = x.length;\n\n    if (n) {\n      this._line ? this._context.lineTo(x[0], y[0]) : this._context.moveTo(x[0], y[0]);\n      if (n === 2) {\n        this._context.lineTo(x[1], y[1]);\n      } else {\n        var px = controlPoints(x),\n            py = controlPoints(y);\n        for (var i0 = 0, i1 = 1; i1 < n; ++i0, ++i1) {\n          this._context.bezierCurveTo(px[0][i0], py[0][i0], px[1][i0], py[1][i0], x[i1], y[i1]);\n        }\n      }\n    }\n\n    if (this._line || (this._line !== 0 && n === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n    this._x = this._y = null;\n  },\n  point: function(x, y) {\n    this._x.push(+x);\n    this._y.push(+y);\n  }\n};\n\n// See https://www.particleincell.com/2012/bezier-splines/ for derivation.\nfunction controlPoints(x) {\n  var i,\n      n = x.length - 1,\n      m,\n      a = new Array(n),\n      b = new Array(n),\n      r = new Array(n);\n  a[0] = 0, b[0] = 2, r[0] = x[0] + 2 * x[1];\n  for (i = 1; i < n - 1; ++i) a[i] = 1, b[i] = 4, r[i] = 4 * x[i] + 2 * x[i + 1];\n  a[n - 1] = 2, b[n - 1] = 7, r[n - 1] = 8 * x[n - 1] + x[n];\n  for (i = 1; i < n; ++i) m = a[i] / b[i - 1], b[i] -= m, r[i] -= m * r[i - 1];\n  a[n - 1] = r[n - 1] / b[n - 1];\n  for (i = n - 2; i >= 0; --i) a[i] = (r[i] - a[i + 1]) / b[i];\n  b[n - 1] = (x[n] + a[n - 1]) / 2;\n  for (i = 0; i < n - 1; ++i) b[i] = 2 * x[i + 1] - a[i + 1];\n  return [a, b];\n}\n\nexport default function(context) {\n  return new Natural(context);\n}\n","function Step(context, t) {\n  this._context = context;\n  this._t = t;\n}\n\nStep.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x = this._y = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (0 < this._t && this._t < 1 && this._point === 2) this._context.lineTo(this._x, this._y);\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    if (this._line >= 0) this._t = 1 - this._t, this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: {\n        if (this._t <= 0) {\n          this._context.lineTo(this._x, y);\n          this._context.lineTo(x, y);\n        } else {\n          var x1 = this._x * (1 - this._t) + x * this._t;\n          this._context.lineTo(x1, this._y);\n          this._context.lineTo(x1, y);\n        }\n        break;\n      }\n    }\n    this._x = x, this._y = y;\n  }\n};\n\nexport default function(context) {\n  return new Step(context, 0.5);\n}\n\nexport function stepBefore(context) {\n  return new Step(context, 0);\n}\n\nexport function stepAfter(context) {\n  return new Step(context, 1);\n}\n","import { customElement, property } from \"lit/decorators.js\";\nimport { html } from \"lit\";\nimport {\n  scaleLinear,\n  ScaleLinear,\n  select,\n  Selection,\n  line,\n  area,\n  max,\n  min,\n  interpolateRainbow,\n  curveLinear,\n  curveLinearClosed,\n  curveMonotoneX,\n  curveMonotoneY,\n  curveBasis,\n  curveCardinal,\n  curveStep,\n  curveStepAfter,\n  curveStepBefore,\n  curveNatural,\n  CurveFactory,\n  Area,\n  Line,\n  pointer as d3Mouse,\n} from \"d3\";\n\nimport NightingaleElement, {\n  withDimensions,\n  withPosition,\n  withMargin,\n  withResizable,\n  withHighlight,\n  withManager,\n  withZoom,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nconst curves: { [x: string]: CurveFactory } = {\n  curveLinear,\n  curveLinearClosed,\n  curveMonotoneX,\n  curveMonotoneY,\n  curveBasis,\n  curveCardinal,\n  curveStep,\n  curveStepAfter,\n  curveStepBefore,\n  curveNatural,\n};\n\nexport type LineValue = {\n  position: number;\n  value: number;\n};\nexport type LineData = {\n  name: string;\n  range: number[];\n  color?: string; // (color will be assigned if not provided. Use \"none\" for no line color)\n  fill?: string; //Create area plot using given fill color (default \"none\"),\n  lineCurve?: keyof typeof curves; // See https://github.com/d3/d3-shape/#curves\n  values: Array<LineValue>;\n};\n\n@customElement(\"nightingale-linegraph-track\")\nclass NightingaleLinegraphTrack extends withManager(\n  withZoom(\n    withResizable(\n      withMargin(\n        withPosition(withDimensions(withHighlight(NightingaleElement))),\n      ),\n    ),\n  ),\n) {\n  @property({ type: String })\n  type?: string | null;\n\n  yScale?: ScaleLinear<number, number>;\n  #highlighted?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #margins?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #chart?: Selection<\n    SVGGElement,\n    LineData,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #data?: Array<LineData>;\n  #minRange?: number;\n  #maxRange?: number;\n  #overlay?: Selection<\n    SVGRectElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n\n  constructor() {\n    super();\n    this.yScale = scaleLinear();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.#data) this.createTrack();\n  }\n\n  set data(data: LineData[] | undefined) {\n    this.#data = data;\n    this.createTrack();\n  }\n\n  get data() {\n    return this.#data;\n  }\n\n  protected createTrack() {\n    if (!this.#data) {\n      return;\n    }\n\n    this.svg?.selectAll(\"g\").remove();\n\n    this.svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height);\n\n    if (!this.svg) return;\n\n    this.#highlighted = this.svg.append(\"g\").attr(\"class\", \"highlighted\");\n    this.#margins = this.svg.append(\"g\").attr(\"class\", \"margin\");\n\n    const range: number[] = [];\n    const minimum: number[] = [];\n    const maximum: number[] = [];\n    this.#data.forEach((d) => {\n      range.push(...d.range);\n      minimum.push(min(d.values, (v: LineValue) => v.position) || Infinity);\n      maximum.push(max(d.values, (v: LineValue) => v.position) || -Infinity);\n    });\n    this.#minRange = min(range) || 0;\n    this.#maxRange = max(range) || 0;\n\n    const beginning = min(minimum) || 0;\n    const end = max(maximum) || this.length || 0;\n\n    // Create the visualisation here\n    const chartGroup = this.svg.append(\"g\").attr(\"class\", \"chart-group\");\n    this._initYScale();\n\n    this.#chart = chartGroup\n      .selectAll(\".chart\")\n      .data(this.#data)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"chart\");\n\n    this.#chart\n      .append(\"path\")\n      .attr(\"class\", \"graph\")\n      .attr(\"id\", (d) => d.name)\n      .attr(\"d\", (d) => {\n        d.color = d.color || interpolateRainbow(Math.random());\n        // eslint-disable-next-line no-param-reassign\n        d.fill = d.fill || \"none\";\n        return this.drawLine(d)(d.values);\n      })\n      .attr(\"fill\", (d) => d.fill || null)\n      .attr(\"stroke\", (d) => d.color || null)\n      .attr(\"transform\", \"translate(0,0)\");\n\n    const mouseG = chartGroup.append(\"g\").attr(\"class\", \"mouse-over-effects\");\n\n    const lines = chartGroup.selectAll<SVGPathElement, LineData>(\"path.graph\");\n\n    const mousePerLine = mouseG\n      .selectAll(\".mouse-per-line\")\n      .data(this.#data)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", \"mouse-per-line\");\n\n    mousePerLine\n      .append(\"circle\")\n      .attr(\"r\", 7)\n      .style(\"stroke\", (d) => d.color || null)\n      .style(\"fill\", \"none\")\n      .style(\"stroke-width\", \"1px\")\n      .style(\"opacity\", \"0\");\n\n    mousePerLine\n      .append(\"text\")\n      .attr(\"transform\", \"translate(10,3)\")\n      .attr(\"pointer-events\", \"none\");\n\n    this.#overlay = mouseG\n      .append(\"rect\") // append a rect to catch mouse movements on canvas\n      .attr(\"width\", this.width) // can't catch mouse events on a g element\n      .attr(\"height\", this.height)\n      .attr(\"fill\", \"none\")\n      .attr(\"pointer-events\", \"all\")\n      .on(\"mouseout\", () => {\n        // on mouse out hide circles and text\n        chartGroup.selectAll(\".mouse-per-line circle\").style(\"opacity\", \"0\");\n        chartGroup.selectAll(\".mouse-per-line text\").style(\"opacity\", \"0\");\n      })\n      .on(\"mousemove\", (event) => {\n        // mouse moving over canvas\n        const mouse = d3Mouse(event);\n\n        // Showing the circle and text only when the mouse is moving over the paths\n        if (\n          mouse[0] < (this.xScale?.(beginning) || 0) + this[\"margin-left\"] ||\n          mouse[0] >\n            (this.xScale?.(end) || 0) +\n              this.getSingleBaseWidth() +\n              this[\"margin-left\"]\n        ) {\n          chartGroup.selectAll(\".mouse-per-line circle\").style(\"opacity\", \"0\");\n          chartGroup.selectAll(\".mouse-per-line text\").style(\"opacity\", \"0\");\n        } else {\n          const features: Record<string, LineValue | undefined> = {};\n          const seqPosition = Math.floor(\n            this.xScale?.invert(mouse[0] - this[\"margin-left\"]) || 0,\n          );\n\n          chartGroup\n            .selectAll<SVGCircleElement, LineData>(\".mouse-per-line circle\")\n            .style(\"opacity\", (d) => {\n              // In case there is a gap or break in the graph, circle and text are not shown\n              const value = d.values.find((v) => v.position === seqPosition);\n              if (value) {\n                return value.value ? \"1\" : \"0\";\n              }\n              return \"0\";\n            });\n          chartGroup.selectAll(\".mouse-per-line text\").style(\"opacity\", \"1\");\n\n          chartGroup\n            .selectAll<SVGTextContentElement, LineData>(\".mouse-per-line text\")\n            .text((d) => {\n              const value = d.values.find((v) => v.position === seqPosition);\n              features[d.name] = value;\n              return value ? value.value : \"\";\n            });\n\n          chartGroup\n            .selectAll<SVGGElement, LineData>(\".mouse-per-line\")\n            .attr(\"transform\", (d, i) => {\n              let beginning = 0;\n              let end = lines.nodes()[i].getTotalLength();\n              let pos: DOMPoint;\n              /*\n             Finding the nearest point in the path to the mouse pointer using iterative dichotomy.\n             Example can be found here - https://bl.ocks.org/larsenmtl/e3b8b7c2ca4787f77d78f58d41c3da91\n             */\n              // eslint-disable-next-line no-constant-condition\n              while (true) {\n                const target = Math.floor((beginning + end) / 2);\n                pos = lines.nodes()[i].getPointAtLength(target);\n                if (\n                  (target === end || target === beginning) &&\n                  pos.x !== mouse[0]\n                ) {\n                  break;\n                }\n                if (pos.x > mouse[0]) end = target;\n                else if (pos.x < mouse[0]) beginning = target;\n                else break; // position found\n              }\n              return `translate(${mouse[0]},${pos?.y || 0})`;\n            });\n\n          const detail = {\n            eventtype: \"mouseover\",\n            feature: features,\n            highlight: `${seqPosition}:${seqPosition}`,\n            type: this.type,\n            target: this,\n          };\n          this.dispatchEvent(\n            new CustomEvent(\"change\", {\n              detail,\n              bubbles: true,\n              cancelable: true,\n            }),\n          );\n        }\n      });\n  }\n\n  refresh() {\n    if (this.#chart) {\n      this.#chart\n        .selectAll<SVGPathElement, LineData>(\"path.graph\")\n        .attr(\"d\", (d) => this.drawLine(d)(d.values));\n\n      this.svg?.attr(\"width\", this.width);\n\n      this.updateHighlight();\n\n      this.renderMarginOnGroup(this.#margins);\n    }\n  }\n  onDimensionsChange(): void {\n    super.onDimensionsChange();\n    this.#overlay?.attr(\"width\", this.width).attr(\"height\", this.height);\n  }\n\n  _initYScale() {\n    this.yScale\n      ?.domain([this.#minRange || 0, this.#maxRange || 0])\n      .range([this.height, 0]);\n  }\n\n  drawLine(d: LineData): Area<LineValue> | Line<LineValue> {\n    const curve = d.lineCurve || \"curveLinear\";\n\n    let graph;\n    if (d.fill !== \"none\") {\n      graph = area<LineValue>()\n        .y1((d) => this.yScale?.(d.value) || 0)\n        .y0(() => this.yScale?.(0) || 0);\n    } else {\n      graph = line<LineValue>().y((d) => this.yScale?.(d.value) || 0);\n    }\n\n    return graph\n      .defined((d) => d.value !== null) // To have gaps in the line graph\n      .x((d, i, data) => {\n        let offset = this.getSingleBaseWidth() / 2;\n        if (i === 0 || data[i - 1]?.value === null) {\n          offset = this.getSingleBaseWidth();\n        } else if (i + 1 === data.length || data[i + 1]?.value === null) {\n          offset = 0;\n        }\n        return this.getXFromSeqPosition(d.position + 1) - offset;\n      })\n      .curve(curves[curve] || curveLinear);\n  }\n\n  protected updateHighlight() {\n    if (!this.#highlighted) return;\n    const highlighs = this.#highlighted\n      .selectAll<\n        SVGRectElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"rect\")\n      .data(this.highlightedRegion.segments);\n\n    highlighs\n      .enter()\n      .append(\"rect\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighs)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"height\", this.height)\n      .attr(\"x\", (d) => this.getXFromSeqPosition(d.start))\n      .attr(\"width\", (d) => this.getSingleBaseWidth() * (d.end - d.start + 1));\n\n    highlighs.exit().remove();\n  }\n\n  zoomRefreshed() {\n    this.refresh();\n  }\n\n  firstUpdated() {\n    this.createTrack();\n  }\n\n  render() {\n    return html`<svg class=\"container\"></svg>`;\n  }\n}\n\nexport default NightingaleLinegraphTrack;\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(area);\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n","import NightingaleLineGraphTrack from \"./nightingale-linegraph-track\";\nexport type { LineData, LineValue } from \"./nightingale-linegraph-track\";\nexport default NightingaleLineGraphTrack;\n","import { customElement, property, state } from \"lit/decorators.js\";\nimport NightingaleElement from \"@nightingale-elements/nightingale-new-core\";\n\n@customElement(\"nightingale-manager\")\nclass NightingaleManager extends NightingaleElement {\n  @property({\n    converter: {\n      fromAttribute: (value): Map<string, null> | null => {\n        if (!value) {\n          return null;\n        }\n        const attributes = value.split(\",\");\n        if (attributes.indexOf(\"type\") !== -1)\n          throw new Error(\"'type' can't be used as a protvista attribute\");\n        if (attributes.indexOf(\"value\") !== -1)\n          throw new Error(\"'value' can't be used as a protvista attribute\");\n        const mapToReturn = new Map(\n          attributes\n            .filter(\n              (attr: string) =>\n                !NightingaleManager.observedAttributes.includes(attr),\n            )\n            .map((attr: string) => [attr, null]),\n        );\n        return mapToReturn;\n      },\n      toAttribute: (value: []) => {\n        return value.join(\",\");\n      },\n    },\n  })\n  \"reflected-attributes\"?: Map<string, null> = new Map();\n\n  @property({ type: Number })\n  length?: number;\n\n  @property({ type: Number })\n  \"display-start\"?: number;\n\n  @property({ type: Number })\n  \"display-end\"?: number;\n\n  @property({ type: String })\n  \"highlight\"?: string;\n\n  @state()\n  protvistaElements = new Set<HTMLElement>();\n\n  @state()\n  propertyValues = new Map<string, string>();\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener(\"change\", this.changeListener as EventListener);\n    this.style.display = \"unset\";\n  }\n\n  override attributeChangedCallback(\n    attr: string,\n    previousValue: string | null,\n    newValue: string | null,\n  ) {\n    super.attributeChangedCallback(attr, previousValue, newValue);\n    this.applyAttributes();\n  }\n\n  applyAttributes() {\n    this.protvistaElements.forEach((element: HTMLElement) => {\n      this[\"reflected-attributes\"]?.forEach((value, type) => {\n        if (value === false || value === null || value === undefined) {\n          element.removeAttribute(type);\n        } else {\n          element.setAttribute(type, typeof value === \"boolean\" ? \"\" : value);\n        }\n      });\n      // Default properties\n      if (this.length) {\n        element.setAttribute(\"length\", `${this.length}`);\n      }\n      if (this[\"display-end\"]) {\n        element.setAttribute(\"display-end\", `${this[\"display-end\"]}`);\n      }\n      if (this[\"display-start\"]) {\n        element.setAttribute(\"display-start\", `${this[\"display-start\"]}`);\n      }\n      if (this.highlight) {\n        element.setAttribute(\"highlight\", this.highlight);\n      }\n    });\n  }\n\n  register(element: NightingaleElement) {\n    this.protvistaElements.add(element);\n    this.applyAttributes();\n  }\n\n  unregister(element: NightingaleElement) {\n    this.protvistaElements.delete(element);\n  }\n\n  applyProperties(forElementId: string) {\n    if (forElementId) {\n      const element = this.querySelector(`#${forElementId}`) as HTMLElement;\n      if (!element) {\n        return;\n      }\n      this.propertyValues.forEach((value, type) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (element as any)[type] = value;\n      });\n    } else {\n      this.protvistaElements.forEach((element: HTMLElement) => {\n        if (!element) {\n          return;\n        }\n        this.propertyValues.forEach((value, type) => {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (element as any)[type] = value;\n        });\n      });\n    }\n  }\n\n  isRegisteredAttribute(attributeName: string) {\n    if (!this[\"reflected-attributes\"]) {\n      return false;\n    }\n    return (\n      [...this[\"reflected-attributes\"].keys()].includes(attributeName) ||\n      NightingaleManager.observedAttributes.includes(attributeName)\n    );\n  }\n\n  changeListener(e: CustomEvent) {\n    if (!e.detail) {\n      return;\n    }\n    switch (e.detail.handler) {\n      case \"property\":\n        this.propertyValues.set(e.detail.type, e.detail.value);\n        this.applyProperties(e.detail.for);\n        break;\n      default:\n        if (this.isRegisteredAttribute(e.detail.type)) {\n          this[\"reflected-attributes\"]?.set(e.detail.type, e.detail.value);\n        }\n        Object.keys(e.detail).forEach((key) => {\n          if (this.isRegisteredAttribute(key)) {\n            this[\"reflected-attributes\"]?.set(key, e.detail[key]);\n          }\n        });\n        this.applyAttributes();\n    }\n  }\n}\n\nexport default NightingaleManager;\n","import NightingaleManager from \"./nightingale-manager\";\nexport default NightingaleManager;\n","import { html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport {\n  scaleLinear,\n  ScaleLinear,\n  Selection,\n  axisBottom,\n  Axis,\n  brushX,\n  BrushBehavior,\n  BrushSelection,\n  select,\n  NumberValue,\n} from \"d3\";\n\nimport NightingaleElement, {\n  withDimensions,\n  withPosition,\n  withMargin,\n  withResizable,\n  withManager,\n  withHighlight,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nconst HANDLE_SIZE = 6;\n\n@customElement(\"nightingale-navigation\")\nclass NightingaleNavigation extends withManager(\n  withResizable(\n    withMargin(withPosition(withDimensions(withHighlight(NightingaleElement)))),\n  ),\n) {\n  #x: ScaleLinear<number, number> | null;\n  #dontDispatch: boolean;\n  #svg?: Selection<SVGSVGElement, unknown, HTMLElement | null, unknown>;\n  #displaystartLabel?: Selection<\n    SVGTextElement,\n    unknown,\n    HTMLElement | null,\n    unknown\n  >;\n  #displayendLabel?: Selection<\n    SVGTextElement,\n    unknown,\n    HTMLElement | null,\n    unknown\n  >;\n  #axis?: Selection<SVGGElement, unknown, HTMLElement | null, unknown>;\n  #brushG?: Selection<SVGGElement, unknown, HTMLElement | null, unknown>;\n  #polygon?: Selection<SVGPolygonElement, unknown, HTMLElement | null, unknown>;\n  #xAxis?: Axis<NumberValue>;\n  #viewport?: BrushBehavior<unknown>;\n  #highlighted?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #margins?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #currentSelection: BrushSelection | null = null;\n\n  @property({ type: Number })\n  \"ruler-start\"?: number = 1;\n  @property({ type: Number })\n  \"ruler-padding\"?: number = 10;\n  @property({ type: Number })\n  \"scale-factor\"?: number = (this.length || 0) / 5 || 10;\n  @property({ type: Boolean })\n  \"show-highlight\"?: boolean = false;\n\n  constructor() {\n    super();\n    this.#x = null;\n    this.#dontDispatch = false;\n  }\n\n  private createNavRuler() {\n    const limit =\n      this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number);\n    this.#x = scaleLinear()\n      .range([this[\"margin-left\"] + (this[\"ruler-padding\"] as number), limit])\n      .domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1),\n      ]);\n    this.#svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"id\", \"\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height);\n\n    this.#xAxis = axisBottom(this.#x);\n\n    this.#displaystartLabel = this.#svg\n      .append(\"text\")\n      .attr(\"class\", \"start-label\")\n      .attr(\"x\", this[\"margin-left\"])\n      .attr(\"y\", this.height - this[\"margin-bottom\"] - 2)\n      .style(\"font-family\", \"sans-serif\")\n      .style(\"font-size\", 12);\n\n    this.#displayendLabel = this.#svg\n      .append(\"text\")\n      .attr(\"class\", \"end-label\")\n      .attr(\"x\", this.width - this[\"margin-right\"])\n      .attr(\"y\", this.height - this[\"margin-bottom\"] - 2)\n      .attr(\"text-anchor\", \"end\")\n      .style(\"font-family\", \"sans-serif\")\n      .style(\"font-size\", 12);\n\n    this.#axis = this.#svg\n      .append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .call(this.#xAxis);\n\n    this.#viewport = brushX()\n      .extent([\n        [this[\"margin-left\"] + (this[\"ruler-padding\"] as number), 0],\n        [limit, this.height * 0.5 + HANDLE_SIZE / 2],\n      ])\n      .handleSize(HANDLE_SIZE)\n      .on(\"end\", ({ selection }) => {\n        // In case is a click outside the brush, reset brush to previous position\n        if (\n          selection === null &&\n          this.#currentSelection &&\n          this.#brushG &&\n          this.#viewport\n        ) {\n          this.#brushG.call(this.#viewport.move, this.#currentSelection);\n        }\n      })\n      .on(\"brush\", ({ selection, transform }) => {\n        if (selection && this.#x) {\n          this.#currentSelection = selection;\n          this[\"display-start\"] =\n            Math.round(this.#x.invert(selection[0]) * 100) / 100;\n          this[\"display-end\"] =\n            Math.round(this.#x.invert(selection[1]) * 100) / 100;\n          if (!this.#dontDispatch)\n            this.dispatchEvent(\n              new CustomEvent(\"change\", {\n                detail: {\n                  \"display-end\": this[\"display-end\"],\n                  \"display-start\": this[\"display-start\"],\n                  extra: { transform },\n                },\n                bubbles: true,\n                cancelable: true,\n              }),\n            );\n          this.updateLabels();\n          this.updatePolygon();\n        }\n      });\n\n    this.#brushG = this.#svg.append(\"g\").attr(\"class\", \"brush\");\n\n    if (limit > 0) {\n      this.#brushG.call(this.#viewport);\n\n      this.#brushG.call(this.#viewport.move, [\n        this.#x(this.getStart()),\n        this.#x(this.getEnd()),\n      ]);\n    }\n\n    this.#polygon = this.#svg\n      .append(\"polygon\")\n      .attr(\"class\", \"zoom-polygon\")\n      .attr(\"fill\", \"#777\")\n      .attr(\"fill-opacity\", \"0.3\");\n\n    this.#margins = this.#svg.append(\"g\").attr(\"class\", \"margin\");\n    this.createHighlight();\n    this.renderD3();\n  }\n  private createHighlight() {\n    if (!this.#svg) return;\n    this.#highlighted = this.#svg.append(\"g\").attr(\"class\", \"highlighted\");\n    this.updateHighlight();\n  }\n\n  onDimensionsChange() {\n    if (!this.#x) return;\n    this.#x.range([\n      this[\"margin-left\"] + (this[\"ruler-padding\"] as number),\n      this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n    ]);\n    this.#svg?.attr(\"width\", this.width);\n    this.#svg?.attr(\"height\", this.height);\n    this.#viewport?.extent([\n      [this[\"margin-left\"] + (this[\"ruler-padding\"] as number), 0],\n      [\n        this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n        this.height * 0.5 + HANDLE_SIZE / 2,\n      ],\n    ]);\n    if (this.#viewport) this.#brushG?.call(this.#viewport);\n  }\n\n  render() {\n    return html`<svg class=\"container\"></svg>`;\n  }\n  updated(changedProperties: Map<string, unknown>) {\n    this.renderD3();\n    super.updated(changedProperties);\n  }\n\n  firstUpdated() {\n    this.createNavRuler();\n  }\n  renderD3() {\n    if (this.#x && this.#axis && this.#xAxis && this.#viewport) {\n      this.#x.domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1) - 1,\n      ]);\n      this.#axis.call(this.#xAxis);\n      this.updatePolygon();\n      this.updateLabels();\n      const position: BrushSelection = [\n        this.#x(this.getStart()),\n        this.#x(this.getEnd()),\n      ];\n      if (this.#brushG && position[0] >= 0 && position[1] >= 0) {\n        this.#dontDispatch = true;\n        this.#brushG.call(this.#viewport.move, position);\n        this.#dontDispatch = false;\n      }\n      this.updateHighlight();\n      this.renderMarginOnGroup(this.#margins);\n    }\n  }\n\n  locate(start: number, end: number) {\n    if (this.#brushG && this.#viewport && this.#x)\n      this.#brushG.call(this.#viewport.move, [this.#x(start), this.#x(end)]);\n  }\n  zoomOut() {\n    this.locate(\n      Math.max(\n        (this[\"ruler-start\"] as number) || 1,\n        this.getStart() - (this[\"scale-factor\"] as number),\n      ),\n      Math.min(\n        (this.length || 1) + (this[\"ruler-start\"] as number) - 1,\n        this.getEnd() + (this[\"scale-factor\"] as number),\n      ),\n    );\n  }\n  zoomIn() {\n    const newStart = Math.min(\n      this.getStart() + (this[\"scale-factor\"] as number),\n      this.getEnd() - 1,\n    );\n    this.locate(\n      newStart,\n      Math.max(this.getEnd() - (this[\"scale-factor\"] as number), newStart + 1),\n    );\n  }\n  protected updateHighlight() {\n    if (!this.#highlighted) return;\n    // Scale to match the range of the tracks [1,length+1]\n    const s1 = scaleLinear()\n      .domain([\n        this[\"display-start\"] || 1,\n        (this[\"display-end\"] || this.length || 1) + 1,\n      ])\n      .range([this[\"margin-left\"], this.width - this[\"margin-right\"]]);\n\n    // Scale to match the range of the navigation brush [1,length]\n    const s2 = scaleLinear()\n      .domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1),\n      ])\n      .range([\n        this[\"margin-left\"] + (this[\"ruler-padding\"] as number),\n        this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n      ]);\n\n    // Highlight Polygon\n    const highlighs = this.#highlighted\n      .selectAll<\n        SVGPolygonElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"polygon\")\n      .data(this[\"show-highlight\"] ? this.highlightedRegion.segments : []);\n\n    highlighs\n      .enter()\n      .append(\"polygon\")\n      .attr(\"class\", \"highlight-polygon\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighs)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"points\", (segment) => {\n        const start = Math.max(1, segment.start);\n        const end = Math.min(this.length || 1, segment.end) + 1;\n        return `${s2(start)},${this.height / 2}\n        ${s2(end)},${this.height / 2}\n        ${s1(end)},${this.height}\n        ${s1(start)},${this.height}`;\n      });\n\n    highlighs.exit().remove();\n    const highlighsRect = this.#highlighted\n      .selectAll<\n        SVGRectElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"rect\")\n      .data(this[\"show-highlight\"] ? this.highlightedRegion.segments : []);\n\n    // Highlight Rectangle\n    highlighsRect\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"highlight-rectangle\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighsRect)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"x\", (segment) => s2(Math.max(1, segment.start)))\n      .attr(\n        \"width\",\n        (segment) =>\n          s2(Math.min(this.length || 1, segment.end) + 1) -\n          s2(Math.max(1, segment.start)),\n      )\n      .attr(\"y\", this[\"margin-top\"])\n      .attr(\"height\", this.height / 2);\n\n    highlighsRect.exit().remove();\n  }\n  private updateLabels() {\n    if (this.#displaystartLabel)\n      this.#displaystartLabel\n        .attr(\"x\", this[\"margin-left\"])\n        .text(Math.round(this.getStart()));\n    if (this.#displayendLabel)\n      this.#displayendLabel\n        .attr(\"x\", this.width - this[\"margin-right\"])\n        .text(Math.round(this.getEnd()));\n  }\n\n  private updatePolygon() {\n    if (this.#polygon && this.#x)\n      this.#polygon.attr(\n        \"points\",\n        `${this.#x(this.getStart())},${this.height / 2}\n        ${this.#x(this.getEnd())},${this.height / 2}\n        ${this.width - this[\"margin-right\"]},${this.height}\n        ${this[\"margin-left\"]},${this.height}`,\n      );\n  }\n  private getStart(): number {\n    return this[\"display-start\"] || 1;\n  }\n  private getEnd(): number {\n    return (\n      ((this[\"display-end\"] || 0) > 0 ? this[\"display-end\"] : this.length) || 1\n    );\n  }\n}\n\nexport default NightingaleNavigation;\n","import NightingaleNavigation from \"./nightingale-navigation\";\nexport default NightingaleNavigation;\n","import { html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport * as rasterizeHTML from \"rasterizehtml\";\nimport NightingaleElement from \"@nightingale-elements/nightingale-new-core\";\n\n// Accepted file formats\nexport const formats = [\"png\", \"jpeg\", \"bmp\", \"tiff\", \"gif\"];\n\n@customElement(\"nightingale-saver\")\nclass NightingaleSaver extends NightingaleElement {\n  @property({ type: String, attribute: \"element-id\" })\n  elementId?: string = \"\";\n  @property({ type: String, attribute: \"background-color\" })\n  fillColor?: string = \"transparent\";\n  @property({ type: String, attribute: \"file-name\" })\n  fileName?: string = \"nightingale.snapshot\";\n  @property({\n    type: String,\n    attribute: \"file-format\",\n    converter: (value) => (formats.includes(value || \"\") ? value : \"png\"),\n  })\n  fileFormat?: string = \"png\";\n  @property({ type: Number, attribute: \"extra-width\" })\n  extraWidth?: number = 0;\n  @property({ type: Number, attribute: \"extra-height\" })\n  extraHeight?: number = 0;\n  @property({ type: Number, attribute: \"scale-factor\" })\n  scaleFactor?: number = 1;\n  @property({ type: Boolean })\n  preview?: boolean = false;\n\n  preSave?: () => void = undefined;\n  postSave?: () => void = undefined;\n\n  constructor() {\n    super();\n    this.saveSvg = this.saveSvg.bind(this);\n  }\n  saveSvg() {\n    const element = document.querySelector<HTMLElement>(`#${this.elementId}`);\n    if (!element) {\n      throw new Error(\n        \"The 'element-id' attribute is not related with a current DOM element\",\n      );\n    }\n    element.style.display = \"block\"; // In order to get the width and height of protvista manager, its display has to be set to block\n\n    // PreSave function allows to do anything before actually printing on the canvas\n    if (typeof this.preSave === \"function\") {\n      this.preSave();\n    }\n    element.querySelector(\"canvas.preview\")?.remove();\n    const { width, height } = element.getBoundingClientRect();\n\n    const scaleFactor = this.scaleFactor || 1;\n    const scaledWidth = scaleFactor * (width + (this.extraWidth as number));\n    const scaledHeight = scaleFactor * (height + (this.extraHeight as number));\n    const canvas = document.createElement(\"canvas\");\n    canvas.className = \"preview\";\n    canvas.setAttribute(\"width\", `${scaledWidth}px`);\n    canvas.setAttribute(\"height\", `${scaledHeight}px`);\n    if (this.fillColor) {\n      const context = canvas.getContext(\"2d\");\n      if (context) {\n        context.fillStyle = this.fillColor;\n        context.fillRect(0, 0, scaledWidth, scaledHeight);\n      }\n    }\n    if (this.preview) {\n      element.appendChild(canvas);\n    }\n\n    // Rendering the Protvista svg\n    rasterizeHTML\n      .drawHTML(wrapHTML(element.outerHTML), canvas, {\n        zoom: scaleFactor,\n      })\n      .then(() => {\n        const image = canvas\n          .toDataURL(`image/${this.fileFormat}`, 1.0)\n          .replace(`image/${this.fileFormat}`, \"image/octet-stream\");\n        if (!this.preview) {\n          const link = document.createElement(\"a\");\n          link.download = `${this.fileName}.${this.fileFormat}`;\n          link.href = image;\n          document.body.appendChild(link);\n          link.click();\n        }\n      })\n      .catch((err) => {\n        console.error(err);\n        throw new Error(\n          `Couldn't generate the snapshot for the element '${this.elementId}'`,\n        );\n      })\n      .finally(() => {\n        element.style.display = \"\"; // Display property is set back to its original value\n        // Reverting the changes to the dom if it had been changed during the preSave\n        if (typeof this.postSave === \"function\") {\n          this.postSave();\n        }\n      });\n  }\n\n  render() {\n    /* The component only supports button as child and it has to be the first child element. If not, an error is thrown. By default,\n        a save button is shown if nothing is specified. */\n    let button;\n    // const save = () => this.saveSvg();\n    if (this.hasChildNodes()) {\n      const child = this.firstElementChild;\n      if (child?.tagName === \"BUTTON\") {\n        child.addEventListener(\"click\", this.saveSvg);\n        button = html` ${child} `;\n      } else {\n        console.error(\"Only Buttons are accepted as children\");\n      }\n    } else {\n      button = html`\n        <button\n          style=\"background-color: #1878ba; color: white; cursor: pointer; display: inline-block;padding: 0.5rem 0.5rem; border-radius: 4px; margin-bottom: 5px;\"\n          @click=${this.saveSvg}\n        >\n          Download\n        </button>\n      `;\n    }\n    return button;\n  }\n}\n\nexport default NightingaleSaver;\n\nconst wrapHTML = (html: string) =>\n  `\n<html>\n  <head>\n    <style>\n      html, body {\n        padding: 0;\n        margin: 0;\n      }\n    </style>\n  </head>\n  <body>${html}</body>\n</html>\n`;\n","import NightingaleSaver from \"./nightingale-saver\";\nexport default NightingaleSaver;\n","import { html } from \"lit\";\nimport { property } from \"lit/decorators.js\";\nimport { axisBottom, select, Selection } from \"d3\";\n\nimport NightingaleElement, {\n  withDimensions,\n  withPosition,\n  withMargin,\n  withResizable,\n  withHighlight,\n  withManager,\n  withZoom,\n  bindEvents,\n  customElementOnce,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nconst DEFAULT_NUMBER_OF_TICKS = 3;\n\nexport type SequenceBaseType = { position: number; aa: string };\n\n@customElementOnce(\"nightingale-sequence\")\nclass NightingaleSequence extends withManager(\n  withZoom(\n    withResizable(\n      withMargin(\n        withPosition(withDimensions(withHighlight(NightingaleElement))),\n      ),\n    ),\n  ),\n) {\n  @property({ type: String })\n  sequence?: string | null;\n  // svg?: Selection<SVGSVGElement, unknown, HTMLElement | null, unknown>;\n  #seq_bg?: Selection<\n    SVGGElement,\n    SequenceBaseType | unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #axis?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  protected seq_g?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  protected highlighted?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  margins?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #bases?: Selection<\n    SVGTextElement,\n    SequenceBaseType,\n    SVGElement | null,\n    unknown\n  >;\n  numberOfTicks?: number;\n  chWidth?: number;\n  chHeight?: number;\n\n  connectedCallback() {\n    super.connectedCallback();\n    const ticks = parseInt(this.getAttribute(\"numberofticks\") || \"\", 10);\n    this.numberOfTicks = Number.isInteger(ticks)\n      ? ticks\n      : DEFAULT_NUMBER_OF_TICKS;\n    this.addEventListener(\"load\", (e: Event) => {\n      this.data = (e as CustomEvent).detail.payload;\n    });\n  }\n\n  get data() {\n    return this.sequence || \"\";\n  }\n\n  set data(data: string | Record<string, unknown>) {\n    if (typeof data === \"string\") this.sequence = data;\n    else if (typeof data?.sequence === \"string\") this.sequence = data.sequence;\n\n    if (this.svg) {\n      this.updateScaleDomain();\n      this.applyZoomTranslation();\n    }\n  }\n\n  protected getCharSize() {\n    if (!this.seq_g) return;\n    const xratio = 0.8;\n    const yratio = 1.6;\n    const node = this.seq_g.select<SVGTextElement>(\"text.base\").node();\n    if (node) {\n      this.chWidth = node.getBBox().width * xratio;\n      this.chHeight = node.getBBox().height * yratio;\n    } else {\n      // Add a dummy node to measure the width\n      const tempNode = this.seq_g\n        .append(\"text\")\n        .attr(\"class\", \"base\")\n        .text(\"T\");\n      this.chWidth = (tempNode.node()?.getBBox().width || 0) * xratio;\n      this.chHeight = (tempNode.node()?.getBBox().height || 0) * yratio;\n      tempNode.remove();\n    }\n  }\n\n  protected createSequence() {\n    this.svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"id\", \"\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height);\n\n    this.#seq_bg = this.svg?.append(\"g\").attr(\"class\", \"background\");\n\n    this.#axis = this.svg?.append(\"g\").attr(\"class\", \"x axis\");\n\n    this.seq_g = this.svg\n      ?.append(\"g\")\n      .attr(\"class\", \"sequence\")\n      .attr(\n        \"transform\",\n        `translate(0,${\n          this[\"margin-top\"] + 0.75 * this.getHeightWithMargins()\n        })`,\n      );\n\n    this.highlighted = this.svg.append(\"g\").attr(\"class\", \"highlighted\");\n    this.margins = this.svg.append(\"g\").attr(\"class\", \"margin\");\n    if (this.sequence) {\n      this.updateScaleDomain();\n      this.applyZoomTranslation();\n    }\n  }\n\n  firstUpdated() {\n    this.createSequence();\n  }\n\n  zoomRefreshed() {\n    this.renderD3();\n  }\n\n  renderD3() {\n    this.getCharSize();\n\n    this.svg?.attr(\"width\", this.width).attr(\"height\", this.height);\n\n    if (this.#axis) {\n      const ftWidth = this.getSingleBaseWidth();\n      const space = ftWidth - (this.chWidth || 0);\n      const half = ftWidth / 2;\n      const first = Math.floor(Math.max(0, this.getStart() - 1));\n      const last = Math.ceil(\n        Math.min(this.sequence?.length || 0, this.getEnd()),\n      );\n      const bases: Array<SequenceBaseType> =\n        space < 0\n          ? []\n          : this.sequence\n              ?.slice(first, last)\n              .split(\"\")\n              .map((aa, i) => ({\n                position: 1 + first + i,\n                aa,\n              })) || [];\n\n      // only add axis if there is room\n      if (this.height > (this.chWidth || 0) && this.xScale) {\n        const xAxis = axisBottom(this.xScale)\n          .tickFormat((d) => `${Number.isInteger(d) ? d : \"\"}`)\n          .ticks(this.numberOfTicks, \"s\");\n        this.#axis.call(xAxis);\n      }\n\n      this.#axis.attr(\n        \"transform\",\n        `translate(${this[\"margin-left\"] + half},${this[\"margin-top\"]})`,\n      );\n      this.#axis.select(\".domain\").remove();\n      this.#axis.selectAll(\".tick line\").remove();\n      this.#axis.selectAll(\".tick text\").attr(\"y\", 2);\n\n      const size = Math.max(\n        10,\n        this.chWidth || 10,\n        Math.min(\n          this[\"margin-top\"] + 0.25 * this.getHeightWithMargins(),\n          ftWidth - 2,\n        ),\n      );\n      this.#axis.selectAll(\".tick text\").attr(\"font-size\", size);\n\n      if (this.seq_g) {\n        this.seq_g.attr(\n          \"transform\",\n          `translate(0,${\n            this[\"margin-top\"] + 0.75 * this.getHeightWithMargins()\n          })`,\n        );\n        this.#bases = this.seq_g.selectAll(\"text.base\");\n\n        const textElements = this.#bases.data(\n          bases,\n          (d) => (d as SequenceBaseType).position,\n        );\n\n        textElements\n          .enter()\n          .append(\"text\")\n          .attr(\"class\", \"base\")\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"x\", (d) => this.getXFromSeqPosition(d.position) + half)\n          .text((d) => d.aa)\n          .attr(\"font-size\", size)\n          .style(\"pointer-events\", \"none\")\n          .style(\"font-family\", \"monospace\");\n\n        textElements.exit().remove();\n\n        textElements\n          .attr(\"font-size\", size)\n          .attr(\"x\", (d) => this.getXFromSeqPosition(d.position) + half);\n\n        if (this.#seq_bg) {\n          const background = this.#seq_bg\n            .selectAll(\"rect.base_bg\")\n            .data(bases, (d) => (d as SequenceBaseType).position);\n          background\n            .enter()\n            .append(\"rect\")\n            .attr(\"class\", \"base_bg feature\")\n            .attr(\"height\", this.getHeightWithMargins())\n            .attr(\"width\", ftWidth)\n            .attr(\"fill\", (d) => (Math.round(d.position) % 2 ? \"#ccc\" : \"#eee\"))\n            .attr(\"x\", (d) => this.getXFromSeqPosition(d.position))\n            .attr(\"y\", this[\"margin-top\"])\n            .style(\"opacity\", Math.min(1, space))\n            .call(bindEvents, this);\n\n          background\n            .attr(\"width\", ftWidth)\n            .attr(\"fill\", (d) => (Math.round(d.position) % 2 ? \"#ccc\" : \"#eee\"))\n            .attr(\"height\", this.getHeightWithMargins())\n            .attr(\"x\", (d) => this.getXFromSeqPosition(d.position))\n            .attr(\"y\", this[\"margin-top\"]);\n\n          background.exit().remove();\n\n          this.seq_g.style(\"opacity\", Math.min(1, space));\n          background.style(\"opacity\", Math.min(1, space));\n        }\n      }\n\n      this.updateHighlight();\n      this.renderMarginOnGroup(this.margins);\n    }\n  }\n\n  protected getStart(): number {\n    return this[\"display-start\"] || 1;\n  }\n  protected getEnd(): number {\n    return (\n      ((this[\"display-end\"] || 0) > 0 ? this[\"display-end\"] : this.length) || 0\n    );\n  }\n\n  protected updateHighlight() {\n    if (!this.highlighted) return;\n    const highlighs = this.highlighted\n      .selectAll<\n        SVGRectElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"rect\")\n      .data(this.highlightedRegion.segments);\n\n    highlighs\n      .enter()\n      .append(\"rect\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighs)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"height\", this.height)\n      .attr(\"x\", (d) => this.getXFromSeqPosition(d.start))\n      .attr(\"width\", (d) =>\n        Math.max(0, this.getSingleBaseWidth() * (d.end - d.start + 1)),\n      );\n\n    highlighs.exit().remove();\n  }\n\n  render() {\n    return html`<svg class=\"container\"></svg>`;\n  }\n}\n\nexport default NightingaleSequence;\n","import NightingaleSequence from \"./nightingale-sequence\";\nexport type { SequenceBaseType } from \"./nightingale-sequence\";\nexport default NightingaleSequence;\n","import {\n  VariationData,\n  VariationDatum,\n  ProcessedVariationData,\n} from \"./nightingale-variation\";\n\nfunction processVariants(data?: VariationData): {\n  mutationArray: ProcessedVariationData[];\n  aaPresence: Record<string, boolean>;\n} | null {\n  const { variants, sequence } = data || {};\n  if (!sequence || !variants) return null;\n  const aaPresence: Record<string, boolean> = {};\n\n  const seq = sequence.split(\"\");\n\n  const mutationArray = seq.map((aa, i) => {\n    return {\n      type: \"VARIANT\",\n      normal: aa,\n      pos: i + 1,\n      variants: [] as VariationDatum[],\n    };\n  });\n\n  variants.forEach((variant) => {\n    if (mutationArray[variant.start - 1]) {\n      // Currently not dealing with variants outside of sequence\n      mutationArray[variant.start - 1].variants.push(variant);\n      aaPresence[variant.variant || \"\"] = true;\n    }\n  });\n  return { mutationArray, aaPresence };\n}\n\nexport default processVariants;\n","import { select, scalePow, ScalePower, Selection } from \"d3\";\nimport NightingaleVariation from \"./nightingale-variation\";\nimport { ProcessedVariationData } from \"./nightingale-variation\";\nimport { bindEvents } from \"@nightingale-elements/nightingale-new-core\";\n\nclass VariationPlot {\n  _frequency: ScalePower<number, number>;\n\n  constructor() {\n    this._frequency = scalePow().exponent(0.001).domain([0, 1]).range([5, 10]);\n    // Data bind otherwise babel removes it\n    this.drawVariationPlot = this.drawVariationPlot.bind(this);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  drawVariationPlot(\n    selection: Selection<\n      SVGGElement,\n      ProcessedVariationData[],\n      HTMLElement | SVGElement | null,\n      unknown\n    >,\n    element: NightingaleVariation\n  ) {\n    const ftWidth = element.getSingleBaseWidth();\n    const half = ftWidth / 2;\n    // Iterate over data\n    selection.each((data, i, nodes) => {\n      // Generate chart\n      const series = select(nodes[i]);\n\n      // Only draw positions where there is data\n      const withVariants = data.filter((elem) => elem.variants.length !== 0);\n\n      // bind data\n      const bars = series\n        .selectAll<SVGGElement, ProcessedVariationData>(\"g\")\n        .data(withVariants, (d) => d.pos);\n\n      bars.exit().remove();\n\n      // On enter append for each data point\n      const circle = bars\n        .enter()\n        .append(\"g\")\n        .merge(bars)\n        .selectAll<SVGCircleElement, ProcessedVariationData>(\"circle\")\n        .data((d) => d.variants);\n\n      circle.exit().remove();\n\n      circle\n        .enter()\n        .append(\"circle\")\n        .merge(circle)\n        .attr(\"class\", \"feature\")\n        .attr(\"title\", (d) => d.start)\n        .attr(\"r\", (d) => (d.size ? d.size : 5))\n        .attr(\"cx\", (d) => {\n          return element.getXFromSeqPosition(d.start) + half;\n        })\n        .attr(\"cy\", (d) => {\n          return element.yScale?.(d.variant.charAt(0)) || 0;\n        })\n        .attr(\"name\", (d) => {\n          const mutation =\n            d.alternativeSequence === \"*\" ? \"STOP\" : d.alternativeSequence;\n          // eslint-disable-next-line no-param-reassign\n          d.internalId = `var_${d.wildType}${d.start}${mutation}`;\n          return d.internalId;\n        })\n        .attr(\"fill\", (d) => {\n          return d.color ? d.color : element.colorConfig(d);\n        })\n        .call(bindEvents, element);\n    });\n  }\n}\n\nexport default VariationPlot;\n","import { VariationDatum } from \"./nightingale-variation\";\n\nexport type ProteinsAPIVariation = {\n  accession: string;\n  entryName: string;\n  proteinName: string;\n  geneName: string;\n  organismName: string;\n  proteinExistence: string;\n  sequence: string;\n  sequenceChecksum: string;\n  sequenceVersion: number;\n  taxid: number;\n  features: Variant[];\n};\n\nexport type Variant = {\n  type: string;\n  // Note: one of the 2 following fields will be deprecated - don't know yet\n  alternativeSequence?: AminoAcid;\n  mutatedType?: AminoAcid;\n  begin: string;\n  end: string;\n  xrefs: Xref[];\n  cytogeneticBand: string;\n  genomicLocation?: string[];\n  locations: Location[];\n  codon?: string;\n  consequenceType: ConsequenceType;\n  wildType: AminoAcid;\n  predictions?: Prediction[];\n  somaticStatus: number;\n  sourceType: SourceType;\n  descriptions?: Description[];\n  clinicalSignificances?: ClinicalSignificance[];\n  association?: Association[];\n  populationFrequencies?: PopulationFrequency[];\n  evidences?: Evidence[];\n  ftId?: string;\n};\n\nexport enum AminoAcid {\n  A = \"A\",\n  C = \"C\",\n  D = \"D\",\n  E = \"E\",\n  Empty = \"*\",\n  F = \"F\",\n  G = \"G\",\n  H = \"H\",\n  I = \"I\",\n  K = \"K\",\n  L = \"L\",\n  M = \"M\",\n  N = \"N\",\n  Nl = \"NL\",\n  P = \"P\",\n  Q = \"Q\",\n  R = \"R\",\n  S = \"S\",\n  T = \"T\",\n  V = \"V\",\n  W = \"W\",\n  Y = \"Y\",\n}\n\nexport type Association = {\n  name: string;\n  dbReferences?: Xref[];\n  evidences: Evidence[];\n  disease: boolean;\n  description?: string;\n};\n\nexport type Xref = {\n  name: string;\n  id: string;\n  url: string;\n  alternativeUrl?: string;\n};\n\n/*\n * This has been imported from the backend enums but\n * might be best kept as a string...\n */\nexport enum Source {\n  CLINVAR = \"ClinVar\",\n  ESP = \"ESP\",\n  EXAC = \"ExAC\",\n  GENOMES1K = \"1000Genomes\",\n  BOVINE_SNP50 = \"BovineSNP50\",\n  BOVINE_LD = \"BovineLD\",\n  BOVINE_HD = \"BovineHD\",\n  EQUINE_SNP50 = \"EquineSNP50\",\n  CHICKEN_600K = \"Chicken600K\",\n  KG_HQ = \"1kg_hq\",\n  COSMIC = \"cosmic curated\",\n  REVIEWED = \"reviewed\",\n  UNIPROT = \"UniProt\",\n  DBSNP = \"dbSNP\",\n  ENSEMBL = \"Ensembl\",\n  ENSEMBL_PLANTS = \"EnsemblPlants\",\n  VECTORBASE = \"VectorBase\",\n  REFSEQ = \"RefSeq\",\n  DBGAP = \"dbGaP\",\n  DDD = \"DDD\",\n  PHARMCOGKB = \"PharmGKB\",\n  ENSEMBL_FUNGI = \"EnsemblFungi\",\n  ENSEMBL_METAZOA = \"EnsemblMetazoa\",\n  GNOMAD_V2 = \"gnomAD_v2.0\",\n  GNOMAD_V3 = \"gnomAD_v3.0\",\n  TCGA = \"NCI-TCGA\",\n  TCGA_COSMIC = \"NCI-TCGA Cosmic\",\n  DECIPHER = \"ddG2P\",\n  TOPMED = \"TOPMed\",\n  GNOMAD = \"gnomAD\",\n  PHARMGKB = \"pharmgkb\",\n  SGRP = \"SGRP\",\n  SGD = \"SGD\",\n  JEFFARES_SNPS = \"Jeffares_SNPs\",\n  JEFFARES_INDELS = \"Jeffares_Indels\",\n  ENSEMBL_VIRUSES = \"EnsemblViruses\",\n}\n\nexport type Evidence = {\n  code: string;\n  source: Xref;\n};\n\nexport type ClinicalSignificance = {\n  type: ClinicalSignificanceType;\n  sources: Source[];\n};\n\nexport enum ClinicalSignificanceType {\n  Benign = \"Benign\",\n  Disease = \"Disease\",\n  LikelyBenign = \"Likely benign\",\n  LikelyPathogenic = \"Likely pathogenic\",\n  Pathogenic = \"Pathogenic\",\n  Protective = \"Protective\",\n  VariantOfUncertainSignificance = \"Variant of uncertain significance\",\n}\n\nexport enum ConsequenceType {\n  Empty = \"-\",\n  Frameshift = \"frameshift\",\n  InframeDeletion = \"inframe deletion\",\n  Insertion = \"insertion\",\n  Missense = \"missense\",\n  StopGained = \"stop gained\",\n}\n\nexport type Description = {\n  value: string;\n  sources: Source[];\n};\n\nexport type Location = {\n  loc: string;\n  seqId: string;\n  source: Source;\n};\n\nexport type PopulationFrequency = {\n  populationName: string;\n  frequency: number;\n  source: Source;\n};\n\nexport type Prediction = {\n  predictionValType: PredictionValType;\n  predictorType: string;\n  score: number;\n  predAlgorithmNameType: PredAlgorithmNameType;\n  sources: Source[];\n  version?: string;\n};\n\nexport enum PredAlgorithmNameType {\n  PolyPhen = \"PolyPhen\",\n  Sift = \"SIFT\",\n}\n\nexport enum PredictionValType {\n  Benign = \"benign\",\n  Deleterious = \"deleterious\",\n  DeleteriousLowConfidence = \"deleterious - low confidence\",\n  PossiblyDamaging = \"possibly damaging\",\n  ProbablyDamaging = \"probably damaging\",\n  Tolerated = \"tolerated\",\n  ToleratedLowConfidence = \"tolerated - low confidence\",\n  Unknown = \"unknown\",\n}\n\nexport enum SourceType {\n  LargeScaleStudy = \"large_scale_study\",\n  Mixed = \"mixed\",\n  UniProt = \"uniprot\",\n}\n\nconst getSourceType = (xrefs: Xref[], sourceType: SourceType) => {\n  const xrefNames = xrefs ? xrefs.map((ref) => ref.name) : [];\n  if (sourceType === \"uniprot\" || sourceType === \"mixed\") {\n    xrefNames.push(\"uniprot\");\n  }\n  return xrefNames;\n};\n\nexport const transformData = (\n  data: ProteinsAPIVariation\n): {\n  sequence: string;\n  variants: VariationDatum[];\n} | null => {\n  const { sequence, features } = data;\n  const variants = features.map(\n    (variant) =>\n      ({\n        ...variant,\n        accession: (variant.genomicLocation || []).length !== 0 \n            ? (variant.genomicLocation || [])[0] \n            : '',\n        variant: variant.alternativeSequence\n          ? variant.alternativeSequence\n          : AminoAcid.Empty,\n        start: Number(variant.begin),\n        xrefNames: getSourceType(variant.xrefs, variant.sourceType),\n        hasPredictions: variant.predictions && variant.predictions.length > 0,\n        //   tooltipContent: formatTooltip(variant),\n        protvistaFeatureId: String(Math.random()),\n        consequenceType: variant.consequenceType,\n      }) as VariationDatum\n  );\n  if (!variants) return null;\n  return { sequence, variants };\n};\n","import { html } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport NightingaleElement, {\n  withSVGHighlight,\n  withManager,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nimport {\n  select,\n  scalePoint,\n  axisLeft,\n  axisRight,\n  ScalePoint,\n  Selection,\n} from \"d3\";\n// import _union from \"lodash-es/union\";\n// import _intersection from \"lodash-es/intersection\";\n// import _groupBy from \"lodash-es/groupBy\";\nimport processVariants from \"./processVariants\";\nimport VariationPlot from \"./variationPlot\";\nimport { transformData, ProteinsAPIVariation } from \"./proteinAPI\";\n\nexport type VariationDatum = {\n  accession: string;\n  variant: string;\n  start: number;\n  size?: number;\n  xrefNames: string[];\n  hasPredictions: boolean;\n  tooltipContent?: string;\n  protvistaFeatureId: string;\n  alternativeSequence?: string;\n  internalId?: string;\n  wildType?: string;\n  color?: string;\n  consequenceType: string;\n};\n\nexport type VariationData = {\n  sequence: string;\n  variants: VariationDatum[];\n};\n\nexport type ProcessedVariationData = {\n  type: string;\n  normal: string;\n  pos: number;\n  variants: VariationDatum[];\n};\n\nconst aaList = [\n  \"G\",\n  \"A\",\n  \"V\",\n  \"L\",\n  \"I\",\n  \"S\",\n  \"T\",\n  \"C\",\n  \"M\",\n  \"D\",\n  \"N\",\n  \"E\",\n  \"Q\",\n  \"R\",\n  \"K\",\n  \"H\",\n  \"F\",\n  \"Y\",\n  \"W\",\n  \"P\",\n  \"d\",\n  \"*\",\n];\n\n@customElement(\"nightingale-variation\")\nclass NightingaleVariation extends withManager(\n  withSVGHighlight(NightingaleElement)\n) {\n  /**\n   * Indicates the data is in the format of the protein API and needs to be transformed acordingly\n   */\n  @property({ type: Boolean, attribute: \"protein-api\" })\n  proteinAPI?: boolean = false;\n  /**\n   * Indicates if the view should only include rows with at least 1 variant\n   */\n  @property({ type: Boolean, attribute: \"condensed-view\" })\n  condensedView?: boolean = false;\n  /**\n   * Indicates if the view should only include rows with at least 1 variant\n   */\n  @property({ type: Number, attribute: \"row-height\" })\n  rowHeight?: number;\n\n  yScale?: ScalePoint<string>;\n\n  #data: VariationData | ProteinsAPIVariation | null | undefined;\n\n  processedData?: {\n    mutationArray: ProcessedVariationData[];\n    aaPresence: Record<string, boolean>;\n  } | null;\n\n  variationPlot?: VariationPlot;\n  series?: Selection<\n    SVGGElement,\n    ProcessedVariationData[],\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  axisLeft?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  axisRight?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  @state({})\n  colorConfig: (v: VariationDatum) => string;\n\n  constructor() {\n    super();\n    this.colorConfig = (_v: VariationDatum) => \"pink\";\n    this[\"margin-top\"] = 10;\n    this[\"margin-bottom\"] = 10;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    // scale for Amino Acids\n    this.yScale = scalePoint()\n      .domain(aaList)\n      .range([0, this.height - this[\"margin-top\"] - this[\"margin-bottom\"]]);\n  }\n\n  processData(data?: VariationData | ProteinsAPIVariation | null) {\n    this.#data = data;\n    const transformedData = this.proteinAPI\n      ? transformData(data as ProteinsAPIVariation)\n      : (data as VariationData);\n    if (transformedData) this.processedData = processVariants(transformedData);\n  }\n\n  set data(data: VariationData | ProteinsAPIVariation | null | undefined) {\n    if (this.#data === data) return;\n    this.processData(data);\n    this.createFeatures();\n  }\n\n  get data() {\n    return this.#data;\n  }\n  static get css() {\n    return `\n    <style>\n    nightingale-variation {\n      display: flex;\n      width: 100%;\n    }\n\n    nightingale-variation svg {\n      background-color: #fff;\n    }\n\n    nightingale-variation circle {\n      opacity: 0.6;\n    }\n    nightingale-variation circle:hover {\n      opacity: 1;\n    }\n    nightingale-variation .tick line,\n    nightingale-variation .axis path {\n      opacity: 0.1;\n      pointer-events: none;\n    }\n\n    nightingale-highlight {\n      fill: #ffe999;\n    }\n\n    nightingale-variation .variation-y-right line,\n    nightingale-variation .axis path {\n      fill: none;\n      stroke: none;\n    }\n\n    </style>\n    `;\n  }\n\n  createFeatures() {\n    this.svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"id\", \"\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height);\n\n    if (!this.processedData) return;\n\n    this.variationPlot = new VariationPlot();\n    // Group for the main chart\n    const mainChart = this.svg\n      .select(\"g.sequence-features\")\n      .attr(\"transform\", `translate(0, ${this[\"margin-top\"]})`);\n\n    // clip path prevents drawing outside of it\n    let chartArea = mainChart.select<SVGGElement>(\"g.points\");\n    if (chartArea.empty()) {\n      chartArea = mainChart.append(\"g\").attr(\"class\", \"points\");\n      this.axisLeft = mainChart.append(\"g\");\n      this.axisRight = mainChart.append(\"g\");\n    }\n    // This is calling the data series render code for each of the items in the data\n    this.series = chartArea.datum(this.processedData.mutationArray);\n\n    this.updateScale();\n  }\n\n  // TODO: Filters are not a v4 feature.\n  // Overwrite filters setters as we use updateData instead of refresh\n  // set filters(filters) {\n  //   super.filters = filters;\n  //   this.updateData(this._data);\n  //   this.refresh();\n  // }\n\n  /*\n   * We have to overwrite this function as variants are in arrays\n   * of arrays so the regular union/intersection won't work\n   */\n  // _applyFilters() {\n  //   if (!this._filters || this._filters.length <= 0) {\n  //     this._data = this._originalData;\n  //     return;\n  //   }\n  //   const groupedFilters = _groupBy(this._filters, \"category\");\n  //   const filteredGroups = Object.values(groupedFilters).map((filterGroup) => {\n  //     const filteredData = filterGroup.map((filterItem) =>\n  //       filterItem.filterFn(this._originalData)\n  //     );\n  //     return deepArrayOperation(filteredData, _union);\n  //   });\n\n  //   this._data = deepArrayOperation(filteredGroups, _intersection);\n  // }\n\n  // Calling render again\n  firstUpdated() {\n    this.createFeatures();\n    this.createHighlightGroup();\n  }\n\n  zoomRefreshed() {\n    if (this.series) {\n      this.updateScale();\n      if (this.variationPlot)\n        this.series.call(this.variationPlot.drawVariationPlot, this);\n      this.updateHighlight();\n    }\n  }\n\n  updateScale() {\n    if (this.yScale) {\n      const aaToDisplay = aaList.filter((aa) =>\n        this.condensedView ? this.processedData?.aaPresence[aa] : true\n      );\n      if (this.rowHeight) {\n        this.height =\n          aaToDisplay.length * this.rowHeight +\n          this[\"margin-top\"] +\n          this[\"margin-bottom\"];\n      }\n      this.yScale\n        .range([0, this.height - this[\"margin-top\"] - this[\"margin-bottom\"]])\n        .domain(aaToDisplay);\n      this.svg?.attr(\"width\", this.width).attr(\"height\", this.height);\n\n      const yAxisLScale = axisLeft(this.yScale).tickSize(\n        -this.getWidthWithMargins()\n      );\n      this.axisLeft\n        ?.attr(\"class\", \"variation-y-left axis\")\n        .attr(\"transform\", `translate(${this[\"margin-left\"]},0)`)\n        .call(yAxisLScale);\n      const yAxisRScale = axisRight(this.yScale);\n      this.axisRight\n        ?.attr(\n          \"transform\",\n          `translate(${\n            this.getWidthWithMargins() - this[\"margin-right\"] + 2\n          }, 0)`\n        )\n        .attr(\"class\", \"variation-y-right axis\")\n        .call(yAxisRScale);\n    }\n  }\n\n  updateData(data: VariationData) {\n    if (this.series) {\n      this.series.datum(data);\n    }\n  }\n\n  render() {\n    return html`<style>\n        ${NightingaleVariation.css}\n      </style>\n      <svg class=\"container\">\n        <g class=\"sequence-features\" />\n      </svg>`;\n  }\n}\n\nexport default NightingaleVariation;\n","import NightingaleVariation from \"./nightingale-variation\";\nexport default NightingaleVariation;\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.cssFontFaceSrc = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n/*\n * Generated by PEG.js 0.10.0.\n *\n * http://pegjs.org/\n */\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function ctor() { this.constructor = child; }\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message  = message;\n  this.expected = expected;\n  this.found    = found;\n  this.location = location;\n  this.name     = \"SyntaxError\";\n\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n        literal: function(expectation) {\n          return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n        },\n\n        \"class\": function(expectation) {\n          var escapedParts = \"\",\n              i;\n\n          for (i = 0; i < expectation.parts.length; i++) {\n            escapedParts += expectation.parts[i] instanceof Array\n              ? classEscape(expectation.parts[i][0]) + \"-\" + classEscape(expectation.parts[i][1])\n              : classEscape(expectation.parts[i]);\n          }\n\n          return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n        },\n\n        any: function(expectation) {\n          return \"any character\";\n        },\n\n        end: function(expectation) {\n          return \"end of input\";\n        },\n\n        other: function(expectation) {\n          return expectation.description;\n        }\n      };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\"/g,  '\\\\\"')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\]/g, '\\\\]')\n      .replace(/\\^/g, '\\\\^')\n      .replace(/-/g,  '\\\\-')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = new Array(expected.length),\n        i, j;\n\n    for (i = 0; i < expected.length; i++) {\n      descriptions[i] = describeExpectation(expected[i]);\n    }\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== void 0 ? options : {};\n\n  var peg$FAILED = {},\n\n      peg$startRuleFunctions = { start: peg$parsestart },\n      peg$startRuleFunction  = peg$parsestart,\n\n      peg$c0 = \"\",\n      peg$c1 = function() { return [] },\n      peg$c2 = \",\",\n      peg$c3 = peg$literalExpectation(\",\", false),\n      peg$c4 = function(x, xs) { return [x].concat(xs); },\n      peg$c5 = function(entry) { return [entry]; },\n      peg$c6 = function(url, format) { return {url: url, format: format}; },\n      peg$c7 = function(url) { return {url: url}; },\n      peg$c8 = \"url(\",\n      peg$c9 = peg$literalExpectation(\"url(\", false),\n      peg$c10 = \")\",\n      peg$c11 = peg$literalExpectation(\")\", false),\n      peg$c12 = function(value) { return value; },\n      peg$c13 = \"format(\",\n      peg$c14 = peg$literalExpectation(\"format(\", false),\n      peg$c15 = \"local(\",\n      peg$c16 = peg$literalExpectation(\"local(\", false),\n      peg$c17 = function(value) { return {local: value}; },\n      peg$c18 = /^[^)]/,\n      peg$c19 = peg$classExpectation([\")\"], true, false),\n      peg$c20 = function(chars) { return util.extractValue(chars.join(\"\")); },\n      peg$c21 = /^[ \\t\\r\\n\\f]/,\n      peg$c22 = peg$classExpectation([\" \", \"\\t\", \"\\r\", \"\\n\", \"\\f\"], false, false),\n\n      peg$currPos          = 0,\n      peg$savedPos         = 0,\n      peg$posDetailsCache  = [{ line: 1, column: 1 }],\n      peg$maxFailPos       = 0,\n      peg$maxFailExpected  = [],\n      peg$silentFails      = 0,\n\n      peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos], p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line:   details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n      return details;\n    }\n  }\n\n  function peg$computeLocation(startPos, endPos) {\n    var startPosDetails = peg$computePosDetails(startPos),\n        endPosDetails   = peg$computePosDetails(endPos);\n\n    return {\n      start: {\n        offset: startPos,\n        line:   startPosDetails.line,\n        column: startPosDetails.column\n      },\n      end: {\n        offset: endPos,\n        line:   endPosDetails.line,\n        column: endPosDetails.column\n      }\n    };\n  }\n\n  function peg$fail(expected) {\n    if (peg$currPos < peg$maxFailPos) { return; }\n\n    if (peg$currPos > peg$maxFailPos) {\n      peg$maxFailPos = peg$currPos;\n      peg$maxFailExpected = [];\n    }\n\n    peg$maxFailExpected.push(expected);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$parsestart() {\n    var s0, s1;\n\n    s0 = peg$parsesourceEntries();\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$c0;\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c1();\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsesourceEntries() {\n    var s0, s1, s2, s3, s4, s5;\n\n    s0 = peg$currPos;\n    s1 = peg$parsesourceEntry();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewhitespace();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewhitespace();\n      }\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 44) {\n          s3 = peg$c2;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c3); }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = [];\n          s5 = peg$parsewhitespace();\n          while (s5 !== peg$FAILED) {\n            s4.push(s5);\n            s5 = peg$parsewhitespace();\n          }\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parsesourceEntries();\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c4(s1, s5);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsesourceEntry();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c5(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsesourceEntry() {\n    var s0;\n\n    s0 = peg$parseurlEntry();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parselocalEntry();\n    }\n\n    return s0;\n  }\n\n  function peg$parseurlEntry() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    s1 = peg$parseurl();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewhitespace();\n      if (s3 !== peg$FAILED) {\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          s3 = peg$parsewhitespace();\n        }\n      } else {\n        s2 = peg$FAILED;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseformat();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c6(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseurl();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c7(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parseurl() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 4) === peg$c8) {\n      s1 = peg$c8;\n      peg$currPos += 4;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c9); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsevalue();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 41) {\n          s3 = peg$c10;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c11); }\n        }\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c12(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseformat() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 7) === peg$c13) {\n      s1 = peg$c13;\n      peg$currPos += 7;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c14); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsevalue();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 41) {\n          s3 = peg$c10;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c11); }\n        }\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c12(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parselocalEntry() {\n    var s0, s1, s2, s3;\n\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 6) === peg$c15) {\n      s1 = peg$c15;\n      peg$currPos += 6;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c16); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsevalue();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 41) {\n          s3 = peg$c10;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c11); }\n        }\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c17(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsevalue() {\n    var s0, s1, s2;\n\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c18.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c19); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c18.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c19); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c20(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parsewhitespace() {\n    var s0;\n\n    if (peg$c21.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c22); }\n    }\n\n    return s0;\n  }\n\n\n    var util = _dereq_('../util');\n\n\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$fail(peg$endExpectation());\n    }\n\n    throw peg$buildStructuredError(\n      peg$maxFailExpected,\n      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n      peg$maxFailPos < input.length\n        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n    );\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse:       peg$parse\n};\n\n},{\"../util\":3}],2:[function(_dereq_,module,exports){\nvar grammar = _dereq_('./grammar');\n\n\nexports.SyntaxError = function (message, offset) {\n    this.message  = message;\n    this.offset   = offset;\n};\n\nexports.parse = function (fontFaceSourceValue) {\n    try {\n        return grammar.parse(fontFaceSourceValue);\n    } catch (e) {\n        throw new exports.SyntaxError(e.message, e.offset);\n    }\n};\n\nexports.serialize = function (parsedFontFaceSources) {\n    return parsedFontFaceSources.map(function (sourceItem) {\n        var itemValue;\n\n        if (sourceItem.url) {\n            itemValue = 'url(\"' + sourceItem.url + '\")';\n            if (sourceItem.format) {\n                itemValue += ' format(\"' + sourceItem.format + '\")';\n            }\n        } else {\n            itemValue = 'local(\"' + sourceItem.local + '\")';\n        }\n        return itemValue;\n    }).join(', ');\n};\n\n},{\"./grammar\":1}],3:[function(_dereq_,module,exports){\nvar trimCSSWhitespace = function (value) {\n    var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n    return value.replace(whitespaceRegex, \"$1\");\n};\n\nvar unquoteString = function (quotedUrl) {\n    var doubleQuoteRegex = /^\"(.*)\"$/,\n        singleQuoteRegex = /^'(.*)'$/;\n\n    if (doubleQuoteRegex.test(quotedUrl)) {\n        return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n    } else {\n        if (singleQuoteRegex.test(quotedUrl)) {\n            return quotedUrl.replace(singleQuoteRegex, \"$1\");\n        } else {\n            return quotedUrl;\n        }\n    }\n};\n\nexports.extractValue = function (value) {\n    return unquoteString(trimCSSWhitespace(value));\n};\n\n},{}]},{},[2])(2)\n});","// Simple, stupid \"background\"/\"background-image\" value parser that just aims at exposing the image URLs\n\"use strict\";\n\nvar cssSupport = require(\"./cssSupport\");\n\nvar trimCSSWhitespace = function (url) {\n  var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n  return url.replace(whitespaceRegex, \"$1\");\n};\n\n// TODO exporting this for the sake of unit testing. Should rather test the background value parser explicitly.\nexports.extractCssUrl = function (cssUrl) {\n  var urlRegex = /^url\\((\"[^\"]+\"|'[^']+'|[^\\)]+)\\)/,\n    quotedUrl;\n\n  if (!urlRegex.test(cssUrl)) {\n    throw new Error(\"Invalid url\");\n  }\n\n  quotedUrl = urlRegex.exec(cssUrl)[1];\n  return cssSupport.unquoteString(trimCSSWhitespace(quotedUrl));\n};\n\nvar sliceBackgroundDeclaration = function (backgroundDeclarationText) {\n  var functionParamRegexS = \"\\\\s*(?:\\\"[^\\\"]*\\\"|'[^']*'|[^\\\\(]+)\\\\s*\",\n    valueRegexS =\n      \"(\" + \"url\\\\(\" + functionParamRegexS + \"\\\\)\" + \"|\" + \"[^,\\\\s]+\" + \")\",\n    simpleSingularBackgroundRegexS = \"(?:\\\\s*\" + valueRegexS + \")+\",\n    simpleBackgroundRegexS =\n      \"^\\\\s*(\" +\n      simpleSingularBackgroundRegexS +\n      \")\" +\n      \"(?:\\\\s*,\\\\s*(\" +\n      simpleSingularBackgroundRegexS +\n      \"))*\" +\n      \"\\\\s*$\",\n    simpleSingularBackgroundRegex = new RegExp(\n      simpleSingularBackgroundRegexS,\n      \"g\"\n    ),\n    outerRepeatedMatch,\n    backgroundLayers = [],\n    getValues = function (singularBackgroundDeclaration) {\n      var valueRegex = new RegExp(valueRegexS, \"g\"),\n        backgroundValues = [],\n        repeatedMatch;\n\n      repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n      while (repeatedMatch) {\n        backgroundValues.push(repeatedMatch[1]);\n        repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n      }\n      return backgroundValues;\n    };\n\n  if (backgroundDeclarationText.match(new RegExp(simpleBackgroundRegexS))) {\n    outerRepeatedMatch = simpleSingularBackgroundRegex.exec(\n      backgroundDeclarationText\n    );\n    while (outerRepeatedMatch) {\n      backgroundLayers.push(getValues(outerRepeatedMatch[0]));\n      outerRepeatedMatch = simpleSingularBackgroundRegex.exec(\n        backgroundDeclarationText\n      );\n    }\n\n    return backgroundLayers;\n  }\n  return [];\n};\n\nvar findBackgroundImageUrlInValues = function (values) {\n  var i, url;\n\n  for (i = 0; i < values.length; i++) {\n    try {\n      url = exports.extractCssUrl(values[i]);\n      return {\n        url: url,\n        idx: i,\n      };\n    } catch (e) {}\n  }\n};\n\nexports.parse = function (backgroundValue) {\n  var backgroundLayers = sliceBackgroundDeclaration(backgroundValue);\n\n  return backgroundLayers.map(function (backgroundLayerValues) {\n    var urlMatch = findBackgroundImageUrlInValues(backgroundLayerValues);\n\n    if (urlMatch) {\n      return {\n        preUrl: backgroundLayerValues.slice(0, urlMatch.idx),\n        url: urlMatch.url,\n        postUrl: backgroundLayerValues.slice(urlMatch.idx + 1),\n      };\n    } else {\n      return {\n        preUrl: backgroundLayerValues,\n      };\n    }\n  });\n};\n\nexports.serialize = function (parsedBackground) {\n  var backgroundLayers = parsedBackground.map(function (backgroundLayer) {\n    var values = [].concat(backgroundLayer.preUrl);\n\n    if (backgroundLayer.url) {\n      values.push('url(\"' + backgroundLayer.url + '\")');\n    }\n    if (backgroundLayer.postUrl) {\n      values = values.concat(backgroundLayer.postUrl);\n    }\n\n    return values.join(\" \");\n  });\n\n  return backgroundLayers.join(\", \");\n};\n","\"use strict\";\n\nexports.unquoteString = function (quotedUrl) {\n  var doubleQuoteRegex = /^\"(.*)\"$/,\n    singleQuoteRegex = /^'(.*)'$/;\n\n  if (doubleQuoteRegex.test(quotedUrl)) {\n    return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n  } else {\n    if (singleQuoteRegex.test(quotedUrl)) {\n      return quotedUrl.replace(singleQuoteRegex, \"$1\");\n    } else {\n      return quotedUrl;\n    }\n  }\n};\n\nexports.rulesForCssText = function (styleContent) {\n  var doc = document.implementation.createHTMLDocument(\"\"),\n    styleElement = document.createElement(\"style\"),\n    rules;\n\n  styleElement.textContent = styleContent;\n  // the style will only be parsed once it is added to a document\n  doc.body.appendChild(styleElement);\n  rules = styleElement.sheet.cssRules;\n\n  return Array.prototype.slice.call(rules);\n};\n\nexports.cssRulesToText = function (cssRules) {\n  return cssRules.reduce(function (cssText, rule) {\n    return cssText + rule.cssText;\n  }, \"\");\n};\n\nexports.exchangeRule = function (cssRules, rule, newRuleText) {\n  var ruleIdx = cssRules.indexOf(rule);\n\n  // We create a new document and stylesheet to parse the rule,\n  // instead of relying on rule.parentStyleSheet, because\n  // rule.parentStyleSheet may be null\n  // (https://github.com/cburgmer/inlineresources/issues/3)\n  cssRules[ruleIdx] = exports.rulesForCssText(newRuleText)[0];\n};\n\n// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=443978\nexports.changeFontFaceRuleSrc = function (cssRules, rule, newSrc) {\n  var newRuleText =\n    \"@font-face { font-family: \" +\n    rule.style.getPropertyValue(\"font-family\") +\n    \"; \";\n\n  if (rule.style.getPropertyValue(\"font-style\")) {\n    newRuleText +=\n      \"font-style: \" + rule.style.getPropertyValue(\"font-style\") + \"; \";\n  }\n\n  if (rule.style.getPropertyValue(\"font-weight\")) {\n    newRuleText +=\n      \"font-weight: \" + rule.style.getPropertyValue(\"font-weight\") + \"; \";\n  }\n\n  if (rule.style.getPropertyValue(\"unicode-range\")) {\n    newRuleText +=\n      \"unicode-range: \" + rule.style.getPropertyValue(\"unicode-range\") + \"; \";\n  }\n\n  newRuleText += \"src: \" + newSrc + \"}\";\n  exports.exchangeRule(cssRules, rule, newRuleText);\n};\n","\"use strict\";\n\nvar util = require(\"./util\"),\n  inlineImage = require(\"./inlineImage\"),\n  inlineScript = require(\"./inlineScript\"),\n  inlineCss = require(\"./inlineCss\"),\n  cssSupport = require(\"./cssSupport\");\n\nvar getUrlBasePath = function (url) {\n  return util.joinUrl(url, \".\");\n};\n\nvar parameterHashFunction = function (params) {\n  // HACK JSON.stringify is poor man's hashing;\n  // same objects might not receive same result as key order is not guaranteed\n  var a = params.map(function (param, idx) {\n    // Only include options relevant for method\n    if (idx === params.length - 1) {\n      param = {\n        // Two different HTML pages on the same path level have the same base path, but a different URL\n        baseUrl: getUrlBasePath(param.baseUrl),\n      };\n    }\n    return JSON.stringify(param);\n  });\n  return a;\n};\n\nvar memoizeFunctionOnCaching = function (func, options) {\n  if (\n    options.cache !== false &&\n    options.cache !== \"none\" &&\n    options.cacheBucket\n  ) {\n    return util.memoize(func, parameterHashFunction, options.cacheBucket);\n  } else {\n    return func;\n  }\n};\n\n/* Style inlining */\n\nvar requestExternalsForStylesheet = function (\n  styleContent,\n  alreadyLoadedCssUrls,\n  options\n) {\n  var cssRules = cssSupport.rulesForCssText(styleContent);\n\n  return inlineCss\n    .loadCSSImportsForRules(cssRules, alreadyLoadedCssUrls, options)\n    .then(function (cssImportResult) {\n      return inlineCss\n        .loadAndInlineCSSResourcesForRules(cssRules, options)\n        .then(function (cssResourcesResult) {\n          var errors = cssImportResult.errors.concat(cssResourcesResult.errors),\n            hasChanges =\n              cssImportResult.hasChanges || cssResourcesResult.hasChanges;\n\n          if (hasChanges) {\n            styleContent = cssSupport.cssRulesToText(cssRules);\n          }\n\n          return {\n            hasChanges: hasChanges,\n            content: styleContent,\n            errors: errors,\n          };\n        });\n    });\n};\n\nvar loadAndInlineCssForStyle = function (style, options, alreadyLoadedCssUrls) {\n  var styleContent = style.textContent,\n    processExternals = memoizeFunctionOnCaching(\n      requestExternalsForStylesheet,\n      options\n    );\n\n  return processExternals(styleContent, alreadyLoadedCssUrls, options).then(\n    function (result) {\n      if (result.hasChanges) {\n        style.childNodes[0].nodeValue = result.content;\n      }\n\n      return util.cloneArray(result.errors);\n    }\n  );\n};\n\nvar getCssStyleElements = function (doc) {\n  var styles = doc.getElementsByTagName(\"style\");\n\n  return Array.prototype.filter.call(styles, function (style) {\n    return !style.attributes.type || style.attributes.type.value === \"text/css\";\n  });\n};\n\nexports.loadAndInlineStyles = function (doc, options) {\n  var styles = getCssStyleElements(doc),\n    allErrors = [],\n    alreadyLoadedCssUrls = [],\n    inlineOptions;\n\n  inlineOptions = util.clone(options);\n  inlineOptions.baseUrl = inlineOptions.baseUrl || util.getDocumentBaseUrl(doc);\n\n  return Promise.all(\n    styles.map(function (style) {\n      return loadAndInlineCssForStyle(\n        style,\n        inlineOptions,\n        alreadyLoadedCssUrls\n      ).then(function (errors) {\n        allErrors = allErrors.concat(errors);\n      });\n    })\n  ).then(function () {\n    return allErrors;\n  });\n};\n\n/* CSS link inlining */\n\nvar substituteLinkWithInlineStyle = function (oldLinkNode, styleContent) {\n  var parent = oldLinkNode.parentNode,\n    styleNode;\n\n  styleContent = styleContent.trim();\n  if (styleContent) {\n    styleNode = oldLinkNode.ownerDocument.createElement(\"style\");\n    styleNode.type = \"text/css\";\n    styleNode.appendChild(\n      oldLinkNode.ownerDocument.createTextNode(styleContent)\n    );\n\n    parent.insertBefore(styleNode, oldLinkNode);\n  }\n\n  parent.removeChild(oldLinkNode);\n};\n\nvar requestStylesheetAndInlineResources = function (url, options) {\n  return util\n    .ajax(url, options)\n    .then(function (content) {\n      var cssRules = cssSupport.rulesForCssText(content);\n\n      return {\n        content: content,\n        cssRules: cssRules,\n      };\n    })\n    .then(function (result) {\n      var hasChangesFromPathAdjustment = inlineCss.adjustPathsOfCssResources(\n        url,\n        result.cssRules\n      );\n\n      return {\n        content: result.content,\n        cssRules: result.cssRules,\n        hasChanges: hasChangesFromPathAdjustment,\n      };\n    })\n    .then(function (result) {\n      return inlineCss\n        .loadCSSImportsForRules(result.cssRules, [], options)\n        .then(function (cssImportResult) {\n          return {\n            content: result.content,\n            cssRules: result.cssRules,\n            hasChanges: result.hasChanges || cssImportResult.hasChanges,\n            errors: cssImportResult.errors,\n          };\n        });\n    })\n    .then(function (result) {\n      return inlineCss\n        .loadAndInlineCSSResourcesForRules(result.cssRules, options)\n        .then(function (cssResourcesResult) {\n          return {\n            content: result.content,\n            cssRules: result.cssRules,\n            hasChanges: result.hasChanges || cssResourcesResult.hasChanges,\n            errors: result.errors.concat(cssResourcesResult.errors),\n          };\n        });\n    })\n    .then(function (result) {\n      var content = result.content;\n      if (result.hasChanges) {\n        content = cssSupport.cssRulesToText(result.cssRules);\n      }\n      return {\n        content: content,\n        errors: result.errors,\n      };\n    });\n};\n\nvar loadLinkedCSS = function (link, options) {\n  var cssHref = link.attributes.href.value,\n    documentBaseUrl = util.getDocumentBaseUrl(link.ownerDocument),\n    ajaxOptions = util.clone(options);\n\n  if (!ajaxOptions.baseUrl && documentBaseUrl) {\n    ajaxOptions.baseUrl = documentBaseUrl;\n  }\n\n  var processStylesheet = memoizeFunctionOnCaching(\n    requestStylesheetAndInlineResources,\n    options\n  );\n\n  return processStylesheet(cssHref, ajaxOptions).then(function (result) {\n    return {\n      content: result.content,\n      errors: util.cloneArray(result.errors),\n    };\n  });\n};\n\nvar getCssStylesheetLinks = function (doc) {\n  var links = doc.getElementsByTagName(\"link\");\n\n  return Array.prototype.filter.call(links, function (link) {\n    return (\n      link.attributes.rel &&\n      link.attributes.rel.value === \"stylesheet\" &&\n      (!link.attributes.type || link.attributes.type.value === \"text/css\")\n    );\n  });\n};\n\nexports.loadAndInlineCssLinks = function (doc, options) {\n  var links = getCssStylesheetLinks(doc),\n    errors = [];\n\n  return Promise.all(\n    links.map(function (link) {\n      return loadLinkedCSS(link, options).then(\n        function (result) {\n          substituteLinkWithInlineStyle(link, result.content + \"\\n\");\n\n          errors = errors.concat(result.errors);\n        },\n        function (e) {\n          errors.push({\n            resourceType: \"stylesheet\",\n            url: e.url,\n            msg: \"Unable to load stylesheet \" + e.url,\n          });\n        }\n      );\n    })\n  ).then(function () {\n    return errors;\n  });\n};\n\n/* Main */\n\nexports.loadAndInlineImages = inlineImage.inline;\nexports.loadAndInlineScript = inlineScript.inline;\n\nexports.inlineReferences = function (doc, options) {\n  var allErrors = [],\n    inlineFuncs = [\n      exports.loadAndInlineImages,\n      exports.loadAndInlineStyles,\n      exports.loadAndInlineCssLinks,\n    ];\n\n  if (options.inlineScripts !== false) {\n    inlineFuncs.push(exports.loadAndInlineScript);\n  }\n\n  return Promise.all(\n    inlineFuncs.map(function (func) {\n      return func(doc, options).then(function (errors) {\n        allErrors = allErrors.concat(errors);\n      });\n    })\n  ).then(function () {\n    return allErrors;\n  });\n};\n","\"use strict\";\n\nvar util = require(\"./util\"),\n  cssSupport = require(\"./cssSupport\"),\n  backgroundValueParser = require(\"./backgroundValueParser\"),\n  fontFaceSrcValueParser = require(\"css-font-face-src\");\n\nvar updateCssPropertyValue = function (rule, property, value) {\n  rule.style.setProperty(\n    property,\n    value,\n    rule.style.getPropertyPriority(property)\n  );\n};\n\nvar findBackgroundImageRules = function (cssRules) {\n  return cssRules.filter(function (rule) {\n    return (\n      rule.type === window.CSSRule.STYLE_RULE &&\n      (rule.style.getPropertyValue(\"background-image\") ||\n        rule.style.getPropertyValue(\"background\"))\n    );\n  });\n};\n\nvar findBackgroundDeclarations = function (rules) {\n  var backgroundDeclarations = [];\n\n  rules.forEach(function (rule) {\n    if (rule.style.getPropertyValue(\"background-image\")) {\n      backgroundDeclarations.push({\n        property: \"background-image\",\n        value: rule.style.getPropertyValue(\"background-image\"),\n        rule: rule,\n      });\n    } else if (rule.style.getPropertyValue(\"background\")) {\n      backgroundDeclarations.push({\n        property: \"background\",\n        value: rule.style.getPropertyValue(\"background\"),\n        rule: rule,\n      });\n    }\n  });\n\n  return backgroundDeclarations;\n};\n\nvar findFontFaceRules = function (cssRules) {\n  return cssRules.filter(function (rule) {\n    return (\n      rule.type === window.CSSRule.FONT_FACE_RULE &&\n      rule.style.getPropertyValue(\"src\")\n    );\n  });\n};\n\nvar findCSSImportRules = function (cssRules) {\n  return cssRules.filter(function (rule) {\n    return rule.type === window.CSSRule.IMPORT_RULE && rule.href;\n  });\n};\n\nvar findExternalBackgroundUrls = function (parsedBackground) {\n  var matchIndices = [];\n\n  parsedBackground.forEach(function (backgroundLayer, i) {\n    if (backgroundLayer.url && !util.isDataUri(backgroundLayer.url)) {\n      matchIndices.push(i);\n    }\n  });\n\n  return matchIndices;\n};\n\nvar findExternalFontFaceUrls = function (parsedFontFaceSources) {\n  var sourceIndices = [];\n  parsedFontFaceSources.forEach(function (sourceItem, i) {\n    if (sourceItem.url && !util.isDataUri(sourceItem.url)) {\n      sourceIndices.push(i);\n    }\n  });\n  return sourceIndices;\n};\n\nexports.adjustPathsOfCssResources = function (baseUrl, cssRules) {\n  var backgroundRules = findBackgroundImageRules(cssRules),\n    backgroundDeclarations = findBackgroundDeclarations(backgroundRules),\n    change = false;\n\n  backgroundDeclarations.forEach(function (declaration) {\n    var parsedBackground = backgroundValueParser.parse(declaration.value),\n      externalBackgroundIndices = findExternalBackgroundUrls(parsedBackground),\n      backgroundValue;\n\n    if (externalBackgroundIndices.length > 0) {\n      externalBackgroundIndices.forEach(function (backgroundLayerIndex) {\n        var relativeUrl = parsedBackground[backgroundLayerIndex].url,\n          url = util.joinUrl(baseUrl, relativeUrl);\n        parsedBackground[backgroundLayerIndex].url = url;\n      });\n\n      backgroundValue = backgroundValueParser.serialize(parsedBackground);\n\n      updateCssPropertyValue(\n        declaration.rule,\n        declaration.property,\n        backgroundValue\n      );\n\n      change = true;\n    }\n  });\n  findFontFaceRules(cssRules).forEach(function (rule) {\n    var fontFaceSrcDeclaration = rule.style.getPropertyValue(\"src\"),\n      parsedFontFaceSources,\n      externalFontFaceUrlIndices;\n\n    try {\n      parsedFontFaceSources = fontFaceSrcValueParser.parse(\n        fontFaceSrcDeclaration\n      );\n    } catch (e) {\n      return;\n    }\n    externalFontFaceUrlIndices = findExternalFontFaceUrls(\n      parsedFontFaceSources\n    );\n\n    if (externalFontFaceUrlIndices.length > 0) {\n      externalFontFaceUrlIndices.forEach(function (fontFaceUrlIndex) {\n        var relativeUrl = parsedFontFaceSources[fontFaceUrlIndex].url,\n          url = util.joinUrl(baseUrl, relativeUrl);\n\n        parsedFontFaceSources[fontFaceUrlIndex].url = url;\n      });\n\n      cssSupport.changeFontFaceRuleSrc(\n        cssRules,\n        rule,\n        fontFaceSrcValueParser.serialize(parsedFontFaceSources)\n      );\n\n      change = true;\n    }\n  });\n  findCSSImportRules(cssRules).forEach(function (rule) {\n    var cssUrl = rule.href,\n      url = util.joinUrl(baseUrl, cssUrl);\n\n    cssSupport.exchangeRule(cssRules, rule, \"@import url(\" + url + \");\");\n\n    change = true;\n  });\n\n  return change;\n};\n\n/* CSS import inlining */\n\nvar substituteRule = function (cssRules, rule, newCssRules) {\n  var position = cssRules.indexOf(rule);\n\n  cssRules.splice(position, 1);\n\n  newCssRules.forEach(function (newRule, i) {\n    cssRules.splice(position + i, 0, newRule);\n  });\n};\n\nvar loadAndInlineCSSImport = function (\n  cssRules,\n  rule,\n  alreadyLoadedCssUrls,\n  options\n) {\n  var url = rule.href,\n    cssHrefRelativeToDoc;\n\n  url = cssSupport.unquoteString(url);\n\n  cssHrefRelativeToDoc = util.joinUrl(options.baseUrl, url);\n\n  if (alreadyLoadedCssUrls.indexOf(cssHrefRelativeToDoc) >= 0) {\n    // Remove URL by adding empty string\n    substituteRule(cssRules, rule, []);\n    return Promise.resolve([]);\n  } else {\n    alreadyLoadedCssUrls.push(cssHrefRelativeToDoc);\n  }\n\n  return util.ajax(url, options).then(\n    function (cssText) {\n      var externalCssRules = cssSupport.rulesForCssText(cssText);\n\n      // Recursively follow @import statements\n      return exports\n        .loadCSSImportsForRules(externalCssRules, alreadyLoadedCssUrls, options)\n        .then(function (result) {\n          exports.adjustPathsOfCssResources(url, externalCssRules);\n\n          substituteRule(cssRules, rule, externalCssRules);\n\n          return result.errors;\n        });\n    },\n    function (e) {\n      throw {\n        resourceType: \"stylesheet\",\n        url: e.url,\n        msg: \"Unable to load stylesheet \" + e.url,\n      };\n    }\n  );\n};\n\nexports.loadCSSImportsForRules = function (\n  cssRules,\n  alreadyLoadedCssUrls,\n  options\n) {\n  var rulesToInline = findCSSImportRules(cssRules),\n    errors = [],\n    hasChanges = false;\n\n  return Promise.all(\n    rulesToInline.map(function (rule) {\n      return loadAndInlineCSSImport(\n        cssRules,\n        rule,\n        alreadyLoadedCssUrls,\n        options\n      ).then(\n        function (moreErrors) {\n          errors = errors.concat(moreErrors);\n\n          hasChanges = true;\n        },\n        function (e) {\n          errors.push(e);\n        }\n      );\n    })\n  ).then(function () {\n    return {\n      hasChanges: hasChanges,\n      errors: errors,\n    };\n  });\n};\n\n/* CSS linked resource inlining */\n\nvar loadAndInlineBackgroundImages = function (backgroundValue, options) {\n  var parsedBackground = backgroundValueParser.parse(backgroundValue),\n    externalBackgroundLayerIndices = findExternalBackgroundUrls(\n      parsedBackground\n    ),\n    hasChanges = false;\n\n  return util\n    .collectAndReportErrors(\n      externalBackgroundLayerIndices.map(function (backgroundLayerIndex) {\n        var url = parsedBackground[backgroundLayerIndex].url;\n\n        return util.getDataURIForImageURL(url, options).then(\n          function (dataURI) {\n            parsedBackground[backgroundLayerIndex].url = dataURI;\n\n            hasChanges = true;\n          },\n          function (e) {\n            throw {\n              resourceType: \"backgroundImage\",\n              url: e.url,\n              msg: \"Unable to load background-image \" + e.url,\n            };\n          }\n        );\n      })\n    )\n    .then(function (errors) {\n      return {\n        backgroundValue: backgroundValueParser.serialize(parsedBackground),\n        hasChanges: hasChanges,\n        errors: errors,\n      };\n    });\n};\n\nvar iterateOverRulesAndInlineBackgroundImages = function (cssRules, options) {\n  var rulesToInline = findBackgroundImageRules(cssRules),\n    backgroundDeclarations = findBackgroundDeclarations(rulesToInline),\n    errors = [],\n    cssHasChanges = false;\n\n  return Promise.all(\n    backgroundDeclarations.map(function (declaration) {\n      return loadAndInlineBackgroundImages(declaration.value, options).then(\n        function (result) {\n          if (result.hasChanges) {\n            updateCssPropertyValue(\n              declaration.rule,\n              declaration.property,\n              result.backgroundValue\n            );\n\n            cssHasChanges = true;\n          }\n\n          errors = errors.concat(result.errors);\n        }\n      );\n    })\n  ).then(function () {\n    return {\n      hasChanges: cssHasChanges,\n      errors: errors,\n    };\n  });\n};\n\nvar loadAndInlineFontFace = function (srcDeclarationValue, options) {\n  var hasChanges = false,\n    parsedFontFaceSources,\n    externalFontFaceUrlIndices;\n\n  try {\n    parsedFontFaceSources = fontFaceSrcValueParser.parse(srcDeclarationValue);\n  } catch (e) {\n    parsedFontFaceSources = [];\n  }\n  externalFontFaceUrlIndices = findExternalFontFaceUrls(parsedFontFaceSources);\n\n  return util\n    .collectAndReportErrors(\n      externalFontFaceUrlIndices.map(function (urlIndex) {\n        var fontSrc = parsedFontFaceSources[urlIndex],\n          format = fontSrc.format || \"woff\";\n\n        return util.binaryAjax(fontSrc.url, options).then(\n          function (content) {\n            var base64Content = btoa(content);\n            fontSrc.url = \"data:font/\" + format + \";base64,\" + base64Content;\n\n            hasChanges = true;\n          },\n          function (e) {\n            throw {\n              resourceType: \"fontFace\",\n              url: e.url,\n              msg: \"Unable to load font-face \" + e.url,\n            };\n          }\n        );\n      })\n    )\n    .then(function (errors) {\n      return {\n        srcDeclarationValue: fontFaceSrcValueParser.serialize(\n          parsedFontFaceSources\n        ),\n        hasChanges: hasChanges,\n        errors: errors,\n      };\n    });\n};\n\nvar iterateOverRulesAndInlineFontFace = function (cssRules, options) {\n  var rulesToInline = findFontFaceRules(cssRules),\n    errors = [],\n    hasChanges = false;\n\n  return Promise.all(\n    rulesToInline.map(function (rule) {\n      var srcDeclarationValue = rule.style.getPropertyValue(\"src\");\n\n      return loadAndInlineFontFace(srcDeclarationValue, options).then(function (\n        result\n      ) {\n        if (result.hasChanges) {\n          cssSupport.changeFontFaceRuleSrc(\n            cssRules,\n            rule,\n            result.srcDeclarationValue\n          );\n\n          hasChanges = true;\n        }\n\n        errors = errors.concat(result.errors);\n      });\n    })\n  ).then(function () {\n    return {\n      hasChanges: hasChanges,\n      errors: errors,\n    };\n  });\n};\n\nexports.loadAndInlineCSSResourcesForRules = function (cssRules, options) {\n  var hasChanges = false,\n    errors = [];\n\n  return Promise.all(\n    [\n      iterateOverRulesAndInlineBackgroundImages,\n      iterateOverRulesAndInlineFontFace,\n    ].map(function (func) {\n      return func(cssRules, options).then(function (result) {\n        hasChanges = hasChanges || result.hasChanges;\n        errors = errors.concat(result.errors);\n      });\n    })\n  ).then(function () {\n    return {\n      hasChanges: hasChanges,\n      errors: errors,\n    };\n  });\n};\n","\"use strict\";\n\nvar util = require(\"./util\");\n\nvar encodeImageAsDataURI = function (image, options) {\n  var url = null;\n  if (image.hasAttribute(\"src\")) {\n    url = image.getAttribute(\"src\");\n  } else if (image.hasAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\")) {\n    url = image.getAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\");\n  } else if (image.hasAttribute(\"href\")) {\n    url = image.getAttribute(\"href\");\n  }\n  var documentBase = util.getDocumentBaseUrl(image.ownerDocument),\n    ajaxOptions = util.clone(options);\n\n  if (!ajaxOptions.baseUrl && documentBase) {\n    ajaxOptions.baseUrl = documentBase;\n  }\n\n  return util.getDataURIForImageURL(url, ajaxOptions).then(\n    function (dataURI) {\n      return dataURI;\n    },\n    function (e) {\n      throw {\n        resourceType: \"image\",\n        url: e.url,\n        msg: \"Unable to load image \" + e.url,\n      };\n    }\n  );\n};\n\nvar filterExternalImages = function (images) {\n  return images.filter(function (image) {\n    var url = null;\n    if (image.hasAttribute(\"src\")) {\n      url = image.getAttribute(\"src\");\n    } else if (image.hasAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\")) {\n      url = image.getAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\");\n    } else if (image.hasAttribute(\"href\")) {\n      url = image.getAttribute(\"href\");\n    }\n\n    return url !== null && !util.isDataUri(url);\n  });\n};\n\nvar filterInputsForImageType = function (inputs) {\n  return Array.prototype.filter.call(inputs, function (input) {\n    return input.type === \"image\";\n  });\n};\n\nvar toArray = function (arrayLike) {\n  return Array.prototype.slice.call(arrayLike);\n};\n\nexports.inline = function (doc, options) {\n  var images = toArray(doc.getElementsByTagName(\"img\")),\n    svgImages = toArray(doc.getElementsByTagName(\"image\")),\n    imageInputs = filterInputsForImageType(doc.getElementsByTagName(\"input\"));\n\n  images = images.concat(svgImages);\n  images = images.concat(imageInputs);\n  var externalImages = filterExternalImages(images);\n\n  return util.collectAndReportErrors(\n    externalImages.map(function (image) {\n      return encodeImageAsDataURI(image, options).then(function (dataURI) {\n        if (!!image.attributes.src) {\n          image.attributes.src.value = dataURI;\n        } else if (!!image.attributes[\"xlink:href\"]) {\n          image.attributes[\"xlink:href\"].value = dataURI;\n        } else if (!!image.attributes.href) {\n          image.attributes.href.value = dataURI;\n        }\n      });\n    })\n  );\n};\n","\"use strict\";\n\nvar util = require(\"./util\");\n\nvar loadLinkedScript = function (script, options) {\n  var src = script.attributes.src.value,\n    documentBase = util.getDocumentBaseUrl(script.ownerDocument),\n    ajaxOptions = util.clone(options);\n\n  if (!ajaxOptions.baseUrl && documentBase) {\n    ajaxOptions.baseUrl = documentBase;\n  }\n\n  return util.ajax(src, ajaxOptions).catch(function (e) {\n    throw {\n      resourceType: \"script\",\n      url: e.url,\n      msg: \"Unable to load script \" + e.url,\n    };\n  });\n};\n\nvar escapeClosingTags = function (text) {\n  // http://stackoverflow.com/questions/9246382/escaping-script-tag-inside-javascript\n  return text.replace(/<\\//g, \"<\\\\/\");\n};\n\nvar substituteExternalScriptWithInline = function (scriptNode, jsCode) {\n  scriptNode.attributes.removeNamedItem(\"src\");\n  scriptNode.textContent = escapeClosingTags(jsCode);\n};\n\nvar getScripts = function (doc) {\n  var scripts = doc.getElementsByTagName(\"script\");\n\n  return Array.prototype.filter.call(scripts, function (script) {\n    return !!script.attributes.src;\n  });\n};\n\nexports.inline = function (doc, options) {\n  var scripts = getScripts(doc);\n\n  return util.collectAndReportErrors(\n    scripts.map(function (script) {\n      return loadLinkedScript(script, options).then(function (jsCode) {\n        substituteExternalScriptWithInline(script, jsCode);\n      });\n    })\n  );\n};\n","\"use strict\";\n\nvar url = require(\"url\");\n\nexports.getDocumentBaseUrl = function (doc) {\n  if (doc.baseURI !== \"about:blank\") {\n    return doc.baseURI;\n  }\n\n  return null;\n};\n\nexports.clone = function (object) {\n  var theClone = {},\n    i;\n  for (i in object) {\n    if (object.hasOwnProperty(i)) {\n      theClone[i] = object[i];\n    }\n  }\n  return theClone;\n};\n\nexports.cloneArray = function (nodeList) {\n  return Array.prototype.slice.apply(nodeList, [0]);\n};\n\nexports.joinUrl = function (baseUrl, relUrl) {\n  if (!baseUrl) {\n    return relUrl;\n  }\n  return url.resolve(baseUrl, relUrl);\n};\n\nexports.isDataUri = function (url) {\n  return /^data:/.test(url);\n};\n\nexports.collectAndReportErrors = function (promises) {\n  var errors = [];\n\n  return Promise.all(\n    promises.map(function (promise) {\n      return promise.catch(function (e) {\n        errors.push(e);\n      });\n    })\n  ).then(function () {\n    return errors;\n  });\n};\n\nvar lastCacheDate = null;\n\nvar getUncachableURL = function (url, cache) {\n  if (cache === false || cache === \"none\" || cache === \"repeated\") {\n    if (lastCacheDate === null || cache !== \"repeated\") {\n      lastCacheDate = Date.now();\n    }\n    return url + \"?_=\" + lastCacheDate;\n  } else {\n    return url;\n  }\n};\n\nexports.ajax = function (url, options) {\n  return new Promise(function (resolve, reject) {\n    var ajaxRequest = new window.XMLHttpRequest(),\n      joinedUrl = exports.joinUrl(options.baseUrl, url),\n      augmentedUrl;\n\n    var doReject = function () {\n      reject({\n        msg: \"Unable to load url\",\n        url: joinedUrl,\n      });\n    };\n\n    augmentedUrl = getUncachableURL(joinedUrl, options.cache);\n\n    ajaxRequest.addEventListener(\n      \"load\",\n      function () {\n        if (ajaxRequest.status === 200 || ajaxRequest.status === 0) {\n          resolve(ajaxRequest.response);\n        } else {\n          doReject();\n        }\n      },\n      false\n    );\n\n    ajaxRequest.addEventListener(\"error\", doReject, false);\n\n    try {\n      ajaxRequest.open(\"GET\", augmentedUrl, true);\n      ajaxRequest.overrideMimeType(options.mimeType);\n      ajaxRequest.send(null);\n    } catch (e) {\n      doReject();\n    }\n  });\n};\n\nexports.binaryAjax = function (url, options) {\n  var ajaxOptions = exports.clone(options);\n\n  ajaxOptions.mimeType = \"text/plain; charset=x-user-defined\";\n\n  return exports.ajax(url, ajaxOptions).then(function (content) {\n    var binaryContent = \"\";\n\n    for (var i = 0; i < content.length; i++) {\n      binaryContent += String.fromCharCode(content.charCodeAt(i) & 0xff);\n    }\n\n    return binaryContent;\n  });\n};\n\nvar detectMimeType = function (content) {\n  var startsWith = function (string, substring) {\n    return string.substring(0, substring.length) === substring;\n  };\n\n  if (startsWith(content, \"<?xml\") || startsWith(content, \"<svg\")) {\n    return \"image/svg+xml\";\n  }\n  return \"image/png\";\n};\n\nexports.getDataURIForImageURL = function (url, options) {\n  return exports.binaryAjax(url, options).then(function (content) {\n    var base64Content = btoa(content),\n      mimeType = detectMimeType(content);\n\n    return \"data:\" + mimeType + \";base64,\" + base64Content;\n  });\n};\n\nvar uniqueIdList = [];\n\nvar constantUniqueIdFor = function (element) {\n  // HACK, using a list results in O(n), but how do we hash a function?\n  if (uniqueIdList.indexOf(element) < 0) {\n    uniqueIdList.push(element);\n  }\n  return uniqueIdList.indexOf(element);\n};\n\nexports.memoize = function (func, hasher, memo) {\n  if (typeof memo !== \"object\") {\n    throw new Error(\"cacheBucket is not an object\");\n  }\n\n  return function () {\n    var args = Array.prototype.slice.call(arguments);\n\n    var argumentHash = hasher(args),\n      funcHash = constantUniqueIdFor(func),\n      retValue;\n\n    if (memo[funcHash] && memo[funcHash][argumentHash]) {\n      return memo[funcHash][argumentHash];\n    } else {\n      retValue = func.apply(null, args);\n\n      memo[funcHash] = memo[funcHash] || {};\n      memo[funcHash][argumentHash] = retValue;\n\n      return retValue;\n    }\n  };\n};\n","/*! rasterizeHTML.js - v1.3.1 - 2022-01-16\n* http://www.github.com/cburgmer/rasterizeHTML.js\n* Copyright (c) 2022 Christoph Burgmer; Licensed MIT */\n(function (root, factory) {\n  if (root === undefined && window !== undefined) root = window;\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"url\",\"xmlserializer\",\"sane-domparser-error\",\"inlineresources\"], function (a0,b1,c2,d3) {\n      return (root['rasterizeHTML'] = factory(a0,b1,c2,d3));\n    });\n  } else if (typeof module === 'object' && module.exports) {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"url\"),require(\"xmlserializer\"),require(\"sane-domparser-error\"),require(\"inlineresources\"));\n  } else {\n    root['rasterizeHTML'] = factory(root[\"url\"],root[\"xmlserializer\"],root[\"sanedomparsererror\"],root[\"inlineresources\"]);\n  }\n}(this, function (url, xmlserializer, sanedomparsererror, inlineresources) {\n\nvar util = (function (url) {\n    \"use strict\";\n\n    var module = {};\n\n    var uniqueIdList = [];\n\n    module.joinUrl = function (baseUrl, relUrl) {\n        if (!baseUrl) {\n            return relUrl;\n        }\n        return url.resolve(baseUrl, relUrl);\n    };\n\n    module.getConstantUniqueIdFor = function (element) {\n        // HACK, using a list results in O(n), but how do we hash e.g. a DOM node?\n        if (uniqueIdList.indexOf(element) < 0) {\n            uniqueIdList.push(element);\n        }\n        return uniqueIdList.indexOf(element);\n    };\n\n    module.clone = function (object) {\n        var theClone = {},\n            i;\n        for (i in object) {\n            if (object.hasOwnProperty(i)) {\n                theClone[i] = object[i];\n            }\n        }\n        return theClone;\n    };\n\n    var isObject = function (obj) {\n        return typeof obj === \"object\" && obj !== null;\n    };\n\n    var isCanvas = function (obj) {\n        return (\n            isObject(obj) &&\n            Object.prototype.toString\n                .apply(obj)\n                .match(/\\[object (Canvas|HTMLCanvasElement)\\]/i)\n        );\n    };\n\n    // args: canvas, options\n    module.parseOptionalParameters = function (args) {\n        var parameters = {\n            canvas: null,\n            options: {},\n        };\n\n        if (args[0] == null || isCanvas(args[0])) {\n            parameters.canvas = args[0] || null;\n\n            parameters.options = module.clone(args[1]);\n        } else {\n            parameters.options = module.clone(args[0]);\n        }\n\n        return parameters;\n    };\n\n    return module;\n})(url);\n\n// Proxy objects by monkey patching\nvar proxies = (function (util) {\n    \"use strict\";\n\n    var module = {};\n\n    var monkeyPatchInstanceMethod = function (object, methodName, proxyFunc) {\n        var originalFunc = object[methodName];\n\n        object[methodName] = function () {\n            var args = Array.prototype.slice.call(arguments);\n\n            return proxyFunc.apply(this, [args, originalFunc]);\n        };\n\n        return originalFunc;\n    };\n\n    // Bases all XHR calls on the given base URL\n    module.baseUrlRespectingXhr = function (XHRObject, baseUrl) {\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(\n                xhr,\n                \"open\",\n                function (args, originalOpen) {\n                    var method = args.shift(),\n                        url = args.shift(),\n                        joinedUrl = util.joinUrl(baseUrl, url);\n\n                    return originalOpen.apply(\n                        this,\n                        [method, joinedUrl].concat(args)\n                    );\n                }\n            );\n\n            return xhr;\n        };\n\n        return xhrConstructor;\n    };\n\n    // Provides a convenient way of being notified when all pending XHR calls are finished\n    module.finishNotifyingXhr = function (XHRObject) {\n        var totalXhrCount = 0,\n            doneXhrCount = 0,\n            waitingForPendingToClose = false;\n        var checkAllRequestsFinished;\n\n        var promise = new Promise(function (resolve) {\n            checkAllRequestsFinished = function () {\n                var pendingXhrCount = totalXhrCount - doneXhrCount;\n\n                if (pendingXhrCount <= 0 && waitingForPendingToClose) {\n                    resolve({ totalCount: totalXhrCount });\n                }\n            };\n        });\n\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(xhr, \"send\", function (_, originalSend) {\n                totalXhrCount += 1;\n                return originalSend.apply(this, arguments);\n            });\n\n            xhr.addEventListener(\"load\", function () {\n                doneXhrCount += 1;\n\n                checkAllRequestsFinished();\n            });\n\n            return xhr;\n        };\n\n        xhrConstructor.waitForRequestsToFinish = function () {\n            waitingForPendingToClose = true;\n            checkAllRequestsFinished();\n            return promise;\n        };\n\n        return xhrConstructor;\n    };\n\n    return module;\n})(util);\n\nvar documentUtil = (function () {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    module.addClassName = function (element, className) {\n        element.className += \" \" + className;\n    };\n\n    module.addClassNameRecursively = function (element, className) {\n        module.addClassName(element, className);\n\n        if (element.parentNode !== element.ownerDocument) {\n            module.addClassNameRecursively(element.parentNode, className);\n        }\n    };\n\n    var changeCssRule = function (rule, newRuleText) {\n        var styleSheet = rule.parentStyleSheet,\n            ruleIdx = asArray(styleSheet.cssRules).indexOf(rule);\n\n        // Exchange rule with the new text\n        styleSheet.insertRule(newRuleText, ruleIdx + 1);\n        styleSheet.deleteRule(ruleIdx);\n    };\n\n    var updateRuleSelector = function (rule, updatedSelector) {\n        var styleDefinitions = rule.cssText.replace(/^[^\\{]+/, \"\"),\n            newRule = updatedSelector + \" \" + styleDefinitions;\n\n        changeCssRule(rule, newRule);\n    };\n\n    var cssRulesToText = function (cssRules) {\n        return asArray(cssRules).reduce(function (cssText, rule) {\n            return cssText + rule.cssText;\n        }, \"\");\n    };\n\n    var rewriteStyleContent = function (styleElement) {\n        styleElement.textContent = cssRulesToText(styleElement.sheet.cssRules);\n    };\n\n    var addSheetPropertyToSvgStyleElement = function (svgStyleElement) {\n        var doc = document.implementation.createHTMLDocument(\"\"),\n            cssStyleElement = document.createElement(\"style\");\n\n        cssStyleElement.textContent = svgStyleElement.textContent;\n        // the style will only be parsed once it is added to a document\n        doc.body.appendChild(cssStyleElement);\n\n        svgStyleElement.sheet = cssStyleElement.sheet;\n    };\n\n    var matchingSimpleSelectorsRegex = function (simpleSelectorList) {\n        return (\n            \"(\" +\n            \"(?:^|[^.#:\\\\w])\" + // start of string or not a simple selector character,\n            \"|\" + // ... or ...\n            \"(?=\\\\W)\" + // the next character parsed is not an alphabetic character (and thus a natural boundary)\n            \")\" +\n            \"(\" +\n            simpleSelectorList.join(\"|\") + // one out of the given simple selectors\n            \")\" +\n            \"(?=\\\\W|$)\"\n        ); // followed either by a non-alphabetic character or the end of the string\n    };\n\n    var replaceSimpleSelectorsBy = function (\n        element,\n        simpleSelectorList,\n        caseInsensitiveReplaceFunc\n    ) {\n        var selectorRegex = matchingSimpleSelectorsRegex(simpleSelectorList);\n\n        asArray(element.querySelectorAll(\"style\")).forEach(function (\n            styleElement\n        ) {\n            // SVGStyleElement doesn't have a property sheet in Safari, we need some workaround here\n            // more details can be found here: https://github.com/cburgmer/rasterizeHTML.js/issues/158\n            if (typeof styleElement.sheet === \"undefined\") {\n                addSheetPropertyToSvgStyleElement(styleElement);\n            }\n\n            var matchingRules = asArray(styleElement.sheet.cssRules).filter(\n                function (rule) {\n                    return (\n                        rule.selectorText &&\n                        new RegExp(selectorRegex, \"i\").test(rule.selectorText)\n                    );\n                }\n            );\n\n            if (matchingRules.length) {\n                matchingRules.forEach(function (rule) {\n                    var newSelector = rule.selectorText.replace(\n                        new RegExp(selectorRegex, \"gi\"),\n                        function (_, prefixMatch, selectorMatch) {\n                            return (\n                                prefixMatch +\n                                caseInsensitiveReplaceFunc(selectorMatch)\n                            );\n                        }\n                    );\n\n                    if (newSelector !== rule.selectorText) {\n                        updateRuleSelector(rule, newSelector);\n                    }\n                });\n\n                rewriteStyleContent(styleElement);\n            }\n        });\n    };\n\n    module.rewriteCssSelectorWith = function (\n        element,\n        oldSelector,\n        newSelector\n    ) {\n        replaceSimpleSelectorsBy(element, [oldSelector], function () {\n            return newSelector;\n        });\n    };\n\n    module.lowercaseCssTypeSelectors = function (element, matchingTagNames) {\n        replaceSimpleSelectorsBy(element, matchingTagNames, function (match) {\n            return match.toLowerCase();\n        });\n    };\n\n    module.findHtmlOnlyNodeNames = function (element) {\n        var treeWalker = element.ownerDocument.createTreeWalker(\n                element,\n                NodeFilter.SHOW_ELEMENT\n            ),\n            htmlNodeNames = {},\n            nonHtmlNodeNames = {},\n            currentTagName;\n\n        do {\n            currentTagName = treeWalker.currentNode.tagName.toLowerCase();\n            if (\n                treeWalker.currentNode.namespaceURI ===\n                \"http://www.w3.org/1999/xhtml\"\n            ) {\n                htmlNodeNames[currentTagName] = true;\n            } else {\n                nonHtmlNodeNames[currentTagName] = true;\n            }\n        } while (treeWalker.nextNode());\n\n        return Object.keys(htmlNodeNames).filter(function (tagName) {\n            return !nonHtmlNodeNames[tagName];\n        });\n    };\n\n    return module;\n})();\n\nvar documentHelper = (function (documentUtil) {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    var cascadingAction = {\n        active: true,\n        hover: true,\n        focus: false,\n        target: false,\n    };\n\n    module.fakeUserAction = function (element, selector, action) {\n        var elem = element.querySelector(selector),\n            pseudoClass = \":\" + action,\n            fakeActionClass = \"rasterizehtml\" + action;\n        if (!elem) {\n            return;\n        }\n\n        if (cascadingAction[action]) {\n            documentUtil.addClassNameRecursively(elem, fakeActionClass);\n        } else {\n            documentUtil.addClassName(elem, fakeActionClass);\n        }\n        documentUtil.rewriteCssSelectorWith(\n            element,\n            pseudoClass,\n            \".\" + fakeActionClass\n        );\n    };\n\n    module.persistInputValues = function (doc) {\n        var inputs = doc.querySelectorAll(\"input\"),\n            textareas = doc.querySelectorAll(\"textarea\"),\n            isCheckable = function (input) {\n                return input.type === \"checkbox\" || input.type === \"radio\";\n            };\n\n        asArray(inputs)\n            .filter(isCheckable)\n            .forEach(function (input) {\n                if (input.checked) {\n                    input.setAttribute(\"checked\", \"\");\n                } else {\n                    input.removeAttribute(\"checked\");\n                }\n            });\n\n        asArray(inputs)\n            .filter(function (input) {\n                return !isCheckable(input);\n            })\n            .forEach(function (input) {\n                input.setAttribute(\"value\", input.value);\n            });\n\n        asArray(textareas).forEach(function (textarea) {\n            textarea.textContent = textarea.value;\n        });\n    };\n\n    module.rewriteTagNameSelectorsToLowerCase = function (element) {\n        documentUtil.lowercaseCssTypeSelectors(\n            element,\n            documentUtil.findHtmlOnlyNodeNames(element)\n        );\n    };\n\n    return module;\n})(documentUtil);\n\nvar browser = (function (util, proxies, sanedomparsererror, theWindow) {\n    \"use strict\";\n\n    var module = {};\n\n    var createHiddenElement = function (doc, tagName, width, height) {\n        var element = doc.createElement(tagName);\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading CSS\n        element.style.visibility = \"hidden\";\n        element.style.width = width + \"px\";\n        element.style.height = height + \"px\";\n        element.style.position = \"absolute\";\n        element.style.top = -10000 - height + \"px\";\n        element.style.left = -10000 - width + \"px\";\n        // We need to add the element to the document so that its content gets loaded\n        doc.getElementsByTagName(\"body\")[0].appendChild(element);\n        return element;\n    };\n\n    var wait = function (timeout) {\n        if (timeout > 0) {\n            return new Promise(function (resolve) {\n                setTimeout(resolve, timeout);\n            });\n        } else {\n            return Promise.resolve();\n        }\n    };\n\n    module.executeJavascript = function (element, options) {\n        return new Promise(function (resolve) {\n            var iframe = createHiddenElement(\n                    theWindow.document,\n                    \"iframe\",\n                    options.width,\n                    options.height\n                ),\n                html = element.outerHTML,\n                iframeErrorsMessages = [],\n                executeJsTimeout = options.executeJsTimeout || 0;\n\n            var cleanUp = function () {\n                // We have to defer removing the iframe from the current document, see https://github.com/cburgmer/rasterizeHTML.js/issues/219\n                theWindow.document\n                    .getElementsByTagName(\"body\")[0]\n                    .removeChild(iframe);\n            };\n\n            var doResolve = function () {\n                var doc = iframe.contentDocument;\n                resolve({\n                    document: doc,\n                    errors: iframeErrorsMessages,\n                    cleanUp: cleanUp,\n                });\n            };\n\n            var xhr = iframe.contentWindow.XMLHttpRequest,\n                finishNotifyXhrProxy = proxies.finishNotifyingXhr(xhr),\n                baseUrlXhrProxy = proxies.baseUrlRespectingXhr(\n                    finishNotifyXhrProxy,\n                    options.baseUrl\n                );\n\n            iframe.onload = function () {\n                wait(executeJsTimeout)\n                    .then(finishNotifyXhrProxy.waitForRequestsToFinish)\n                    .then(doResolve);\n            };\n\n            iframe.contentDocument.open();\n            iframe.contentWindow.XMLHttpRequest = baseUrlXhrProxy;\n            iframe.contentWindow.onerror = function (msg) {\n                iframeErrorsMessages.push({\n                    resourceType: \"scriptExecution\",\n                    msg: msg,\n                });\n            };\n\n            iframe.contentDocument.write(\"<!DOCTYPE html>\");\n            iframe.contentDocument.write(html);\n            iframe.contentDocument.close();\n        });\n    };\n\n    var createHiddenSandboxedIFrame = function (doc, width, height) {\n        var iframe = doc.createElement(\"iframe\");\n        iframe.style.width = width + \"px\";\n        iframe.style.height = height + \"px\";\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading content\n        iframe.style.visibility = \"hidden\";\n        iframe.style.position = \"absolute\";\n        iframe.style.top = -10000 - height + \"px\";\n        iframe.style.left = -10000 - width + \"px\";\n        // make sure content gets exact width independent of box-sizing value\n        iframe.style.borderWidth = 0;\n        // Don't execute JS, all we need from sandboxing is access to the iframe's document\n        iframe.sandbox = \"allow-same-origin\";\n        // Don't include a scrollbar on Linux\n        iframe.scrolling = \"no\";\n        return iframe;\n    };\n\n    var createIframeWithSizeAtZoomLevel1 = function (width, height, zoom) {\n        var scaledViewportWidth = Math.floor(width / zoom),\n            scaledViewportHeight = Math.floor(height / zoom);\n\n        return createHiddenSandboxedIFrame(\n            theWindow.document,\n            scaledViewportWidth,\n            scaledViewportHeight\n        );\n    };\n\n    var calculateZoomedContentSizeAndRoundUp = function (\n        actualViewport,\n        requestedWidth,\n        requestedHeight,\n        zoom\n    ) {\n        return {\n            width: Math.max(actualViewport.width * zoom, requestedWidth),\n            height: Math.max(actualViewport.height * zoom, requestedHeight),\n        };\n    };\n\n    var selectElementOrDescendant = function (element, selector) {\n        var descendant = element.querySelector(selector);\n        if (descendant) {\n            return descendant;\n        } else if (element.ownerDocument.querySelector(selector) === element) {\n            return element;\n        }\n\n        throw {\n            message: \"Clipping selector not found\",\n        };\n    };\n\n    var calculateContentSize = function (\n        rootElement,\n        selector,\n        requestedWidth,\n        requestedHeight,\n        zoom\n    ) {\n        // clientWidth/clientHeight needed for PhantomJS\n        var actualViewportWidth = Math.max(\n                rootElement.scrollWidth,\n                rootElement.clientWidth\n            ),\n            actualViewportHeight = Math.max(\n                rootElement.scrollHeight,\n                rootElement.clientHeight\n            ),\n            top,\n            left,\n            originalWidth,\n            originalHeight,\n            rootFontSize,\n            element,\n            rect,\n            contentSize;\n\n        if (selector) {\n            element = selectElementOrDescendant(rootElement, selector);\n\n            rect = element.getBoundingClientRect();\n\n            top = rect.top;\n            left = rect.left;\n            originalWidth = rect.width;\n            originalHeight = rect.height;\n        } else {\n            top = 0;\n            left = 0;\n            originalWidth = actualViewportWidth;\n            originalHeight = actualViewportHeight;\n        }\n\n        contentSize = calculateZoomedContentSizeAndRoundUp(\n            {\n                width: originalWidth,\n                height: originalHeight,\n            },\n            requestedWidth,\n            requestedHeight,\n            zoom\n        );\n\n        rootFontSize = theWindow.getComputedStyle(\n            rootElement.ownerDocument.documentElement\n        ).fontSize;\n\n        return {\n            left: left,\n            top: top,\n            width: contentSize.width,\n            height: contentSize.height,\n            viewportWidth: actualViewportWidth,\n            viewportHeight: actualViewportHeight,\n\n            rootFontSize: rootFontSize,\n        };\n    };\n\n    var findCorrelatingElement = function (element, documentClone) {\n        var tagName = element.tagName;\n        // Stupid but simple method: find first match. Should work for a single HTML element, and any other element given as root\n        return documentClone.querySelector(tagName);\n    };\n\n    var elementToFullHtmlDocument = function (element) {\n        var tagName = element.tagName.toLowerCase();\n        if (tagName === \"html\" || tagName === \"body\") {\n            return element.outerHTML;\n        }\n\n        // Simple hack: hide the body from sizing, otherwise browser would apply a 8px margin\n        return '<body style=\"margin: 0;\">' + element.outerHTML + \"</body>\";\n    };\n\n    module.calculateDocumentContentSize = function (element, options) {\n        return new Promise(function (resolve, reject) {\n            var zoom = options.zoom || 1,\n                iframe;\n\n            iframe = createIframeWithSizeAtZoomLevel1(\n                options.width,\n                options.height,\n                zoom\n            );\n            // We need to add the element to the document so that its content gets loaded\n            theWindow.document\n                .getElementsByTagName(\"body\")[0]\n                .appendChild(iframe);\n\n            iframe.onload = function () {\n                var doc = iframe.contentDocument,\n                    size;\n\n                try {\n                    size = calculateContentSize(\n                        findCorrelatingElement(element, doc),\n                        options.clip,\n                        options.width,\n                        options.height,\n                        zoom\n                    );\n\n                    resolve(size);\n                } catch (e) {\n                    reject(e);\n                } finally {\n                    theWindow.document\n                        .getElementsByTagName(\"body\")[0]\n                        .removeChild(iframe);\n                }\n            };\n\n            // srcdoc doesn't work in PhantomJS yet\n            iframe.contentDocument.open();\n            iframe.contentDocument.write(\"<!DOCTYPE html>\");\n            iframe.contentDocument.write(elementToFullHtmlDocument(element));\n            iframe.contentDocument.close();\n        });\n    };\n\n    module.parseHtmlFragment = function (htmlFragment) {\n        var doc = theWindow.document.implementation.createHTMLDocument(\"\");\n        doc.documentElement.innerHTML = htmlFragment;\n\n        var element = doc.querySelector(\"body\").firstChild;\n\n        if (!element) {\n            throw \"Invalid source\";\n        }\n\n        return element;\n    };\n\n    var addHTMLTagAttributes = function (doc, html) {\n        var attributeMatch = /<html((?:\\s+[^>]*)?)>/im.exec(html),\n            helperDoc =\n                theWindow.document.implementation.createHTMLDocument(\"\"),\n            htmlTagSubstitute,\n            i,\n            elementSubstitute,\n            attribute;\n\n        if (!attributeMatch) {\n            return;\n        }\n\n        htmlTagSubstitute = \"<div\" + attributeMatch[1] + \"></div>\";\n        helperDoc.documentElement.innerHTML = htmlTagSubstitute;\n        elementSubstitute = helperDoc.querySelector(\"div\");\n\n        for (i = 0; i < elementSubstitute.attributes.length; i++) {\n            attribute = elementSubstitute.attributes[i];\n            doc.documentElement.setAttribute(attribute.name, attribute.value);\n        }\n    };\n\n    module.parseHTML = function (html) {\n        // We should be using the DOMParser, but it is not supported in older browsers\n        var doc = theWindow.document.implementation.createHTMLDocument(\"\");\n        doc.documentElement.innerHTML = html;\n\n        addHTMLTagAttributes(doc, html);\n        return doc;\n    };\n\n    var failOnInvalidSource = function (doc) {\n        try {\n            return sanedomparsererror.failOnParseError(doc);\n        } catch (e) {\n            throw {\n                message: \"Invalid source\",\n                originalError: e,\n            };\n        }\n    };\n\n    module.validateXHTML = function (xhtml) {\n        var p = new DOMParser(),\n            doc = p.parseFromString(xhtml, \"application/xml\");\n\n        failOnInvalidSource(doc);\n    };\n\n    var lastCacheDate = null;\n\n    var getUncachableURL = function (url, cache) {\n        if (cache === \"none\" || cache === \"repeated\") {\n            if (lastCacheDate === null || cache !== \"repeated\") {\n                lastCacheDate = Date.now();\n            }\n            return url + \"?_=\" + lastCacheDate;\n        } else {\n            return url;\n        }\n    };\n\n    var doDocumentLoad = function (url, options) {\n        return new Promise(function (resolve, reject) {\n            var xhr = new window.XMLHttpRequest(),\n                joinedUrl = util.joinUrl(options.baseUrl, url),\n                augmentedUrl = getUncachableURL(joinedUrl, options.cache),\n                doReject = function (e) {\n                    reject({\n                        message: \"Unable to load page\",\n                        originalError: e,\n                    });\n                };\n\n            xhr.addEventListener(\n                \"load\",\n                function () {\n                    if (xhr.status === 200 || xhr.status === 0) {\n                        resolve(xhr.responseXML);\n                    } else {\n                        doReject(xhr.statusText);\n                    }\n                },\n                false\n            );\n\n            xhr.addEventListener(\n                \"error\",\n                function (e) {\n                    doReject(e);\n                },\n                false\n            );\n\n            try {\n                xhr.open(\"GET\", augmentedUrl, true);\n                xhr.responseType = \"document\";\n                xhr.send(null);\n            } catch (e) {\n                doReject(e);\n            }\n        });\n    };\n\n    module.loadDocument = function (url, options) {\n        return doDocumentLoad(url, options).then(function (doc) {\n            return failOnInvalidSource(doc);\n        });\n    };\n\n    return module;\n})(util, proxies, sanedomparsererror, window);\n\nvar svg2image = (function (window) {\n    \"use strict\";\n\n    var module = {};\n\n    var urlForSvg = function (svg, useBlobs) {\n        if (useBlobs) {\n            return URL.createObjectURL(\n                new Blob([svg], { type: \"image/svg+xml\" })\n            );\n        } else {\n            return (\n                \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svg)\n            );\n        }\n    };\n\n    var cleanUpUrl = function (url) {\n        if (url instanceof Blob) {\n            URL.revokeObjectURL(url);\n        }\n    };\n\n    var simpleForeignObjectSvg =\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1\" height=\"1\"><foreignObject></foreignObject></svg>';\n\n    var supportsReadingObjectFromCanvas = function (url) {\n        return new Promise(function (resolve, reject) {\n            var canvas = document.createElement(\"canvas\"),\n                image = new Image();\n\n            image.onload = function () {\n                var context = canvas.getContext(\"2d\");\n                try {\n                    context.drawImage(image, 0, 0);\n                    // This will fail in Chrome & Safari\n                    canvas.toDataURL(\"image/png\");\n                    resolve(true);\n                } catch (e) {\n                    resolve(false);\n                }\n            };\n            image.onerror = reject;\n            image.src = url;\n        });\n    };\n\n    var readingBackFromCanvasBenefitsFromOldSchoolDataUris = function () {\n        // Check for work around for https://code.google.com/p/chromium/issues/detail?id=294129\n        var blobUrl = urlForSvg(simpleForeignObjectSvg, true);\n        return supportsReadingObjectFromCanvas(blobUrl).then(\n            function (supportsReadingFromBlobs) {\n                cleanUpUrl(blobUrl);\n                if (supportsReadingFromBlobs) {\n                    return false;\n                }\n                return supportsReadingObjectFromCanvas(\n                    urlForSvg(simpleForeignObjectSvg, false)\n                ).then(function (s) {\n                    return s;\n                });\n            },\n            function () {\n                return false;\n            }\n        );\n    };\n\n    var supportsBlobBuilding = function () {\n        if (window.Blob) {\n            // Available as constructor only in newer builds for all browsers\n            try {\n                new Blob([\"<b></b>\"], { type: \"text/xml\" });\n                return true;\n            } catch (err) {}\n        }\n        return false;\n    };\n\n    var checkBlobSupport = function () {\n        return new Promise(function (resolve, reject) {\n            if (supportsBlobBuilding() && window.URL) {\n                readingBackFromCanvasBenefitsFromOldSchoolDataUris().then(\n                    function (doesBenefit) {\n                        resolve(!doesBenefit);\n                    },\n                    function () {\n                        reject();\n                    }\n                );\n            } else {\n                resolve(false);\n            }\n        });\n    };\n\n    var checkForBlobsResult;\n\n    var checkForBlobs = function () {\n        if (checkForBlobsResult === undefined) {\n            checkForBlobsResult = checkBlobSupport();\n        }\n\n        return checkForBlobsResult;\n    };\n\n    var buildImageUrl = function (svg) {\n        return checkForBlobs().then(function (useBlobs) {\n            return urlForSvg(svg, useBlobs);\n        });\n    };\n\n    module.renderSvg = function (svg) {\n        return new Promise(function (resolve, reject) {\n            var url,\n                image,\n                resetEventHandlers = function () {\n                    image.onload = null;\n                    image.onerror = null;\n                },\n                cleanUp = function () {\n                    if (url) {\n                        cleanUpUrl(url);\n                    }\n                };\n\n            image = new Image();\n            image.onload = function () {\n                resetEventHandlers();\n                cleanUp();\n\n                resolve(image);\n            };\n            image.onerror = function () {\n                cleanUp();\n\n                reject();\n            };\n\n            buildImageUrl(svg).then(function (imageUrl) {\n                url = imageUrl;\n                image.src = url;\n            }, reject);\n        });\n    };\n\n    return module;\n})(window);\n\nvar document2svg = (function (util, browser, documentHelper, xmlserializer) {\n    \"use strict\";\n\n    var module = {};\n\n    var svgAttributes = function (size, zoom) {\n        var zoomFactor = zoom || 1;\n\n        var attributes = {\n            width: size.width,\n            height: size.height,\n            \"font-size\": size.rootFontSize,\n        };\n\n        if (zoomFactor !== 1) {\n            attributes.style =\n                \"transform:scale(\" + zoomFactor + \"); transform-origin: 0 0;\";\n        }\n\n        return attributes;\n    };\n\n    var foreignObjectAttributes = function (size) {\n        var closestScaledWith, closestScaledHeight, offsetX, offsetY;\n\n        closestScaledWith = Math.round(size.viewportWidth);\n        closestScaledHeight = Math.round(size.viewportHeight);\n\n        offsetX = -size.left;\n        offsetY = -size.top;\n\n        var attributes = {\n            x: offsetX,\n            y: offsetY,\n            width: closestScaledWith,\n            height: closestScaledHeight,\n        };\n\n        return attributes;\n    };\n\n    var workAroundCollapsingMarginsAcrossSVGElementInWebKitLike = function (\n        attributes\n    ) {\n        var style = attributes.style || \"\";\n        attributes.style = style + \"float: left;\";\n    };\n\n    var workAroundSafariSometimesNotShowingExternalResources = function (\n        attributes\n    ) {\n        /* Let's hope that works some magic. The spec says SVGLoad only fires\n         * now when all externals are available.\n         * http://www.w3.org/TR/SVG/struct.html#ExternalResourcesRequired */\n        attributes.externalResourcesRequired = true;\n    };\n\n    var workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll =\n        function () {\n            return '<style scoped=\"\">html::-webkit-scrollbar { display: none; }</style>';\n        };\n\n    var serializeAttributes = function (attributes) {\n        var keys = Object.keys(attributes);\n        if (!keys.length) {\n            return \"\";\n        }\n\n        return (\n            \" \" +\n            keys\n                .map(function (key) {\n                    return key + '=\"' + attributes[key] + '\"';\n                })\n                .join(\" \")\n        );\n    };\n\n    var convertElementToSvg = function (element, size, zoomFactor) {\n        var xhtml = xmlserializer.serializeToString(element);\n\n        browser.validateXHTML(xhtml);\n\n        var foreignObjectAttrs = foreignObjectAttributes(size);\n        workAroundCollapsingMarginsAcrossSVGElementInWebKitLike(\n            foreignObjectAttrs\n        );\n        workAroundSafariSometimesNotShowingExternalResources(\n            foreignObjectAttrs\n        );\n\n        return (\n            '<svg xmlns=\"http://www.w3.org/2000/svg\"' +\n            serializeAttributes(svgAttributes(size, zoomFactor)) +\n            \">\" +\n            workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll() +\n            \"<foreignObject\" +\n            serializeAttributes(foreignObjectAttrs) +\n            \">\" +\n            xhtml +\n            \"</foreignObject>\" +\n            \"</svg>\"\n        );\n    };\n\n    module.getSvgForDocument = function (element, size, zoomFactor) {\n        documentHelper.rewriteTagNameSelectorsToLowerCase(element);\n\n        return convertElementToSvg(element, size, zoomFactor);\n    };\n\n    module.drawDocumentAsSvg = function (element, options) {\n        [\"hover\", \"active\", \"focus\", \"target\"].forEach(function (action) {\n            if (options[action]) {\n                documentHelper.fakeUserAction(element, options[action], action);\n            }\n        });\n\n        return browser\n            .calculateDocumentContentSize(element, options)\n            .then(function (size) {\n                return module.getSvgForDocument(element, size, options.zoom);\n            });\n    };\n\n    return module;\n})(util, browser, documentHelper, xmlserializer);\n\nvar rasterize = (function (\n    util,\n    browser,\n    documentHelper,\n    document2svg,\n    svg2image,\n    inlineresources\n) {\n    \"use strict\";\n\n    var module = {};\n\n    var generalDrawError = function (e) {\n        return {\n            message: \"Error rendering page\",\n            originalError: e,\n        };\n    };\n\n    var drawSvgAsImg = function (svg) {\n        return svg2image.renderSvg(svg).then(\n            function (image) {\n                return {\n                    image: image,\n                    svg: svg,\n                };\n            },\n            function (e) {\n                throw generalDrawError(e);\n            }\n        );\n    };\n\n    var drawImageOnCanvas = function (image, canvas) {\n        try {\n            canvas.getContext(\"2d\").drawImage(image, 0, 0);\n        } catch (e) {\n            // Firefox throws a 'NS_ERROR_NOT_AVAILABLE' if the SVG is faulty\n            throw generalDrawError(e);\n        }\n    };\n\n    var doDraw = function (element, canvas, options) {\n        return document2svg\n            .drawDocumentAsSvg(element, options)\n            .then(drawSvgAsImg)\n            .then(function (result) {\n                if (canvas) {\n                    drawImageOnCanvas(result.image, canvas);\n                }\n\n                return result;\n            });\n    };\n\n    var operateJavaScriptOnDocument = function (element, options) {\n        return browser\n            .executeJavascript(element, options)\n            .then(function (result) {\n                var document = result.document;\n                documentHelper.persistInputValues(document);\n\n                return {\n                    document: document,\n                    errors: result.errors,\n                    cleanUp: result.cleanUp,\n                };\n            });\n    };\n\n    module.rasterize = function (element, canvas, options) {\n        var inlineOptions;\n\n        inlineOptions = util.clone(options);\n        inlineOptions.inlineScripts = options.executeJs === true;\n\n        return inlineresources\n            .inlineReferences(element, inlineOptions)\n            .then(function (errors) {\n                if (options.executeJs) {\n                    return operateJavaScriptOnDocument(element, options).then(\n                        function (result) {\n                            return {\n                                element: result.document.documentElement,\n                                errors: errors.concat(result.errors),\n                                cleanUp: result.cleanUp,\n                            };\n                        }\n                    );\n                } else {\n                    return {\n                        element: element,\n                        errors: errors,\n                        cleanUp: function () {},\n                    };\n                }\n            })\n            .then(function (result) {\n                return doDraw(result.element, canvas, options).then(function (\n                    drawResult\n                ) {\n                    result.cleanUp();\n\n                    return {\n                        image: drawResult.image,\n                        svg: drawResult.svg,\n                        errors: result.errors,\n                    };\n                });\n            });\n    };\n\n    return module;\n})(util, browser, documentHelper, document2svg, svg2image, inlineresources);\n\nvar rasterizeHTML = (function (util, browser, rasterize) {\n    \"use strict\";\n\n    var module = {};\n\n    var getViewportSize = function (canvas, options) {\n        var defaultWidth = 300,\n            defaultHeight = 200,\n            fallbackWidth = canvas ? canvas.width : defaultWidth,\n            fallbackHeight = canvas ? canvas.height : defaultHeight,\n            width = options.width !== undefined ? options.width : fallbackWidth,\n            height =\n                options.height !== undefined ? options.height : fallbackHeight;\n\n        return {\n            width: width,\n            height: height,\n        };\n    };\n\n    var constructOptions = function (params) {\n        var viewport = getViewportSize(params.canvas, params.options),\n            options;\n\n        options = util.clone(params.options);\n        options.width = viewport.width;\n        options.height = viewport.height;\n\n        return options;\n    };\n\n    /**\n     * Draws a Document to the canvas.\n     * rasterizeHTML.drawDocument( document [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawDocument = function () {\n        var doc = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        var element = doc.documentElement ? doc.documentElement : doc;\n\n        return rasterize.rasterize(\n            element,\n            params.canvas,\n            constructOptions(params)\n        );\n    };\n\n    var drawHTML = function (html, canvas, options) {\n        var doc = browser.parseHTML(html);\n\n        return module.drawDocument(doc, canvas, options);\n    };\n\n    /**\n     * Draws a HTML string to the canvas.\n     * rasterizeHTML.drawHTML( html [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawHTML = function () {\n        var html = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawHTML(html, params.canvas, params.options);\n    };\n\n    // work around https://bugzilla.mozilla.org/show_bug.cgi?id=925493\n    var workAroundFirefoxNotLoadingStylesheetStyles = function (\n        doc,\n        url,\n        options\n    ) {\n        var d = document.implementation.createHTMLDocument(\"\");\n        d.replaceChild(doc.documentElement, d.documentElement);\n\n        var extendedOptions = options ? util.clone(options) : {};\n\n        if (!options.baseUrl) {\n            extendedOptions.baseUrl = url;\n        }\n\n        return {\n            document: d,\n            options: extendedOptions,\n        };\n    };\n\n    var drawURL = function (url, canvas, options) {\n        return browser.loadDocument(url, options).then(function (doc) {\n            var workaround = workAroundFirefoxNotLoadingStylesheetStyles(\n                doc,\n                url,\n                options\n            );\n            return module.drawDocument(\n                workaround.document,\n                canvas,\n                workaround.options\n            );\n        });\n    };\n\n    /**\n     * Draws a page to the canvas.\n     * rasterizeHTML.drawURL( url [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawURL = function () {\n        var url = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawURL(url, params.canvas, params.options);\n    };\n\n    return module;\n})(util, browser, rasterize);\n\nreturn rasterizeHTML;\n\n}));\n","'use strict';\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nexports.failOnParseError = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n","(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define([], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = factory();\n    } else {\n        root.xmlserializer = factory();\n    }\n}(this, function () {\n\n    var removeInvalidCharacters = function (content) {\n        // See http://www.w3.org/TR/xml/#NT-Char for valid XML 1.0 characters\n        return content.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]/g, '');\n    };\n\n    var serializeAttributeValue = function (value) {\n        return value\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n    };\n\n    var serializeTextContent = function (content) {\n        return content\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;');\n    };\n\n    var serializeAttribute = function (attr) {\n        var value = attr.value;\n\n        return ' ' + attr.name + '=\"' + serializeAttributeValue(value) + '\"';\n    };\n\n    var getTagName = function (node) {\n        var tagName = node.tagName;\n\n        // Aid in serializing of original HTML documents\n        if (node.namespaceURI === 'http://www.w3.org/1999/xhtml') {\n            tagName = tagName.toLowerCase();\n        }\n        return tagName;\n    };\n\n    var serializeNamespace = function (node, isRootNode) {\n        var nodeHasXmlnsAttr = Array.prototype.map.call(node.attributes || node.attrs, function (attr) {\n            return attr.name;\n        })\n                .indexOf('xmlns') >= 0;\n        // Serialize the namespace as an xmlns attribute whenever the element\n        // doesn't already have one and the inherited namespace does not match\n        // the element's namespace.\n        if (!nodeHasXmlnsAttr &&\n            (isRootNode ||\n             node.namespaceURI !== node.parentNode.namespaceURI)) {\n            return ' xmlns=\"' + node.namespaceURI + '\"';\n        } else {\n            return '';\n        }\n    };\n\n    var serializeChildren = function (node) {\n        return Array.prototype.map.call(node.childNodes, function (childNode) {\n            return nodeTreeToXHTML(childNode);\n        }).join('');\n    };\n\n    var serializeTag = function (node, isRootNode) {\n        var output = '<' + getTagName(node);\n        output += serializeNamespace(node, isRootNode);\n\n        Array.prototype.forEach.call(node.attributes || node.attrs, function (attr) {\n            output += serializeAttribute(attr);\n        });\n\n        if (node.childNodes.length > 0) {\n            output += '>';\n            output += serializeChildren(node);\n            output += '</' + getTagName(node) + '>';\n        } else {\n            output += '/>';\n        }\n        return output;\n    };\n\n    var serializeText = function (node) {\n        var text = node.nodeValue || node.value || '';\n        return serializeTextContent(text);\n    };\n\n    var serializeComment = function (node) {\n        return '<!--' +\n            node.data\n            .replace(/-/g, '&#45;') +\n            '-->';\n    };\n\n    var serializeCDATA = function (node) {\n        return '<![CDATA[' + node.nodeValue + ']]>';\n    };\n\n    var nodeTreeToXHTML = function (node, options) {\n        var isRootNode = options && options.rootNode;\n\n        if (node.nodeName === '#document' ||\n            node.nodeName === '#document-fragment') {\n            return serializeChildren(node);\n        } else {\n            if (node.tagName) {\n                return serializeTag(node, isRootNode);\n            } else if (node.nodeName === '#text') {\n                return serializeText(node);\n            } else if (node.nodeName === '#comment') {\n                return serializeComment(node);\n            } else if (node.nodeName === '#cdata-section') {\n                return serializeCDATA(node);\n            }\n        }\n    };\n\n    return {\n        serializeToString: function (node) {\n            return removeInvalidCharacters(nodeTreeToXHTML(node, {rootNode: true}));\n        }\n    };\n}));\n","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromiseConstructor = require('../internals/promise-native-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar defineBuiltIn = require('../internals/define-built-in');\n\nvar NativePromisePrototype = NativePromiseConstructor && NativePromiseConstructor.prototype;\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromiseConstructor && fails(function () {\n  // eslint-disable-next-line unicorn/no-thenable -- required for testing\n  NativePromisePrototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = isCallable(onFinally);\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// makes sure that native promise-based APIs `Promise#finally` properly works with patched `Promise#then`\nif (!IS_PURE && isCallable(NativePromiseConstructor)) {\n  var method = getBuiltIn('Promise').prototype['finally'];\n  if (NativePromisePrototype['finally'] !== method) {\n    defineBuiltIn(NativePromisePrototype, 'finally', method, { unsafe: true });\n  }\n}\n","/**\n * The base implementation of `_.slice` without an iteratee call guard.\n *\n * @private\n * @param {Array} array The array to slice.\n * @param {number} [start=0] The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the slice of `array`.\n */\nfunction baseSlice(array, start, end) {\n  var index = -1,\n      length = array.length;\n\n  if (start < 0) {\n    start = -start > length ? 0 : (length + start);\n  }\n  end = end > length ? length : end;\n  if (end < 0) {\n    end += length;\n  }\n  length = start > end ? 0 : ((end - start) >>> 0);\n  start >>>= 0;\n\n  var result = Array(length);\n  while (++index < length) {\n    result[index] = array[index + start];\n  }\n  return result;\n}\n\nexport default baseSlice;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsZWJ = '\\\\u200d';\n\n/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\nvar reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n/**\n * Checks if `string` contains Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n */\nfunction hasUnicode(string) {\n  return reHasUnicode.test(string);\n}\n\nexport default hasUnicode;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsAstral = '[' + rsAstralRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\nvar reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n/**\n * Converts a Unicode `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction unicodeToArray(string) {\n  return string.match(reUnicode) || [];\n}\n\nexport default unicodeToArray;\n","import asciiToArray from './_asciiToArray.js';\nimport hasUnicode from './_hasUnicode.js';\nimport unicodeToArray from './_unicodeToArray.js';\n\n/**\n * Converts `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction stringToArray(string) {\n  return hasUnicode(string)\n    ? unicodeToArray(string)\n    : asciiToArray(string);\n}\n\nexport default stringToArray;\n","/**\n * Converts an ASCII `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction asciiToArray(string) {\n  return string.split('');\n}\n\nexport default asciiToArray;\n","import createCaseFirst from './_createCaseFirst.js';\n\n/**\n * Converts the first character of `string` to upper case.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category String\n * @param {string} [string=''] The string to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.upperFirst('fred');\n * // => 'Fred'\n *\n * _.upperFirst('FRED');\n * // => 'FRED'\n */\nvar upperFirst = createCaseFirst('toUpperCase');\n\nexport default upperFirst;\n","import castSlice from './_castSlice.js';\nimport hasUnicode from './_hasUnicode.js';\nimport stringToArray from './_stringToArray.js';\nimport toString from './toString.js';\n\n/**\n * Creates a function like `_.lowerFirst`.\n *\n * @private\n * @param {string} methodName The name of the `String` case method to use.\n * @returns {Function} Returns the new case function.\n */\nfunction createCaseFirst(methodName) {\n  return function(string) {\n    string = toString(string);\n\n    var strSymbols = hasUnicode(string)\n      ? stringToArray(string)\n      : undefined;\n\n    var chr = strSymbols\n      ? strSymbols[0]\n      : string.charAt(0);\n\n    var trailing = strSymbols\n      ? castSlice(strSymbols, 1).join('')\n      : string.slice(1);\n\n    return chr[methodName]() + trailing;\n  };\n}\n\nexport default createCaseFirst;\n","import baseSlice from './_baseSlice.js';\n\n/**\n * Casts `array` to a slice if it's needed.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {number} start The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the cast slice.\n */\nfunction castSlice(array, start, end) {\n  var length = array.length;\n  end = end === undefined ? length : end;\n  return (!start && end >= length) ? array : baseSlice(array, start, end);\n}\n\nexport default castSlice;\n","import toString from './toString.js';\nimport upperFirst from './upperFirst.js';\n\n/**\n * Converts the first character of `string` to upper case and the remaining\n * to lower case.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category String\n * @param {string} [string=''] The string to capitalize.\n * @returns {string} Returns the capitalized string.\n * @example\n *\n * _.capitalize('FRED');\n * // => 'Fred'\n */\nfunction capitalize(string) {\n  return upperFirst(toString(string).toLowerCase());\n}\n\nexport default capitalize;\n","export default function(x) {\n  return x;\n}\n","import identity from \"./identity.js\";\n\nvar top = 1,\n    right = 2,\n    bottom = 3,\n    left = 4,\n    epsilon = 1e-6;\n\nfunction translateX(x) {\n  return \"translate(\" + x + \",0)\";\n}\n\nfunction translateY(y) {\n  return \"translate(0,\" + y + \")\";\n}\n\nfunction number(scale) {\n  return d => +scale(d);\n}\n\nfunction center(scale, offset) {\n  offset = Math.max(0, scale.bandwidth() - offset * 2) / 2;\n  if (scale.round()) offset = Math.round(offset);\n  return d => +scale(d) + offset;\n}\n\nfunction entering() {\n  return !this.__axis;\n}\n\nfunction axis(orient, scale) {\n  var tickArguments = [],\n      tickValues = null,\n      tickFormat = null,\n      tickSizeInner = 6,\n      tickSizeOuter = 6,\n      tickPadding = 3,\n      offset = typeof window !== \"undefined\" && window.devicePixelRatio > 1 ? 0 : 0.5,\n      k = orient === top || orient === left ? -1 : 1,\n      x = orient === left || orient === right ? \"x\" : \"y\",\n      transform = orient === top || orient === bottom ? translateX : translateY;\n\n  function axis(context) {\n    var values = tickValues == null ? (scale.ticks ? scale.ticks.apply(scale, tickArguments) : scale.domain()) : tickValues,\n        format = tickFormat == null ? (scale.tickFormat ? scale.tickFormat.apply(scale, tickArguments) : identity) : tickFormat,\n        spacing = Math.max(tickSizeInner, 0) + tickPadding,\n        range = scale.range(),\n        range0 = +range[0] + offset,\n        range1 = +range[range.length - 1] + offset,\n        position = (scale.bandwidth ? center : number)(scale.copy(), offset),\n        selection = context.selection ? context.selection() : context,\n        path = selection.selectAll(\".domain\").data([null]),\n        tick = selection.selectAll(\".tick\").data(values, scale).order(),\n        tickExit = tick.exit(),\n        tickEnter = tick.enter().append(\"g\").attr(\"class\", \"tick\"),\n        line = tick.select(\"line\"),\n        text = tick.select(\"text\");\n\n    path = path.merge(path.enter().insert(\"path\", \".tick\")\n        .attr(\"class\", \"domain\")\n        .attr(\"stroke\", \"currentColor\"));\n\n    tick = tick.merge(tickEnter);\n\n    line = line.merge(tickEnter.append(\"line\")\n        .attr(\"stroke\", \"currentColor\")\n        .attr(x + \"2\", k * tickSizeInner));\n\n    text = text.merge(tickEnter.append(\"text\")\n        .attr(\"fill\", \"currentColor\")\n        .attr(x, k * spacing)\n        .attr(\"dy\", orient === top ? \"0em\" : orient === bottom ? \"0.71em\" : \"0.32em\"));\n\n    if (context !== selection) {\n      path = path.transition(context);\n      tick = tick.transition(context);\n      line = line.transition(context);\n      text = text.transition(context);\n\n      tickExit = tickExit.transition(context)\n          .attr(\"opacity\", epsilon)\n          .attr(\"transform\", function(d) { return isFinite(d = position(d)) ? transform(d + offset) : this.getAttribute(\"transform\"); });\n\n      tickEnter\n          .attr(\"opacity\", epsilon)\n          .attr(\"transform\", function(d) { var p = this.parentNode.__axis; return transform((p && isFinite(p = p(d)) ? p : position(d)) + offset); });\n    }\n\n    tickExit.remove();\n\n    path\n        .attr(\"d\", orient === left || orient === right\n            ? (tickSizeOuter ? \"M\" + k * tickSizeOuter + \",\" + range0 + \"H\" + offset + \"V\" + range1 + \"H\" + k * tickSizeOuter : \"M\" + offset + \",\" + range0 + \"V\" + range1)\n            : (tickSizeOuter ? \"M\" + range0 + \",\" + k * tickSizeOuter + \"V\" + offset + \"H\" + range1 + \"V\" + k * tickSizeOuter : \"M\" + range0 + \",\" + offset + \"H\" + range1));\n\n    tick\n        .attr(\"opacity\", 1)\n        .attr(\"transform\", function(d) { return transform(position(d) + offset); });\n\n    line\n        .attr(x + \"2\", k * tickSizeInner);\n\n    text\n        .attr(x, k * spacing)\n        .text(format);\n\n    selection.filter(entering)\n        .attr(\"fill\", \"none\")\n        .attr(\"font-size\", 10)\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"text-anchor\", orient === right ? \"start\" : orient === left ? \"end\" : \"middle\");\n\n    selection\n        .each(function() { this.__axis = position; });\n  }\n\n  axis.scale = function(_) {\n    return arguments.length ? (scale = _, axis) : scale;\n  };\n\n  axis.ticks = function() {\n    return tickArguments = Array.from(arguments), axis;\n  };\n\n  axis.tickArguments = function(_) {\n    return arguments.length ? (tickArguments = _ == null ? [] : Array.from(_), axis) : tickArguments.slice();\n  };\n\n  axis.tickValues = function(_) {\n    return arguments.length ? (tickValues = _ == null ? null : Array.from(_), axis) : tickValues && tickValues.slice();\n  };\n\n  axis.tickFormat = function(_) {\n    return arguments.length ? (tickFormat = _, axis) : tickFormat;\n  };\n\n  axis.tickSize = function(_) {\n    return arguments.length ? (tickSizeInner = tickSizeOuter = +_, axis) : tickSizeInner;\n  };\n\n  axis.tickSizeInner = function(_) {\n    return arguments.length ? (tickSizeInner = +_, axis) : tickSizeInner;\n  };\n\n  axis.tickSizeOuter = function(_) {\n    return arguments.length ? (tickSizeOuter = +_, axis) : tickSizeOuter;\n  };\n\n  axis.tickPadding = function(_) {\n    return arguments.length ? (tickPadding = +_, axis) : tickPadding;\n  };\n\n  axis.offset = function(_) {\n    return arguments.length ? (offset = +_, axis) : offset;\n  };\n\n  return axis;\n}\n\nexport function axisTop(scale) {\n  return axis(top, scale);\n}\n\nexport function axisRight(scale) {\n  return axis(right, scale);\n}\n\nexport function axisBottom(scale) {\n  return axis(bottom, scale);\n}\n\nexport function axisLeft(scale) {\n  return axis(left, scale);\n}\n","const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction append(strings) {\n  this._ += strings[0];\n  for (let i = 1, n = strings.length; i < n; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  let d = Math.floor(digits);\n  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  const k = 10 ** d;\n  return function(strings) {\n    this._ += strings[0];\n    for (let i = 1, n = strings.length; i < n; ++i) {\n      this._ += Math.round(arguments[i] * k) / k + strings[i];\n    }\n  };\n}\n\nexport class Path {\n  constructor(digits) {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n    this._append = digits == null ? append : appendRound(digits);\n  }\n  moveTo(x, y) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._append`Z`;\n    }\n  }\n  lineTo(x, y) {\n    this._append`L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  quadraticCurveTo(x1, y1, x, y) {\n    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  bezierCurveTo(x1, y1, x2, y2, x, y) {\n    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arcTo(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._append`M${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._append`L${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      let x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;\n      }\n\n      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;\n    }\n  }\n  arc(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._append`M${x0},${y0}`;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._append`L${x0},${y0}`;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._append`A${r},${r},0,${+(da >= pi)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;\n    }\n  }\n  rect(x, y, w, h) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;\n  }\n  toString() {\n    return this._;\n  }\n}\n\nexport function path() {\n  return new Path;\n}\n\n// Allow instanceof d3.path\npath.prototype = Path.prototype;\n\nexport function pathRound(digits = 3) {\n  return new Path(+digits);\n}\n","export const radians = Math.PI / 180;\nexport const degrees = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * degrees - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * radians,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","import {cubehelix as colorCubehelix} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction cubehelix(hue) {\n  return (function cubehelixGamma(y) {\n    y = +y;\n\n    function cubehelix(start, end) {\n      var h = hue((start = colorCubehelix(start)).h, (end = colorCubehelix(end)).h),\n          s = color(start.s, end.s),\n          l = color(start.l, end.l),\n          opacity = color(start.opacity, end.opacity);\n      return function(t) {\n        start.h = h(t);\n        start.s = s(t);\n        start.l = l(Math.pow(t, y));\n        start.opacity = opacity(t);\n        return start + \"\";\n      };\n    }\n\n    cubehelix.gamma = cubehelixGamma;\n\n    return cubehelix;\n  })(1);\n}\n\nexport default cubehelix(hue);\nexport var cubehelixLong = cubehelix(color);\n","import {cubehelix} from \"d3-color\";\nimport {interpolateCubehelixLong} from \"d3-interpolate\";\n\nexport var warm = interpolateCubehelixLong(cubehelix(-100, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nexport var cool = interpolateCubehelixLong(cubehelix(260, 0.75, 0.35), cubehelix(80, 1.50, 0.8));\n\nvar c = cubehelix();\n\nexport default function(t) {\n  if (t < 0 || t > 1) t -= Math.floor(t);\n  var ts = Math.abs(t - 0.5);\n  c.h = 360 * t - 100;\n  c.s = 1.5 - 1.5 * ts;\n  c.l = 0.8 - 0.9 * ts;\n  return c + \"\";\n}\n"],"names":["identity","x","supportedScales","Map","hydroInterfaceScale","hydroOctanoleScale","hydroScale","isoelectricPointScale","defaultScale","domain","range","NightingaleColoredSequence","NightingaleSequence","constructor","scale","undefined","_NightingaleColoredSequence_uniqueID","set","_NightingaleColoredSequence_gradient","_NightingaleColoredSequence_seq_bg","_NightingaleColoredSequence_residues","colorScale","createSequence","super","__classPrivateFieldSet","this","Math","random","toString","substring","_a","svg","select","attr","_b","append","__classPrivateFieldGet","_c","style","_d","selectAll","remove","margins","_e","getScaleFromAttribute","attributeScale","has","get","test","text","options","Error","keyFormatter","valueFormatter","Object","assign","trim","blocks","split","map","bl","obj","forEach","length","join","String2Object","toUpperCase","parseFloat","error","console","renderD3","seq_g","width","height","scaleLinear","color","fakeElement","document","createElement","borderColor","isColorValid","i","number","Number","isNaN","ColorScaleParser","ftWidth","getSingleBaseWidth","first","round","max","getStart","last","min","sequence","getEnd","bases","slice","aa","value","start","end","data","d","enter","_ref","_ref2","merge","_ref3","_ref4","getXFromSeqPosition","call","bindEvents","exit","stops","_","pos","base","_f","_g","updateHighlight","renderMarginOnGroup","__decorate","property","type","String","reflect","customElement","values","valueof","index","Array","from","Linear","context","_context","prototype","areaStart","_line","areaEnd","NaN","lineStart","_point","lineEnd","closePath","point","y","lineTo","moveTo","withPath","shape","digits","arguments","floor","RangeError","p","defined","constant","curve","output","path","line","buffer","n","array","defined0","that","bezierCurveTo","_x0","_x1","_y0","_y1","Basis","_k","_x2","_y2","Cardinal","tension","custom","cardinal","LinearClosed","sign","slope3","x2","y2","h0","h1","s0","s1","abs","slope2","t","h","t0","t1","x0","y0","x1","y1","dx","MonotoneX","MonotoneY","ReflectContext","Natural","controlPoints","m","a","b","r","Step","_t","noop","_t0","create","_x","_y","px","py","i0","i1","push","curves","curveLinear","curveLinearClosed","curveMonotoneX","curveMonotoneY","curveBasis","curveCardinal","curveStep","curveStepAfter","curveStepBefore","curveNatural","NightingaleLinegraphTrack","withManager","withZoom","withResizable","withMargin","withPosition","withDimensions","withHighlight","NightingaleElement","_NightingaleLinegraphTrack_highlighted","_NightingaleLinegraphTrack_margins","_NightingaleLinegraphTrack_chart","_NightingaleLinegraphTrack_data","_NightingaleLinegraphTrack_minRange","_NightingaleLinegraphTrack_maxRange","_NightingaleLinegraphTrack_overlay","yScale","connectedCallback","createTrack","minimum","maximum","v","position","Infinity","beginning","chartGroup","_initYScale","name","interpolateRainbow","fill","drawLine","mouseG","lines","mousePerLine","on","event","mouse","d3Mouse","xScale","features","seqPosition","invert","find","nodes","getTotalLength","target","getPointAtLength","detail","eventtype","feature","highlight","dispatchEvent","CustomEvent","bubbles","cancelable","refresh","onDimensionsChange","graph","lineCurve","area","j","k","x0z","y0z","arealine","lineX0","lineY0","lineY1","lineX1","offset","highlighs","highlightedRegion","segments","zoomRefreshed","firstUpdated","render","html","_templateObject","NightingaleManager","NightingaleManager_1","protvistaElements","Set","propertyValues","addEventListener","changeListener","display","attributeChangedCallback","previousValue","newValue","applyAttributes","element","removeAttribute","setAttribute","register","add","unregister","delete","applyProperties","forElementId","querySelector","isRegisteredAttribute","attributeName","keys","includes","observedAttributes","e","handler","for","key","converter","fromAttribute","attributes","indexOf","filter","toAttribute","state","NightingaleNavigation","_NightingaleNavigation_x","_NightingaleNavigation_dontDispatch","_NightingaleNavigation_svg","_NightingaleNavigation_displaystartLabel","_NightingaleNavigation_displayendLabel","_NightingaleNavigation_axis","_NightingaleNavigation_brushG","_NightingaleNavigation_polygon","_NightingaleNavigation_xAxis","_NightingaleNavigation_viewport","_NightingaleNavigation_highlighted","_NightingaleNavigation_margins","_NightingaleNavigation_currentSelection","createNavRuler","limit","axisBottom","brushX","extent","HANDLE_SIZE","handleSize","selection","move","transform","extra","updateLabels","updatePolygon","createHighlight","updated","changedProperties","locate","zoomOut","zoomIn","newStart","s2","segment","highlighsRect","Boolean","formats","NightingaleSaver","elementId","fillColor","fileName","fileFormat","extraWidth","extraHeight","scaleFactor","preview","preSave","postSave","saveSvg","bind","getBoundingClientRect","scaledWidth","scaledHeight","canvas","className","getContext","fillStyle","fillRect","appendChild","rasterizeHTML","wrapHTML","outerHTML","zoom","then","image","toDataURL","replace","link","download","href","body","click","catch","err","finally","button","hasChildNodes","child","firstElementChild","tagName","_taggedTemplateLiteralLoose","_templateObject2","attribute","_NightingaleSequence_seq_bg","_NightingaleSequence_axis","_NightingaleSequence_bases","ticks","parseInt","getAttribute","numberOfTicks","isInteger","payload","updateScaleDomain","applyZoomTranslation","getCharSize","node","chWidth","getBBox","chHeight","tempNode","getHeightWithMargins","highlighted","space","half","ceil","xAxis","tickFormat","size","textElements","background","customElementOnce","_frequency","scalePow","exponent","drawVariationPlot","each","series","withVariants","elem","variants","bars","circle","variant","charAt","mutation","alternativeSequence","internalId","wildType","colorConfig","AminoAcid","Source","ClinicalSignificanceType","ConsequenceType","PredAlgorithmNameType","PredictionValType","SourceType","aaList","NightingaleVariation","NightingaleVariation_1","withSVGHighlight","proteinAPI","condensedView","_NightingaleVariation_data","_v","scalePoint","processData","transformedData","accession","genomicLocation","Empty","begin","xrefNames","xrefs","sourceType","ref","hasPredictions","predictions","protvistaFeatureId","consequenceType","getSourceType","transformData","processedData","aaPresence","mutationArray","normal","processVariants","createFeatures","css","variationPlot","VariationPlot","mainChart","chartArea","empty","axisLeft","axisRight","datum","updateScale","createHighlightGroup","aaToDisplay","rowHeight","yAxisLScale","tickSize","getWidthWithMargins","yAxisRScale","updateData","module","exports","s","o","u","f","code","l","_dereq_","peg$SyntaxError","message","expected","found","location","captureStackTrace","parent","ctor","peg$subclass","buildMessage","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","escapedParts","parts","classEscape","inverted","any","other","description","hex","ch","charCodeAt","descriptions","sort","describeExpected","describeFound","SyntaxError","parse","input","peg$result","peg$FAILED","peg$startRuleFunctions","peg$parsestart","peg$startRuleFunction","peg$c0","peg$c1","peg$c2","peg$c3","peg$literalExpectation","peg$c4","xs","concat","peg$c5","entry","peg$c6","url","format","peg$c7","peg$c8","peg$c9","peg$c10","peg$c11","peg$c12","peg$c13","peg$c14","peg$c15","peg$c16","peg$c17","local","peg$c18","peg$c19","peg$classExpectation","peg$c20","chars","util","extractValue","peg$c21","peg$c22","peg$currPos","peg$posDetailsCache","column","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","startRule","ignoreCase","peg$computePosDetails","details","peg$computeLocation","startPos","endPos","startPosDetails","endPosDetails","peg$fail","peg$parsesourceEntries","s3","s4","s5","peg$parsesourceEntry","peg$parsewhitespace","peg$parseurl","substr","peg$parsevalue","peg$parseformat","peg$parseurlEntry","peg$parselocalEntry","grammar","fontFaceSourceValue","serialize","parsedFontFaceSources","sourceItem","itemValue","quotedUrl","trimCSSWhitespace","singleQuoteRegex","doubleQuoteRegex","cssSupport","extractCssUrl","cssUrl","urlRegex","exec","unquoteString","backgroundValue","backgroundDeclarationText","outerRepeatedMatch","valueRegexS","simpleSingularBackgroundRegexS","simpleBackgroundRegexS","simpleSingularBackgroundRegex","RegExp","backgroundLayers","getValues","singularBackgroundDeclaration","repeatedMatch","valueRegex","backgroundValues","match","sliceBackgroundDeclaration","backgroundLayerValues","urlMatch","idx","findBackgroundImageUrlInValues","preUrl","postUrl","parsedBackground","backgroundLayer","rulesForCssText","styleContent","rules","doc","implementation","createHTMLDocument","styleElement","textContent","sheet","cssRules","cssRulesToText","reduce","cssText","rule","exchangeRule","newRuleText","ruleIdx","changeFontFaceRuleSrc","newSrc","getPropertyValue","inlineImage","inlineScript","inlineCss","parameterHashFunction","params","param","baseUrl","joinUrl","JSON","stringify","memoizeFunctionOnCaching","func","cache","cacheBucket","memoize","requestExternalsForStylesheet","alreadyLoadedCssUrls","loadCSSImportsForRules","cssImportResult","loadAndInlineCSSResourcesForRules","cssResourcesResult","errors","hasChanges","content","loadAndInlineStyles","inlineOptions","styles","getElementsByTagName","getCssStyleElements","allErrors","clone","getDocumentBaseUrl","Promise","all","processExternals","result","childNodes","nodeValue","cloneArray","loadAndInlineCssForStyle","requestStylesheetAndInlineResources","ajax","hasChangesFromPathAdjustment","adjustPathsOfCssResources","loadAndInlineCssLinks","links","rel","getCssStylesheetLinks","cssHref","documentBaseUrl","ownerDocument","ajaxOptions","processStylesheet","loadLinkedCSS","oldLinkNode","styleNode","parentNode","createTextNode","insertBefore","removeChild","resourceType","msg","loadAndInlineImages","inline","loadAndInlineScript","inlineReferences","inlineFuncs","inlineScripts","backgroundValueParser","fontFaceSrcValueParser","updateCssPropertyValue","setProperty","getPropertyPriority","findBackgroundImageRules","window","CSSRule","STYLE_RULE","findBackgroundDeclarations","backgroundDeclarations","findFontFaceRules","FONT_FACE_RULE","findCSSImportRules","IMPORT_RULE","findExternalBackgroundUrls","matchIndices","isDataUri","findExternalFontFaceUrls","sourceIndices","backgroundRules","change","declaration","externalBackgroundIndices","backgroundLayerIndex","relativeUrl","externalFontFaceUrlIndices","fontFaceSrcDeclaration","fontFaceUrlIndex","substituteRule","newCssRules","splice","newRule","rulesToInline","cssHrefRelativeToDoc","resolve","externalCssRules","loadAndInlineCSSImport","moreErrors","iterateOverRulesAndInlineBackgroundImages","cssHasChanges","externalBackgroundLayerIndices","collectAndReportErrors","getDataURIForImageURL","dataURI","loadAndInlineBackgroundImages","iterateOverRulesAndInlineFontFace","srcDeclarationValue","urlIndex","fontSrc","binaryAjax","base64Content","btoa","loadAndInlineFontFace","toArray","arrayLike","inputs","images","svgImages","imageInputs","externalImages","hasAttribute","hasAttributeNS","getAttributeNS","filterExternalImages","documentBase","encodeImageAsDataURI","src","scripts","script","getScripts","loadLinkedScript","jsCode","scriptNode","removeNamedItem","substituteExternalScriptWithInline","baseURI","object","theClone","hasOwnProperty","nodeList","apply","relUrl","promises","promise","lastCacheDate","reject","augmentedUrl","ajaxRequest","XMLHttpRequest","joinedUrl","doReject","Date","now","getUncachableURL","status","response","open","overrideMimeType","mimeType","send","binaryContent","fromCharCode","startsWith","string","detectMimeType","uniqueIdList","hasher","memo","retValue","args","argumentHash","funcHash","root","a0","b1","c2","d3","xmlserializer","sanedomparsererror","inlineresources","getConstantUniqueIdFor","parseOptionalParameters","parameters","isObject","proxies","monkeyPatchInstanceMethod","methodName","proxyFunc","originalFunc","baseUrlRespectingXhr","XHRObject","xhr","originalOpen","method","shift","finishNotifyingXhr","checkAllRequestsFinished","totalXhrCount","doneXhrCount","waitingForPendingToClose","totalCount","xhrConstructor","originalSend","waitForRequestsToFinish","documentUtil","asArray","addClassName","addClassNameRecursively","updateRuleSelector","updatedSelector","styleDefinitions","styleSheet","parentStyleSheet","insertRule","deleteRule","changeCssRule","rewriteStyleContent","replaceSimpleSelectorsBy","simpleSelectorList","caseInsensitiveReplaceFunc","selectorRegex","matchingSimpleSelectorsRegex","querySelectorAll","svgStyleElement","cssStyleElement","matchingRules","selectorText","newSelector","prefixMatch","selectorMatch","rewriteCssSelectorWith","oldSelector","lowercaseCssTypeSelectors","matchingTagNames","toLowerCase","findHtmlOnlyNodeNames","currentTagName","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","htmlNodeNames","nonHtmlNodeNames","currentNode","namespaceURI","nextNode","documentHelper","cascadingAction","active","hover","focus","fakeUserAction","selector","action","pseudoClass","fakeActionClass","persistInputValues","textareas","isCheckable","checked","textarea","rewriteTagNameSelectorsToLowerCase","browser","theWindow","executeJavascript","iframe","visibility","top","left","createHiddenElement","iframeErrorsMessages","executeJsTimeout","cleanUp","doResolve","contentDocument","contentWindow","finishNotifyXhrProxy","baseUrlXhrProxy","onload","timeout","setTimeout","onerror","write","close","calculateContentSize","rootElement","requestedWidth","requestedHeight","originalWidth","originalHeight","rootFontSize","rect","contentSize","actualViewportWidth","scrollWidth","clientWidth","actualViewportHeight","scrollHeight","clientHeight","descendant","selectElementOrDescendant","actualViewport","calculateZoomedContentSizeAndRoundUp","getComputedStyle","documentElement","fontSize","viewportWidth","viewportHeight","calculateDocumentContentSize","scaledViewportWidth","scaledViewportHeight","borderWidth","sandbox","scrolling","createHiddenSandboxedIFrame","createIframeWithSizeAtZoomLevel1","documentClone","findCorrelatingElement","clip","elementToFullHtmlDocument","parseHtmlFragment","htmlFragment","innerHTML","firstChild","parseHTML","htmlTagSubstitute","elementSubstitute","attributeMatch","helperDoc","addHTMLTagAttributes","failOnInvalidSource","failOnParseError","originalError","validateXHTML","xhtml","DOMParser","parseFromString","doDocumentLoad","responseXML","statusText","responseType","loadDocument","svg2image","checkForBlobsResult","urlForSvg","useBlobs","URL","createObjectURL","Blob","encodeURIComponent","cleanUpUrl","revokeObjectURL","simpleForeignObjectSvg","supportsReadingObjectFromCanvas","Image","drawImage","checkBlobSupport","blobUrl","supportsBlobBuilding","supportsReadingFromBlobs","doesBenefit","buildImageUrl","renderSvg","imageUrl","document2svg","serializeAttributes","convertElementToSvg","zoomFactor","serializeToString","foreignObjectAttrs","closestScaledWith","closestScaledHeight","foreignObjectAttributes","externalResourcesRequired","workAroundSafariSometimesNotShowingExternalResources","svgAttributes","getSvgForDocument","drawDocumentAsSvg","rasterize","generalDrawError","drawSvgAsImg","doDraw","drawImageOnCanvas","executeJs","operateJavaScriptOnDocument","drawResult","drawDocument","optionalArguments","viewport","fallbackWidth","fallbackHeight","getViewportSize","constructOptions","drawHTML","drawURL","workaround","replaceChild","extendedOptions","workAroundFirefoxNotLoadingStylesheetStyles","errorMessagePatterns","errorMessage","parseError","nodeName","getParseError","errorNode","XMLSerializer","extractParseError","getTagName","serializeChildren","childNode","nodeTreeToXHTML","serializeTag","isRootNode","attrs","serializeNamespace","serializeAttributeValue","serializeAttribute","rootNode","serializeText","serializeComment","serializeCDATA","$","IS_PURE","NativePromiseConstructor","fails","getBuiltIn","isCallable","speciesConstructor","promiseResolve","defineBuiltIn","NativePromisePrototype","proto","real","forced","onFinally","C","isFunction","unsafe","reHasUnicode","rsAstralRange","rsAstral","rsCombo","rsFitz","rsNonAstral","rsRegional","rsSurrPair","reOptMod","rsModifier","rsOptVar","rsSeq","rsSymbol","reUnicode","hasUnicode","unicodeToArray","asciiToArray","strSymbols","stringToArray","chr","trailing","baseSlice","upperFirst","right","bottom","epsilon","translateX","translateY","center","bandwidth","entering","__axis","axis","orient","tickArguments","tickValues","tickSizeInner","tickSizeOuter","tickPadding","devicePixelRatio","spacing","range0","range1","copy","tick","order","tickExit","tickEnter","insert","transition","isFinite","pi","PI","tau","tauEpsilon","strings","Path","_append","appendRound","quadraticCurveTo","arcTo","x21","y21","x01","y01","l01_2","x20","y20","l21_2","l20_2","l21","sqrt","l01","tan","acos","t01","t21","arc","a1","ccw","cos","dy","sin","cw","da","w","radians","degrees","A","B","D","E","ED","EB","BC_DA","opacity","Cubehelix","g","atan2","cubehelixConvert","brighter","pow","darker","rgb","cosh","sinh","cubehelix","hue","cubehelixGamma","gamma","cubehelixLong","c","ts"],"sourceRoot":""}