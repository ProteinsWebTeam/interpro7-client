"use strict";(self.webpackChunkinterpro7_client=self.webpackChunkinterpro7_client||[]).push([[9439],{719:(e,t,n)=>{n.d(t,{ZP:()=>v}),n(28436),n(60429);var a=n(67294),r=n(45697),s=n.n(r),o=n(45007),i=n(19119),l=n(64350),c=n(27448),u=n(3509),m=["children","loading","noAnimation","duration","lowGraphics","className","dispatch","abbr","noTitle","title","titleType","label","scaleMargin"];function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}var d=(0,u.D)({label:"NumberComponent_style__label___b2",loading:"NumberComponent_style__loading___e0",pulsing:"NumberComponent_style__pulsing___ae",lowGraphics:"NumberComponent_style__lowGraphics___d4"});class f extends a.PureComponent{constructor(e){var t;super(e),t=this,this._animate=function(e,n){if(void 0===n&&(n=0),t._animation&&t._animation.stop(),t._ref.current){var a=(0,c.Z)(e,t.props.abbr,t.props.scaleMargin);t.props.noTitle||t.props.title||!a||null===t._ref.current||(t._ref.current.title=("Approximately "+a+" "+(t.props.titleType||"")).trim()),!t.props.noAnimation&&!t.props.lowGraphics&&n!==e&&Number.isFinite(n)&&Number.isFinite(e)?(t._animation=new l.Tweenable,t._animation.tween({from:{value:n},to:{value:e},easing:"easeOutQuart",render:e=>{var{value:n}=e;t._ref.current&&(t._ref.current.textContent=""+((0,c.Z)(n,t.props.abbr,t.props.scaleMargin)||""))}})):t._ref.current&&(t._ref.current.textContent=""+(a||""))}},this._ref=a.createRef()}componentDidMount(){this._animate(this.props.children)}componentDidUpdate(e){var{children:t}=e;this._animate(this.props.children,t)}componentWillUnmount(){this._animation&&(this._animation.stop(),this._animation.dispose(),this._animation=null)}render(){var e=this.props,{loading:t,lowGraphics:n,className:r,label:s}=e,o=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,m);return a.createElement("span",p({className:d(r,{loading:t,lowGraphics:n,label:s}),ref:this._ref},o))}}f.propTypes={children:s().oneOfType([s().number,s().string]),loading:s().bool,noAnimation:s().bool,duration:s().number,className:s().string,lowGraphics:s().bool.isRequired,dispatch:s().func.isRequired,abbr:s().bool,label:s().bool,scaleMargin:s().number,noTitle:s().bool,title:s().oneOfType([s().string,s().number]),titleType:s().string},f.defaultProps={duration:1,abbr:!1,scaleMargin:1};var h=(0,i.P1)((e=>e.settings.ui.lowGraphics),(e=>({lowGraphics:e})));const v=(0,o.$j)(h)(f)},27448:(e,t,n)=>{n.d(t,{Z:()=>r});var a=["","k","M","G"];const r=(e,t,n)=>{if(e||0===e){var r=Math.round(+e);return isNaN(r)?"N/A":(Number.isFinite(r)&&(t?r=function(e,t){void 0===t&&(t=1);for(var n=e,r=0;n>=1e3*t;)r++,n=Math.round(n/1e3);return""+n.toLocaleString()+a[r]}(r,n):Number.isFinite(r)&&(r=r.toLocaleString())),r)}}},9033:(e,t,n)=>{n.d(t,{Em:()=>v,F6:()=>y,GC:()=>p,Gr:()=>f,Me:()=>h,UF:()=>u,g$:()=>m,ie:()=>d}),n(64043),n(57267),n(86544),n(61514),n(60429),n(76801),n(752),n(76265),n(22462);var a=n(19119),r=n(8575),s=n(10838),o=n(52727),i=n(24644),l=/([^:])\/{2,}/g,c=["pfam","cdd","pirsf"],u=function(e){return void 0===e&&(e=""),e.replace(l,"$1/")},m=(0,a.P1)((e=>e.settings.api),(e=>{var{protocol:t,hostname:n,port:a,root:s}=e;return u((0,r.format)({protocol:t,hostname:n,port:a,pathname:""+s}))})),p=e=>(0,a.P1)((()=>o.default.github[e]),(e=>{var{owner:t,repo:n}=e;return"https://api.github.com/repos/"+t+"/"+n+"/releases/latest"})),d=e=>(0,a.P1)((()=>o.default.github.ReadTheDocs),(t=>{var{owner:n,repo:a,branch:r="master"}=t;return"https://raw.githubusercontent.com/"+n+"/"+a+"/"+r+"/docs/"+e})),f=(0,a.P1)((e=>e),(e=>(0,a.P1)((t=>t.settings[e]),(e=>e.settings.navigation.pageSize),(e=>e.customLocation.description),(e=>e.customLocation.search),(e=>e.customLocation.hash),((e,t,n,a,o)=>{var{protocol:i,hostname:l,port:m,root:p}=e,d=n.main.key&&n[n.main.key].accession?{}:Object.assign({},a||{});if((!n[n.main.key].accession||Object.values(n).find((e=>{var{isFilter:t,db:n}=e;return t&&n}))||n.entry&&n.entry.memberDB)&&(d.page_size=d.page_size||t),"grid"===o)switch(n.main.key){case"entry":d.extra_fields="short_name,description,literature,counters:protein-ida-taxonomy-structure",c.includes(n.entry.db)&&(d.extra_fields+="-set");break;case"protein":d.extra_fields="counters:entry-structure";break;case"structure":d.extra_fields="counters:entry-protein-taxonomy";break;case"taxonomy":d.extra_fields="lineage,counters:entry-protein-structure-proteome";break;case"proteome":d.extra_fields="counters:entry-protein-structure";break;case"set":d.extra_fields="counters,description";break;default:d.extra_fields=void 0}if("table"===o)switch(n.main.key){case"entry":d.extra_fields="short_name";break;case"taxonomy":case"proteome":d.extra_fields="counters:entry-protein";break;case"set":d.extra_fields="counters:entry,description"}"tree"===o&&void 0!==d.search&&delete d.search;var f=n.main.key&&n[n.main.key].accession?{main:n.main,[n.main.key]:n[n.main.key]}:n,h=d.cursor;h&&delete d.cursor;var v=u((0,r.format)({protocol:i,hostname:l,port:m,pathname:p+(0,s.Z)(f),query:d}));if(h){var y=-1===v.indexOf("?")?"?":"&";return""+v+y+"cursor="+h}return v})))),h=(0,a.P1)((e=>e.settings.api),(e=>e.settings.navigation.pageSize),(e=>e.customLocation.description),(e=>e.customLocation.search),(e=>e.customLocation.hash),((e,t,n,a,o)=>{var l,{protocol:c,hostname:u,port:m,root:p}=e,d={},f=Object.assign({},a);for(var[h,v]of("tree"===o&&void 0!==f.search&&delete f.search,void 0!==f.model_page&&delete f.model_page,Object.entries(n)))d[h]="other"===h?[...v]:Object.assign({},v),v.isFilter&&1===v.order&&(l=h,d[h].isFilter=!1);d[n.main.key].isFilter=!0,d.main.key=l;var y=Object.assign({},f,{extra_fields:void 0,page_size:a.page_size||t});"entry"===l&&(y.extra_fields="short_name");var g=(0,i.e)(n.main.key,l);g&&(y.extra_fields?y.extra_fields+=","+g:y.extra_fields=g);var _=(0,r.format)({protocol:c,hostname:u,port:m,pathname:p+(0,s.Z)(d),query:y});return"entry"===n.main.key&&"taxonomy"===l&&(_=_.replace("/entry/","/protein/entry/")),"taxonomy"===n.main.key&&"proteome"===l&&(_=_.replace("/taxonomy/","/protein/taxonomy/")),_})),v=(e,t)=>t&&1!=+t&&!e.match(/taxonomy\/uniprot\/\d+/gi)?e.replace(/taxonomy\/uniprot\//,"/taxonomy/uniprot/"+t+"/"):e,y=function(){return f("api")(...arguments).replace("/entry_alignments","/").replace("/logo","/").replace("/alphafold","/").replace("/domain_architecture","/").replace("/interactions","/").replace("/subfamilies","/").replace("/pathways","/").replace("/feedback","/").replace("/sequence","/").replace("/similar_proteins","/").replace("/curation","/").replace(/\/set\/[a-zA-Z0-9]+\/entry\/([a-zA-Z0-9]+)\//,"/set/$1/")}},19963:(e,t,n)=>{n.d(t,{Z:()=>a});const a=e=>t=>(t.preventDefault(),t.stopPropagation(),e(t))},43100:(e,t,n)=>{n.d(t,{rL:()=>f,ZP:()=>y}),n(752),n(76265);var a=n(67294),r=n(45007),s=n(29643),o=n(719),i=n(65455),l=n(3817),c=n(87616),u=n(18890),m=n(19963),p=n(63139),d=(0,n(76371).Z)({container:"Controls_style__container___fc",text:"Controls_style__text___d9",button:"Controls_style__button___e1","new-callout":"Controls_style__new-callout___fb",warning:"Controls_style__warning___ab"}),f=5e4,h=1e4;class v extends a.PureComponent{constructor(){super(...arguments),this._handleGenerateClick=(0,m.Z)((()=>{var e,t;(0,u.t)(),null===(t=(e=this.props).downloadURL)||void 0===t||t.call(e,this.props.url,this.props.fileType,this.props.subset,this.props.entityType)})),this._handleCancelClick=(0,m.Z)((()=>{var e,t;return null===(t=(e=this.props).downloadDelete)||void 0===t?void 0:t.call(e,this.props.url,this.props.fileType,this.props.subset)}))}render(){var{fileType:e,entityType:t,download:n,count:r,noData:c,isStale:u,interProVersion:m}=this.props;if(!n)return null;var{progress:v,successful:y,blobURL:g,version:_}=n,b=Number.isFinite(v)&&!y;return a.createElement(a.Fragment,null,r>h&&!u&&a.createElement(i.Z,{type:r>f?"alert":"warning"},"We expect this file to contain"," ",a.createElement(o.ZP,{abbr:!0},r)," distinct"," ",(0,p.iZ)(t),"."," ",r>f?"This file will be too large to generate within your browser":"If you encounter any problems during the creation of this file",", please check the “Code snippet” section of this page for to see how to download the data directly onto your computer."),r<f?a.createElement("div",{className:d("text")},"Please generate the file in order to download it."):null,m>_&&a.createElement(i.Z,{type:"alert"},a.createElement("h5",null,"The existing download is outdated."),a.createElement("p",null,"It was obtained using InterPro version ",a.createElement("i",null,_),", while the current version is ",a.createElement("i",null,m),". You need to remove the existing file before re-generating the download."),a.createElement("p",null,a.createElement(s.Z,{className:d("button","hollow"),onClick:this._handleCancelClick},"Remove the current download"))),a.createElement("div",{className:d("container")},a.createElement(l.z,{onClick:this._handleGenerateClick,disabled:!!v||r>f||u||c,backgroundColor:r>h?"white":void 0,borderColor:r>h?"orange":void 0,textColor:r>h?"orange":void 0},"Generate"),a.createElement(s.Z,{className:d({warning:r>=h}),buttonType:"primary",disabled:!y||r>f,href:g,download:"export."+("accession"===e?"txt":e)},"Download"),b&&a.createElement(l.z,{type:"tertiary",onClick:this._handleCancelClick},"Cancel")))}}const y=(0,r.$j)(void 0,{downloadURL:c.UR,downloadDelete:c.oT})(v)},14240:(e,t,n)=>{n.r(t),n.d(t,{DownloadForm:()=>Pe,default:()=>Se}),n(752),n(73964),n(76265),n(64043),n(57267),n(38320),n(76801),n(86544),n(61514),n(85415),n(60429),n(54564),n(90385),n(9873),n(268);var a=n(67294),r=n(19119),s=n(8575),o=n(32424),i=n(34287),l=n(21105),c=n(9033),u=n(63294),m=n(87616),p=n(3817),d=(n(65137),n(76853)),f=n(63139),h=e=>e,v=n(76371),y=n(82806),g=(0,v.Z)({"new-input-group":"InputGroup_style__new-input-group___b6","new-input-group-button":"InputGroup_style__new-input-group-button___a0","new-input-group-label":"InputGroup_style__new-input-group-label___f0"},y.Z);const _=e=>{var{label:t,input:n,button:r}=e;return a.createElement("label",{className:g("new-input-group")},a.createElement("span",{className:g("new-input-group-label")},t),n,a.createElement("div",{className:g("new-input-group-button")},r))};var b=(0,v.Z)(),E=new Set(["all","integrated","unintegrated"]),w=function(e){var{selector:t=h,descending:n=!1}=void 0===e?{}:e;return(e,a)=>{var r=t(e),s=t(a);return r>s?n?-1:1:r<s?n?1:-1:0}}({selector:e=>e[0]}),x=function e(t,n,r){return void 0===n&&(n=!1),Object.entries(t).filter((e=>{var[t]=e;return E.has(t)===n})).sort(w).map((t=>{var[s,o]=t;return"object"!=typeof o?a.createElement("option",{key:s,value:s.toLowerCase()},r&&r[s]?r[s].name:s.charAt(0).toUpperCase()+s.slice(1)):a.createElement("optgroup",{key:s,label:s.replace("_"," ")},e(o,n,r))}))},T=e=>{var{type:t,data:n,onClick:r,isIntegration:s=!1,name:o,value:i,valueIntegration:l,databases:c}=e;if(!n)return null;var u,{loading:m,payload:h}=n,v=o,y=i;return"entry"===t&&"interpro"!==y&&(s?(v=o.replace(".db",".integration"),y=l):u=a.createElement(T,Object.assign({},e,{isIntegration:!0}))),a.createElement(a.Fragment,null,a.createElement(_,{label:a.createElement(a.Fragment,null,t," ",s?"integration":"DB",":"),input:a.createElement(a.Fragment,null,!m&&h?a.createElement("select",{className:b("input-group-field"),name:v,value:y,onChange:d.Z,onBlur:d.Z},a.createElement("option",{value:""},"< no selection >"),x(h[(0,f.iZ)(t)],s,c)):a.createElement("input",{type:"hidden",name:v,value:y})),button:a.createElement(p.z,{"data-key":v,onClick:r},"Clear")}),u)},$=(0,r.P1)((e=>e.settings.api),((e,t)=>t.type),((e,t)=>{var{protocol:n,hostname:a,port:r,root:o}=e;return(0,c.UF)((0,s.format)({protocol:n,hostname:a,port:r,pathname:o+"/"+t}))}));const j=(0,i.Z)($)(T);var P=n(29643);const C=e=>{var{url:t}=e;return a.createElement("section",null,a.createElement("h6",null,"Corresponding API call"),a.createElement("p",null,a.createElement(P.Z,{href:t,target:"_blank"},a.createElement("code",null,t))))};var S=n(719),O={accession:"Text (List of Accessions)",fasta:"FASTA",json:"JSON",tsv:"TSV"};const A=e=>{var{fileType:t,mainEndpoint:n,hasSelectedDB:r,hasSelectedAccession:s}=e;return a.createElement("select",{name:"fileType",value:t||"accession","aria-label":"Download type",onChange:d.Z,onBlur:d.Z},a.createElement("option",{value:"accession",disabled:!r||s},O.accession),a.createElement("option",{value:"fasta",disabled:"protein"!==n},O.fasta),a.createElement("option",{value:"json"},O.json),a.createElement("option",{value:"tsv",disabled:!r||s},O.tsv))};const k=e=>{var t,n,r,{fileType:s,description:o,subset:i,isStale:l,count:c,noData:u}=e,m=(e=>Object.entries(e).filter((e=>{var[,t]=e;return t.isFilter})).map(((e,t,n)=>{var[r,s]=e,{length:o}=n;return a.createElement(a.Fragment,{key:r},t>0&&o>2&&", ",t===o-1&&t>0&&" and ",((e,t)=>{if(!t)return null;var{db:n,integration:r,accession:s}=t;return s?a.createElement(a.Fragment,null,"the ",a.createElement("b",null,n)," ",a.createElement("b",null,"taxonomy"===e?"taxon":e)," with accession ",a.createElement("b",null,s)):n&&r?a.createElement(a.Fragment,null,"any of the"," ","all"!==r&&a.createElement(a.Fragment,null,a.createElement("b",null,r)," "),a.createElement("b",null,n)," ",a.createElement("b",null,(0,f.iZ)(e))):n||r&&"all"!==r?a.createElement(a.Fragment,null,"any ",a.createElement("b",null,n||r)," ",a.createElement("b",null,(0,f.iZ)(e))):a.createElement(a.Fragment,null,"any ",a.createElement("b",null,"taxonomy"===e?"taxon":e))})(r,s))})))(o),p="";return m.length&&(p=a.createElement(a.Fragment,null," which match with ",m)),l?r=a.createElement("p",null,"Preparing data..."):u?r=a.createElement("p",null,"No data matches the selected set of filters"):(r=a.createElement("p",null,"This ",a.createElement("b",null,O[s||"accession"])," file will contain"," ",((e,t)=>{var n,r=null===(n=e.main)||void 0===n?void 0:n.key;if(!r)return null;var{db:s,integration:o,accession:i}=e[r];return i?a.createElement(a.Fragment,null,a.createElement("b",null,"metadata")," about ",a.createElement("b",null,s)," ",a.createElement("b",null,r)," with accession"," ",a.createElement("b",null,i)):s&&o?a.createElement(a.Fragment,null,a.createElement("b",null,"a list")," of approximately"," ",a.createElement(S.ZP,{abbr:!0},t)," ","all"!==o&&a.createElement(a.Fragment,null,a.createElement("b",null,o)," "),a.createElement("b",null,s)," ",a.createElement("b",null,(0,f.iZ)(r))):s||o?a.createElement(a.Fragment,null,a.createElement("b",null,"a list")," of approximately"," ",a.createElement(S.ZP,{abbr:!0},t)," ",a.createElement("b",null,s||o)," ",a.createElement("b",null,(0,f.iZ)(r))):a.createElement(a.Fragment,null,a.createElement("b",null,"a list of counts")," of ",a.createElement("b",null,(0,f.iZ)(r))," from each data source in InterPro")})(o,c)," ",p,"."),"fasta"===s&&(null===(t=null==o?void 0:o.entry)||void 0===t?void 0:t.isFilter)&&(null===(n=null==o?void 0:o.entry)||void 0===n?void 0:n.accession)&&(d.Z,d.Z)),a.createElement("section",null,a.createElement("h6",null,"Explanation"),r)};var N=(0,r.P1)((e=>e.download),((e,t)=>{var{url:n,fileType:a,subset:r}=t;return{url:n,fileType:a,subset:r}}),((e,t)=>{var{url:n,fileType:a,subset:r}=t;return{download:e[[n,a,r&&"subset"].filter(Boolean).join("|")]||{}}}));const I=(0,i.Z)({getUrl:(e,t)=>{var{url:n}=t;return n},mapStateToProps:N})((e=>{var{children:t,data:n,download:a,isStale:r}=e;return t({data:n,download:a,isStale:r})}));var D=n(47941);const L=e=>{var{data:t,isStale:n}=e;return t?a.createElement("section",null,a.createElement("h6",null,"Estimate"),((e,t)=>{var{loading:n,payload:r,ok:s,status:o,headers:i}=e;if(n||t)return"Calculating estimate…";if(!s)return"There was an error whilst fetching data.";if(204===o)return"No data associated with this query.";if(!r)return"An unexpected error was encountered.";var l=r.count;if(l)return a.createElement(a.Fragment,null,"Your file will contain ",a.createElement(S.ZP,{abbr:!0},l)," ","item",l>1?"s":"",".");var c=+((null==i?void 0:i.get("content-length"))||0);if(c||(c=JSON.stringify(r,null,2).length),c&&Number.isFinite(c)){var[u,m]=(0,D.G)(c,{round:0,standard:"iec",output:"array"});return a.createElement(a.Fragment,null,"Your file size will be ",a.createElement(S.ZP,null,u)," ",m)}return"No estimate available."})(t,!!n)):null};n(78730),n(79307);var R=n(45007),Z=n(77017),F=n(42152),G=n.n(F),U=n(38538),q=n(19657),z=n(98331),M=n(50610),H=n(3454),B=n(65455),V=n(19963);const W={controls:"DownloadForm_style__controls___b4","input-group-field":"DownloadForm_style__input-group-field___bf","download-form":"DownloadForm_style__download-form___db","button-group":"DownloadForm_style__button-group___e5","invalid-accession":"DownloadForm_style__invalid-accession___cf"};var Y=n(45913),J=n(35395),X=(0,v.Z)(W,y.Z,Y.Z,J.Z);U.Z.registerLanguage("javascript",z.Z),U.Z.registerLanguage("python",q.Z),U.Z.registerLanguage("perl",M.Z);var K={interpolate:/<%=([\s\S]+?)%>/g},Q=new Map([["py",{template:(0,Z.Z)('#!/usr/bin/env python3\n\n# standard library modules\nimport sys, errno, re, json, ssl\nfrom urllib import request\nfrom urllib.error import HTTPError\nfrom time import sleep\n\nBASE_URL = "<%= url %><%= url.indexOf(\'?\')===-1 ? \'?\' : \'&\' %>page_size=200<%= fileType === \'fasta\' ? \'&extra_fields=sequence\' : \'\' %>"\n<% if (fileType === "tsv" && columns.some(x => x.indexOf("extra_fields.counters")>=0)) { \n%>BASE_URL += "&extra_fields=counters"<% \n}\nif (fileType === \'fasta\') { %>\nHEADER_SEPARATOR = "|"\nLINE_LENGTH = 80\n<% }\n\nif (fileType === "tsv") { %>\n\ndef parse_items(items):\n  if type(items)==list:\n    return ",".join(items)\n  return ""\ndef parse_member_databases(dbs):\n  if type(dbs)==dict:\n    return ";".join([f"{db}:{\',\'.join(dbs[db])}" for db in dbs.keys()])\n  return ""\ndef parse_go_terms(gos):\n  if type(gos)==list:\n    return ",".join([go["identifier"] for go in gos])\n  return ""\ndef parse_locations(locations):\n  if type(locations)==list:\n    return ",".join(\n      [",".join([f"{fragment[\'start\']}..{fragment[\'end\']}" \n                for fragment in location["fragments"]\n                ])\n      for location in locations\n      ])\n  return ""\ndef parse_group_column(values, selector):\n  return ",".join([parse_column(value, selector) for value in values])\n\ndef parse_column(value, selector):\n  if value is None:\n    return ""\n  elif "member_databases" in selector:\n    return parse_member_databases(value)\n  elif "go_terms" in selector: \n    return parse_go_terms(value)\n  elif "children" in selector: \n    return parse_items(value)\n  elif "locations" in selector:\n    return parse_locations(value)\n  return str(value)\n<% } %>\n\ndef output_list():\n  #disable SSL verification to avoid config issues\n  context = ssl._create_unverified_context()\n\n  next = BASE_URL\n  last_page = False\n\n  <% if (fileType === "json") { %>\n  #json header\n  sys.stdout.write("{ \\"results\\": [\\n")\n  <% } %>\n  attempts = 0\n  while next:\n    try:\n      req = request.Request(next, headers={"Accept": "application/json"})\n      res = request.urlopen(req, context=context)\n      # If the API times out due a long running query\n      if res.status == 408:\n        # wait just over a minute\n        sleep(61)\n        # then continue this loop with the same URL\n        continue\n      elif res.status == 204:\n        #no data so leave loop\n        break\n      payload = json.loads(res.read().decode())\n      next = payload["next"]\n      attempts = 0\n      if not next:\n        last_page = True\n    except HTTPError as e:\n      if e.code == 408:\n        sleep(61)\n        continue\n      else:\n        # If there is a different HTTP error, it wil re-try 3 times before failing\n        if attempts < 3:\n          attempts += 1\n          sleep(61)\n          continue\n        else:\n          sys.stderr.write("LAST URL: " + next)\n          raise e\n\n    for i, item in enumerate(payload["results"]):\n      <% if (fileType === "json") { %>\n      sys.stdout.write(json.dumps(item))\n      # for indented output replace the above line with the following\n      # sys.stdout.write(json.dumps(item, indent=4))\n      # for 1 record per line uncomment the following line\n      # sys.stdout.write("\\n")\n\n      if last_page and i+1 == len(payload["results"]):\n        sys.stdout.write("")\n      else:\n        sys.stdout.write(",\\n")\n      <% } else if (fileType === "tsv") { \n           for (column of columns) {\n             if (column.indexOf("[*]") !== -1) {\n               %>sys.stdout.write(parse_group_column(<%= path2code(column, "item") %>, \'<%= column %>\') + "\\t")\n      <% \n             } else {\n               %>sys.stdout.write(parse_column(<%= path2code(column, "item") %>, \'<%= column %>\') + "\\t")\n      <%     } \n           }%>sys.stdout.write("\\n")\n      <% } else if (fileType === "fasta") { %>\n      entries = None\n      elif ("entries" in item):\n        entries = item["entries"]\n      \n      if entries is not None:\n        entries_header = "-".join(\n          [entry["accession"] + "(" + ";".join(\n            [\n              ",".join(\n                [ str(fragment["start"]) + "..." + str(fragment["end"]) \n                  for fragment in locations["fragments"]]\n              ) for locations in entry["entry_protein_locations"]\n            ]\n          ) + ")" for entry in entries]\n        )\n        sys.stdout.write(">" + item["metadata"]["accession"] + HEADER_SEPARATOR\n                          + entries_header + HEADER_SEPARATOR\n                          + item["metadata"]["name"] + "\\n")\n      else:\n        sys.stdout.write(">" + item["metadata"]["accession"] + HEADER_SEPARATOR + item["metadata"]["name"] + "\\n")\n\n      seq = item["extra_fields"]["sequence"]\n      fastaSeqFragments = [seq[0+i:LINE_LENGTH+i] for i in range(0, len(seq), LINE_LENGTH)]\n      for fastaSeqFragment in fastaSeqFragments:\n        sys.stdout.write(fastaSeqFragment + "\\n")\n      <% } else { \n        %>sys.stdout.write(item["metadata"]["accession"] + "\\n")<% \n      } %>\n    # Don\'t overload the server, give it time before asking for more\n    if next:\n      sleep(1)\n\n<% if (fileType === "json") { %>\n  #json footer\n  sys.stdout.write("\\n] }\\n")\n  <% } %>\n\n\nif __name__ == "__main__":\n  output_list()\n',K),type:"application/x-python",syntax:"python"}],["pl",{template:(0,Z.Z)('#!/usr/bin/env perl\n\nuse strict;\nuse warnings;\nuse LWP::UserAgent;\nuse JSON qw( encode_json decode_json );\nuse Data::Dumper;\n\n# Switching off SSL verification\n$ENV{\'PERL_LWP_SSL_VERIFY_HOSTNAME\'} = 0;\n\nmy $BASE_URL = "<%= url %><%= url.indexOf(\'?\')===-1 ? \'?\' : \'&\' %>page_size=200<%= fileType === \'fasta\' ? \'&extra_fields=sequence\' : \'\' %>";\n<% if (fileType === "tsv" && columns.some(x => x.indexOf("extra_fields.counters")>=0)) { %>\n  $BASE_URL .= "&extra_fields=counters"\n<% }  if (fileType === \'fasta\') { %>\n  my $HEADER_SEPARATOR = "|";\n  my $LINE_LENGTH = 80;\n<% } if (fileType === "tsv") { %>\n  sub parseItems {\n    my (@items) = @_;\n    my $tsvValue = "";\n    $tsvValue = join(",", @items) if (@items);\n    return $tsvValue;\n  }\n\n  sub parseMemberDatabases {\n    my ($dbs) = @_;\n    my $tsvValue = "";\n    foreach my $db (keys %{$dbs}) {\n      $tsvValue .= "$db:" . join(",", keys $dbs->{$db}) . ";";\n    }\n    $tsvValue =~ s/\\;$//; #remove terminal semi-colon\n    return $tsvValue;\n  }\n\n  sub parseGoTerms {\n    my ($terms) = @_;\n    my $tsvValue = "";\n    ($tsvValue = join ",", map {$_->{\'identifier\'}} @{$terms}) if (@{$terms});\n    return $tsvValue;\n  }\n\n  sub parseLocations {\n    my ($locations) = @_;\n    my $tsvValue = "";\n    my (@tsvValues);\n    foreach my $location (@{$locations}) {\n      push (@tsvValues,\n            join ",",\n            map {$_->{\'start\'}."..".$_->{\'end\'}}\n            @{$location->{\'fragments\'}});\n    }\n    $tsvValue = join ",", @tsvValues if (@tsvValues);\n    return $tsvValue;\n  }\n\n  sub parseGroupColumn {\n    my ($key, $values, $selector) = @_;\n    my @tsvValues;\n    foreach my $value (@{$values}) {\n      push(@tsvValues, parseColumn($value->{$key}, $selector));\n    }\n    my $tsvValue = "";\n    $tsvValue = join ",", @tsvValues if (@tsvValues);\n    return $tsvValue;\n  }\n\n  sub parseColumn {\n    my ($value, $selector) = @_;\n    unless ($value) {\n      return ""\n    }\n    if ($selector =~ /member_databases/ ) {\n      return parseMemberDatabases($value);\n    }\n    if ($selector =~ /go_terms/) {\n      return parseGoTerms($value);\n    }\n    if ($selector =~ /children/) {\n      return parseItems($value);\n    }\n    if ($selector =~ /locations/) {\n      return parseLocations($value);\n    }\n    return "$value";\n  }\n<% } %>\nsub main {\n  my $agent = LWP::UserAgent->new();\n\n  my $next = $BASE_URL;\n  my $last_page = 0;\n  <% if (fileType === "json") { %>\n  print "{ \\"results\\": [\\n";\n  <% } %>\n  while ($next) {\n    my $req = HTTP::Request->new(\n      GET => $next,\n      HTTP::Headers->new("Accept" => "application/json"),\n      ssl_opts =>  {\n        SSL_verify_mode => 0\n      }\n    );\n    my $res = $agent->request($req);\n    if ($res->code == 408) {\n      #wait just over a minute\n      sleep(61);\n      # then continue this loop with the same URL\n      next;\n    } elsif ($res->code == 204) {\n      #no data matching query\n      last;\n    }\n    my $payload = decode_json($res->content);\n    $next = $payload->{"next"};\n    unless (defined $next){\n      $last_page = 1;\n    }\n    my $results = $payload->{"results"};\n    for (my $i=0; $i < (@{$results}); $i++) {\n      my $item = $results->[$i];\n      <% if (fileType === "json") { %>\n      print encode_json($item);\n      unless ($last_page && $i+1 == (@{$results})){\n        print ",\\n";\n      }\n      <% } else if (fileType === "tsv") { %>\n      my $value;\n      <%\n          for (column of columns) {\n             if (column.indexOf("[*]") !== -1) {\n      %>\n      $value = parseGroupColumn(<%= path2perl(column, "$item") %>, \'<%= column %>\');\n      <% } else { %> \n      $value = parseColumn(<%= path2perl(column, "$item") %>, \'<%= column %>\');\n      <% } %>\n      print "$value\\t";\n      <% } %>\n        print "\\n";\n      <% } else if (fileType === "fasta") { %>\n      my $entries;\n      if (defined $item->{"entries"}){\n        $entries=$item->{"entries"};\n      }\n      if ($entries){\n        print ">$item->{metadata}->{accession}$HEADER_SEPARATOR";\n        my $DASH="";\n        foreach my $entry (@{$entries}) {\n          print "$DASH$entry->{accession}(";\n          my $SEMICOLON = "";\n          foreach my $locations  (@{$entry->{"entry_protein_locations"}}) {\n            print "$SEMICOLON";\n            my $COMMA = "";\n            foreach my $fragment (@{$locations->{"fragments"}}) {\n              my $start = $fragment->{"start"};\n              my $end = $fragment->{"end"};\n              print "$COMMA$start...$end";\n              $COMMA=",";\n            }\n            $SEMICOLON = ";";            \n          }\n          $DASH="-";\n          print ")";\n        }\n        print "$HEADER_SEPARATOR$item->{metadata}->{name}\\n";\n\n      } else {\n        print ">$item->{metadata}->{accession}$HEADER_SEPARATOR$item->{metadata}->{name}\\n";\n      }\n      my $seq =  $item->{"extra_fields"}{"sequence"};\n      foreach my $fastaSeqFragment (unpack("(A$LINE_LENGTH)*", $seq)) {\n        print "$fastaSeqFragment\\n";\n      }\n      <% } else { %>\n      print $item->{\'metadata\'}->{\'accession\'}."\\n";\n      <% } %>\n    }\n    if ($next) {\n      sleep(1);\n    }\n  }\n  <% if (fileType === "json") { %>\n  print "] }\\n";\n  <% } %>\n}\n\nmain();\n',K),type:"application/x-perl",syntax:"perl"}],["js",{template:(0,Z.Z)("#!/usr/bin/env node\n\n// external modules required: node-fetch, timing-functions\nconst fetch = require('node-fetch');\nconst sleep = require('timing-functions').sleep;\n\n<% if (fileType === 'fasta') { %>\nconst DESCRIPTION_SEPARATOR = '|';\nconst CHUNK_OF_TEXT_OF_EIGHTY_CHARACTERS = /(.{1,80})/g;\n\nconst processItem = function* ({\n  metadata: { accession, source_database, name, source_organism},<% if (subset) { %>\n  entries: [{ entry_protein_locations: matches }],<% } %>\n  extra_fields: { sequence },\n}) {<% if (subset) { %>\n  for (const [index, match] of matches.entries) {\n    // generate description line\n    yield `>${[\n      accession,\n      `match:${index + 1}/${matches.length}`\n      `subsequence:${match.fragments.map(({ start, end }) => `${start}-${end}`).join(';')}`\n      source_database,\n      name,\n      `taxID:${source_organism.taxId}`\n    ].join(DESCRIPTION_SEPARATOR)}}\\n`;\n    // generate sequence\n    yield match.fragments.map(\n      ({ start, end }) => sequence.substring(start - 1, end)\n    ).join('-').replace(CHUNK_OF_TEXT_OF_EIGHTY_CHARACTERS, '$1\\n');\n  }<% } else { %>\n  // generate description line\n  yield `>${\n    [accession, source_database, name, `taxID:${source_organism.taxId}`]\n      .join(DESCRIPTION_SEPARATOR)\n  }}\\n`;\n  // generate sequence\n  yield sequence.replace(CHUNK_OF_TEXT_OF_EIGHTY_CHARACTERS, '$1\\n');<% } %>\n};\n<% } else if (fileType === 'accession') { %>\nconst processItem = function* ({ metadata: { accession } }) {\n  yield `${accession}\\n`;\n};\n<% } else if (fileType === 'json' || fileType === 'ndjson') { %>\nconst processItem = function* (item) {\n  yield JSON.stringify(item);<% if (fileType === 'ndjson') { %>\n  yield '\\n';<% } %>\n<% } else if (fileType === 'tsv') { %>\nconst isObject = o => o instanceof Object && o.constructor === Object;\n\nconst parseItems = items => Array.isArray(items) ? items.join() : \"\";\n\nconst parseMemberDatabases = dbs => isObject(dbs)\n  ? Object.entries(dbs)\n      .map(([db,entries]) => `${db}:${Object.keys(entries).join()}`)\n      .join()\n  : \"\"\n\nconst parseGoTerms = gos => Array.isArray(gos) ? gos.map(go=>go.identifier).join() : \"\";\n\nconst parseLocations = locations =>\n  locations && Array.isArray(locations)\n    ? locations\n        .map(({ fragments }) =>\n          fragments.map(({ start, end }) => `${start}..${end}`).join(','),\n        )\n        .join(',')\n    : '';\n\nconst parseGroupColumn = (item, selector) => {\n  const [main, selectorInGoup] = selector.split(\"[*]\");\n  return item[main]\n    .map(\n      group => parseColumn(\n        group[selectorInGoup.slice(2,-2)],\n        selector,\n      )\n    ).join()\n\n}\nconst parseColumn = (value, selector) => {\n  if (value === null) \n    return \"\"\n  else if (selector.indexOf(\"member_databases\") !== -1)\n    return parseMemberDatabases(value);\n  else if (selector.indexOf(\"go_terms\") !== -1)\n    return parseGoTerms(value);\n  else if (selector.indexOf(\"children\") !== -1)\n    return parseItems(value);\n  else if (selector.indexOf(\"locations\") !== -1)\n    return parseLocations(value);\n  return \"\" + value;\n};\nconst processItem = function* (item) {\n  let row = \"\";\n  <% for (column of columns) {\n       if (column.indexOf(\"[*]\") !== -1) {\n       %>row += parseGroupColumn(item, '<%= column %>') + \"\\t\";\n  <%   } else {\n       %>row += parseColumn(<%= path2code(column, \"item\") %>, '<%= column %>') + \"\\t\";\n  <%   }\n  } %>\n  row += \"\\n\";\n  yield row;\n};\n\n<% } %>\n\nconst main = async function* (startURL) {\n  let next = startURL;<% if (fileType === 'json') { %>\n  let first = true;\n  yield `{\\n\"results\": [\\n`;<% } %>\n  while (next) {\n    const response = await fetch(\n      next,\n      { headers: { Accept: 'application/json' } }\n    );\n    // If the server sent a timeout response…\n    if (response.status === 408) {\n      // …wait a bit for the server to process the query in the background…\n      await sleep(60000);\n      // …then continue this loop with the same URL\n      continue;\n    } else if (response.status === 204) {\n      yield '\\n]\\n}\\n';\n      break;\n    }\n    const payload = await response.json();\n    for (const item of payload.results) {<% if (fileType === 'json') { %>\n      if (first) {\n        yield '\\n';\n        first = false;\n      } else {\n        yield ',\\n';\n      }<% } %>\n      yield* processItem(item);\n    }\n    next = payload.next;<% if (fileType === 'json') { %>\n    if (!next) {\n      yield '\\n]\\n}\\n';\n    }<% } %>\n    // Don't overload the server, give it a bit of time before asking for more\n    if (next) await sleep(1000);\n  }\n};\n\nlet BASE_URL = '<%= url %><%= url.indexOf('?')===-1 ? '?' : '&' %>page_size=200<%= fileType === 'fasta' ? '&extra_fields=sequence' : '' %>';\n<% if (fileType === \"tsv\" && columns.some(x => x.indexOf(\"extra_fields.counters\")>=0)) { \n%>BASE_URL += \"&extra_fields=counters\"\n<% } %>\n  \nif (require.main === module) {\n  // If used from the command line, will write data to stdout asap\n  const mainWriteToStdout = async () => {\n    const process = require('process');\n    // If pipe is interrupted, it might be normal, just exit\n    process.stdout.on(\n      'error',\n      ({ code }) => process.exit(code === 'EPIPE' ? 0 : 1)\n    );\n    for await (const output of main(BASE_URL)) {\n      process.stdout.write(output);\n    }\n  }\n  mainWriteToStdout();\n} else {\n  // If used as a module, can be used as an async generator\n  module.exports = (baseURL = BASE_URL) => main(baseURL);\n}\n",K),type:"application/javascript",syntax:"javascript"}]]);class ee extends a.PureComponent{constructor(e){super(e),this._handleChange=(0,V.Z)((e=>{var{target:t}=e,{value:n}=t;this.setState({language:n})})),this.state={language:"py",code:null,href:null},this._ref=a.createRef()}static getDerivedStateFromProps(e,t){var n=Q.get(t.language);if(!n)return null;var a=n.template(e).replace(/\n{2,}/g,"\n\n");return a===t.code?null:(t.href&&URL.revokeObjectURL(t.href),{code:a,href:URL.createObjectURL(new Blob([a],{type:n.type}))})}componentDidMount(){this._ref.current&&(this._clipboard=new(G())(this._ref.current,{text:()=>this.state.code||""}),this._clipboard.on("success",(()=>this.props.addToast({title:"Copy successful",body:"This snippet of code is now in your clipboard",ttl:3e3},"clipboard"))),this._clipboard.on("error",(()=>this.props.addToast({title:"Error while copying",body:"An error was encountered while trying to copy this snippet of code in your clipboard",ttl:3e3,className:X("alert")},"clipboard"))))}componentWillUnmount(){this._clipboard&&this._clipboard.destroy()}render(){var e,{language:t,code:n,href:r}=this.state;return a.createElement("section",null,a.createElement("h6",null,"Code snippet"),a.createElement("p",null,"We generally recommend you download the results of your queries programatically rather than through the web browser. Downloading large lists of results within the browser can use up a lot of memory. If you notice that your browser crashes when downloading one of those generated files, it is ",a.createElement("strong",null,"very likely")," to be because your computer is running out of memory."),a.createElement("p",null,"To help you download data programmatically, we have generated a snippet of code for you below. You can select a programming language from the list below, copy or download the code into a text file and then run the downloaded code via the selected programming language in a terminal. If you are getting started with programming we recommend looking into",a.createElement("a",{href:"https://www.python.org/about/gettingstarted"}," Python.")),a.createElement("div",null,a.createElement("label",null,"Select your language:",a.createElement("select",{onChange:this._handleChange,onBlur:this._handleChange,value:t},a.createElement("option",{value:"py"},"Python3"),a.createElement("option",{value:"pl"},"Perl (version 5)"),a.createElement("option",{value:"js"},"JavaScript (node, version ≥ 10)"))),a.createElement(p.z,{type:"secondary",ref:this._ref,icon:"icon-copy"},"Copy to clipboard")," ",a.createElement("a",{className:X("vf-button","vf-button--secondary","vf-button--sm"),download:"script-InterPro."+t,href:r||""},a.createElement("span",{className:X("icon","icon-common","ico-neutral","icon-download")})," ","Download"),"js"===t&&a.createElement(B.Z,{type:"info"},"This script requires the packages: ",a.createElement("code",null,"node-fetch")," and"," ",a.createElement("code",null,"timing-functions")," either globally or in the local"," ",a.createElement("code",null,"node_modules")),a.createElement(U.Z,{language:null===(e=Q.get(t))||void 0===e?void 0:e.syntax,style:H.Z},n||"")))}}const te=(0,R.$j)(void 0,{addToast:m.fz})(ee);var ne=n(43100),ae=(0,v.Z)({absolute:"ProgressAnimation_style__absolute___c9","main-container":"ProgressAnimation_style__main-container___f2",side:"ProgressAnimation_style__side___c8",left:"ProgressAnimation_style__left___ac",right:"ProgressAnimation_style__right___e6","filter-container":"ProgressAnimation_style__filter-container___a0","moving-container":"ProgressAnimation_style__moving-container___e8",trail:"ProgressAnimation_style__trail___c0",ball:"ProgressAnimation_style__ball___d8",progress:"ProgressAnimation_style__progress___d4"});class re extends a.PureComponent{render(){var{download:e}=this.props;if(!e)return null;var{progress:t,successful:n}=e,r=Number.isFinite(t)&&!n,s=0;return r?s=t?.9*t+.05:.05:1===t&&(s=1.1),a.createElement(a.Fragment,null,a.createElement("svg",{width:"0",height:"0"},a.createElement("defs",null,a.createElement("filter",{id:"gooey-filter"},a.createElement("feGaussianBlur",{in:"SourceGraphic",result:"blurred",stdDeviation:"10"}),a.createElement("feColorMatrix",{in:"blurred",result:"matrix",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7"}),a.createElement("feBlend",{in:"SourceGraphic",in2:"matrix"})))),a.createElement("div",{className:ae("main-container"),style:{opacity:r?1:0}},a.createElement("div",{className:ae("filter-container","absolute")},a.createElement("div",{className:ae("left","side","absolute")}),a.createElement("div",{className:ae("moving-container","absolute"),style:{transform:"translateX("+100*s+"%)"}},a.createElement("div",{className:ae("trail","absolute")}),a.createElement("div",{className:ae("trail","ball","absolute")}),a.createElement("div",{className:ae("progress","ball","absolute")},a.createElement("span",null,Math.floor(100*(t||0)),"%"))),a.createElement("div",{className:ae("right","side","absolute")})),a.createElement("div",{className:ae("left","side","absolute")}),a.createElement("div",{className:ae("right","side","absolute")})))}}n(52003),n(12826);var se=n(2191),oe=(0,v.Z)(W,y.Z),ie=e=>e.slice(1+e.lastIndexOf("/"));const le=e=>{var t,{data:n,dataComponents:r,value:s,onRemove:o,onChange:i}=e,l=(0,a.useRef)(null);if((0,a.useEffect)((()=>{i({target:l.current})}),[]),!n||!r)return null;var c=n.schema,u=e=>{if(!e)return!1;var t=null==c?void 0:c.pattern;return!t||RegExp(t||"").test(e)},[m,f]=(0,a.useState)(u(s)),h="text",v=n.schema.$ref;if(v){var y=ie(v||"");c=r.schemas[y]}var g=c.type,b=c.enum;"string"===g&&b&&(h=1===b.length?"checkbox":"select");var E="search."+n.name;return a.createElement(_,{label:a.createElement(a.Fragment,null,n.name," ",a.createElement(se.Z,{title:"<pre>"+n.description+"</pre>"},a.createElement("span",{className:oe("small","icon","icon-common"),"data-icon":"","aria-label":"description for attribute: "+n.name}))),input:a.createElement(a.Fragment,null,"select"===h&&a.createElement("select",{className:oe("new-input-group-field"),name:E,value:s,onChange:d.Z,onBlur:d.Z},null===(t=c.enum)||void 0===t?void 0:t.map((e=>a.createElement("option",{key:e},e)))),"checkbox"===h&&a.createElement("input",{name:E,type:"text",readOnly:!0,className:oe("new-input-group-field"),value:n.name}),"text"===h&&a.createElement("input",{value:s,onChange:e=>{f(u(e.target.value))},onBlur:d.Z,name:E,type:"text",style:{backgroundColor:m?"inherit":"#fa7e6e"},className:oe("new-input-group-field")})),button:a.createElement(p.z,{onClick:o,ref:l},"Remove")})};var ce=(0,v.Z)(W),ue=(0,r.P1)((e=>e.settings.api),(e=>{var{protocol:t,hostname:n,port:a,root:r}=e;return(0,c.UF)((0,s.format)({protocol:t,hostname:n,port:a,pathname:r+"/utils/openapi"}))}));const me=(0,i.Z)({getUrl:ue,fetchOptions:{responseType:"yaml"}})((e=>{var t,n,r,s,{type:o,data:i,search:l,onChange:c}=e,[u,m]=(0,a.useState)(null),[p,d]=(0,a.useState)(null),f=!!i&&!i.loading&&i.ok&&!!i.payload;(0,a.useEffect)((()=>{u&&m(null)})),(0,a.useEffect)((()=>()=>f?c({target:null}):void 0),[p]);var h=Object.keys(l||{});if(u&&h.push(u),p){var v=h.indexOf(p);v>=0?h.splice(v,1):d(null)}if(!f)return null;var y=Object.fromEntries(((null===(s=null===(r=null===(n=null===(t=i.payload)||void 0===t?void 0:t.paths)||void 0===n?void 0:n["/"+o+"/{sourceDB}"])||void 0===r?void 0:r.get)||void 0===s?void 0:s.parameters)||[]).filter((e=>e.$ref)).map((e=>{var t,n,a,r=ie(e.$ref||"");return[null===(a=null===(n=null===(t=i.payload)||void 0===t?void 0:t.components.parameters)||void 0===n?void 0:n[r])||void 0===a?void 0:a.name,r]}))),g=Object.keys(y).filter((e=>e&&-1===h.indexOf(e))),_=e=>{m(e.target.value)};return a.createElement("div",null,a.createElement("label",null,"Add a modifier:",a.createElement("select",{name:"add_modifier",value:"",onChange:_,onBlur:_},a.createElement("option",{value:"",disabled:!0,hidden:!0,style:{color:"gray"}},"Please Choose..."),g.map(((e,t)=>a.createElement("option",{key:t,value:e},e))))),h&&h.length>0&&a.createElement("fieldset",{className:ce("fieldset")},a.createElement("legend",null,"Active Modifiers"),h.map((e=>{var t,n,r;return a.createElement(le,{key:e,value:null==l?void 0:l[e],onChange:c,onRemove:()=>d(e),data:null===(n=null===(t=i.payload)||void 0===t?void 0:t.components.parameters)||void 0===n?void 0:n[y[e]],dataComponents:null===(r=i.payload)||void 0===r?void 0:r.components})}))))}));var pe=n(25070),de=n(10838),fe=n(72694),he=n(86647),ve=(n(57460),/&lt;\/?(p|ul|li)&gt;/gi),ye=/\<taxon [^>]+>([^<]+)<\/taxon>/gi,ge=/\<[^"].*?id="([^"]+)"\/>/gi,_e=(e,t)=>n=>n.map((n=>{var a=e?(0,he.Z)(n,e):n;return t?t(a):a})).join(";"),be=e=>e?e.map((e=>{var{fragments:t}=e;return t.map((e=>{var{start:t,end:n}=e;return t+".."+n})).join(",")})).join(","):"",Ee=(e,t)=>e.accession+"{"+e.name+"}"+(t?":"+t.accession+"{"+t.name+"}":"")+"["+e.coordinates[0].fragments[0].start+"-"+e.coordinates[0].fragments[0].end+"]",we=e=>{if(null==e||!e.length)return"";var t=e[0],n=null==e?void 0:e[1];return n?n.accession.startsWith("PF")?(Ee(t)+","+we(e.slice(1))).replace(/,$/,""):(Ee(t,n)+","+we(e.slice(2))).replace(/,$/,""):Ee(t).replace(/,$/,"")},xe={entry:[{name:"Accession",selector:"metadata.accession"},{name:"Name",selector:"metadata.name"},{name:"Source Database",selector:"metadata.source_database"},{name:"Type",selector:"metadata.type"},{name:"Integrated Into",selector:"metadata.integrated"},{name:"Integrated Signatures",selector:"metadata.member_databases",serializer:e=>e?Object.keys(e).map((t=>Object.keys(e[t]).join(","))).join(","):""},{name:"GO Terms",selector:"metadata.go_terms",serializer:e=>e?e.map((e=>e.identifier)).join(","):""}],protein:[{name:"Accession",selector:"metadata.accession"},{name:"Source Database",selector:"metadata.source_database"},{name:"Name",selector:"metadata.name"},{name:"Tax ID",selector:"metadata.source_organism.taxId"},{name:"Tax Name",selector:"metadata.source_organism.scientificName"},{name:"Length",selector:"metadata.length"}],structure:[{name:"Accession",selector:"metadata.accession"},{name:"Source Database",selector:"metadata.source_database"},{name:"Name",selector:"metadata.name"},{name:"Experiment Type",selector:"metadata.experiment_type"},{name:"Resolution",selector:"metadata.resolution"}],taxonomy:[{name:"Accession",selector:"metadata.accession"},{name:"Source Database",selector:"metadata.source_database"},{name:"Name",selector:"metadata.name"},{name:"Parent",selector:"metadata.parent"},{name:"Children",selector:"metadata.children",serializer:e=>e?e.join(","):""},{name:"Number of Entries",selector:"extra_fields.counters.entries"},{name:"Number of Proteins",selector:"extra_fields.counters.proteins"}],proteome:[{name:"Accession",selector:"metadata.accession"},{name:"Source Database",selector:"metadata.source_database"},{name:"Name",selector:"metadata.name"},{name:"Tax ID",selector:"metadata.taxonomy"},{name:"Number of Entries",selector:"extra_fields.counters.entries"},{name:"Number of Proteins",selector:"extra_fields.counters.proteins"}],set:[{name:"Accession",selector:"metadata.accession"},{name:"Source Database",selector:"metadata.source_database"},{name:"Name",selector:"metadata.name"},{name:"Number of Entries",selector:"extra_fields.counters.entries"},{name:"Number of Proteins",selector:"extra_fields.counters.proteins"}],ebisearch:[{name:"Accession",selector:"id"},{name:"Name",selector:"fields.name[0]"},{name:"Description",selector:"fields.description",serializer:e=>e.join("\n").replace(ve,"").replace(ye,"$1").replace(ge,"$1").replace("[]","").replace(/[\n\r]/g,"\n").replace("()","")},{name:"Source Database",selector:"fields.source_database[0]"}],ida:[{name:"IDA ID",selector:"ida_id"},{name:"IDA Text",selector:"ida"},{name:"Unique Proteins",selector:"unique_proteins"},{name:"Representative Accession",selector:"representative.accession"},{name:"Representative Length",selector:"representative.length"},{name:"Representative Domains",selector:"representative.domains",serializer:we}]};xe.proteinEntry=[...xe.protein,{name:"Entry Accession",selector:"entries[0].accession"},{name:"Matches",selector:"entries[0].entry_protein_locations",serializer:be}],xe.proteinStructure=[...xe.protein,{name:"Structure Accession",selector:"structures",selectorInGroup:"accession",serializer:_e("accession")},{name:"Chain",selector:"structures",selectorInGroup:"chain",serializer:_e("chain")},{name:"Structure Location",selector:"structures",selectorInGroup:"structure_protein_locations",serializer:_e("structure_protein_locations",be)}],xe.structureProtein=[...xe.structure,{name:"Chains",selector:"proteins",selectorInGroup:"chain",serializer:_e("chain")},{name:"Proteins",selector:"proteins",selectorInGroup:"accession",serializer:_e("accession")},{name:"Structure Location",selector:"proteins",selectorInGroup:"structure_protein_locations",serializer:_e("structure_protein_locations",be)}],xe.structureEntry=[...xe.structure,{name:"Chains",selector:"entries",selectorInGroup:"chain",serializer:_e("chain")},{name:"Proteins",selector:"entries",selectorInGroup:"protein",serializer:_e("protein")},{name:"Protein Length",selector:"entries",selectorInGroup:"protein_length",serializer:_e("protein_length")},{name:"Structure Location",selector:"entries",selectorInGroup:"structure_protein_locations",serializer:_e("structure_protein_locations",be)},{name:"matches",selector:"entries",selectorInGroup:"entry_protein_locations",serializer:_e("entry_protein_locations",be)}],xe.entryStructure=[...xe.entry,{name:"Chains",selector:"structures",selectorInGroup:"chain",serializer:_e("chain")},{name:"Proteins",selector:"structures",selectorInGroup:"protein",serializer:_e("protein")},{name:"Protein Length",selector:"structures",selectorInGroup:"protein_length",serializer:_e("protein_length")},{name:"Structure Location",selector:"structures",selectorInGroup:"structure_protein_locations",serializer:_e("structure_protein_locations",be)},{name:"matches",selector:"structures",selectorInGroup:"entry_protein_locations",serializer:_e("entry_protein_locations",be)}],xe.entryProtein=[...xe.entry,{name:"Protein Accession",selector:"proteins[0].accession"},{name:"Protein Length",selector:"proteins[0].protein_length"},{name:"Matches",selector:"proteins[0].entry_protein_locations",serializer:be}];var Te=(0,v.Z)(W),$e=(0,l.Z)({loader:()=>n.e(1169).then(n.bind(n,25392)),loading:()=>null}),je=e=>{var[t,n,a]=e.replaceAll("%7C","|").replaceAll("%26","&").replaceAll("%3F","?").split("|");if(!["fasta","json","accession","tsv"].includes(n))throw new Error("The filetypoe in the URL is invalid");var r={fileType:n,subset:!!a},[s,o]=t.split("?");try{r.description=(0,pe.Z)(s),o&&(r.search=Object.fromEntries(o.split("&").map((e=>e.split("=")))))}catch(e){}return r};class Pe extends a.PureComponent{constructor(e){super(e),this._handleChange=e=>{var t,n,a,r,s,i,l,c;if(this._ref.current){var u,{description:m,search:p,fileType:d,subset:f}=je(this.props.matched),h={description:Object.assign({},m),search:Object.assign({},p),subset:f,fileType:d},v=null==e?void 0:e.target;if(v instanceof HTMLButtonElement&&((0,o.Z)(h,v.dataset.key||"",!!v.dataset.value),!v.dataset.value))for(var y of this._ref.current.querySelectorAll('input[data-reset="'+v.dataset.reset+'"], input[name="'+v.dataset.key+'"], select[name="'+v.dataset.key+'"]'))y.value="";for(var g of this._ref.current.elements){var{name:_,value:b,type:E,checked:w}=g;_&&(0,o.Z)(h,_,"checkbox"===E?w:b)}"description.main.key"===(null==v?void 0:v.name)&&(h.search={}),h.description.entry&&"interpro"===h.description.entry.db&&(h.description.entry.integration=null),(0,o.Z)(h.description,[(null===(t=h.description.main)||void 0===t?void 0:t.key)||"","isFilter"],null);var x=Te("invalid-accession").split(" ");try{u=(0,de.Z)(h.description),(null==v?void 0:v.classList)&&v.classList.remove(...x)}catch(e){return void((null==v?void 0:v.classList)&&v.classList.add(...x))}h.search&&Object.keys(h.search).length&&(u+="?"+Object.entries(h.search).map((e=>{var[t,n]=e;return t+"="+n})).join("&")),!h.subset||"fasta"===h.fileType&&(null===(n=h.description.entry)||void 0===n?void 0:n.isFilter)&&(null===(a=h.description.entry)||void 0===a?void 0:a.accession)||(h.subset=!1),"fasta"===h.fileType&&"protein"!==(null===(r=h.description.main)||void 0===r?void 0:r.key)&&(h.fileType="accession"),"fasta"!==h.fileType&&"accession"!==h.fileType||!h.description.main||(null===(s=h.description[h.description.main.key])||void 0===s?void 0:s.db)||(h.fileType="json");var T=[u,h.fileType,h.subset&&"subset"].filter(Boolean).join("|");T!==(null===(i=this.props.customLocation)||void 0===i?void 0:i.hash)&&(null===(c=(l=this.props).goToCustomLocation)||void 0===c||c.call(l,Object.assign(Object.assign({},this.props.customLocation),{hash:T})))}},this._ref=a.createRef(),this.memberDB={}}render(){var e,t,n,r,o,{matched:i,api:l,lowGraphics:c,data:m}=this.props;if(!m||!l)return null;var{description:d,search:f,fileType:h,subset:v}=je(i);if(!d)return null;var y=h||"json",g=(0,fe.Y2)((0,s.format)({protocol:l.protocol,hostname:l.hostname,port:l.port,pathname:(l.root+(0,de.Z)(d)).replace(/\/+/g,"/"),query:f})),b=Object.entries(d).filter((e=>{var[,t]=e;return void 0!==t.isFilter})),E=b.filter((e=>{var[,t]=e;return t.isFilter})),w=d.main.key||"entry",x=E.length&&E[0][0],T=x&&d[x].accession?""+w+x[0].toUpperCase()+x.slice(1):w,$=xe[T]||xe[w],P=(e,t)=>{var n=e.split("[*]"),a=n[0].split(/(\[\d\])/).flatMap((e=>e.split("."))).filter(Boolean).map((e=>e.startsWith("[")?e:'["'+e+'"]')).join("");return n.length>1?"[x"+n[1]+" for x in "+t+a+"]":""+t+a};!(null==m?void 0:m.loading)&&(null==m?void 0:m.payload)&&(this.memberDB=m.payload.databases);var S=Number((null===(n=null===(t=null===(e=null==m?void 0:m.payload)||void 0===e?void 0:e.databases)||void 0===t?void 0:t.interpro)||void 0===n?void 0:n.version)||0),O=(e,t)=>{var n=e.split("[*]"),a=n[0].split(/(\[\d\])/).flatMap((e=>e.split("."))).filter(Boolean).map((e=>e.startsWith("[")?e:'->{"'+e+'"}')).join("");return n.length>1?(n[1]+", "+t+a).replace(/[[]]/g,""):""+t+a},N=d[w];return a.createElement("form",{onChange:this._handleChange,ref:this._ref,className:Te("download-form")},a.createElement("h4",null,"Select data"),a.createElement($e,{data:{name:"Download Web from for the InterPro API",description:"A Webform that allows the user to filter the InterPro dataset to create Download Jobs or scripts"},processData:u.o7}),a.createElement("fieldset",{className:Te("fieldset")},a.createElement("legend",null,"Main data type"),a.createElement("label",null,"Choose a main data type:",a.createElement("select",{name:"description.main.key",defaultValue:w},b.map((e=>{var[t]=e;return a.createElement("option",{key:t,value:t},t.charAt(0).toUpperCase()+t.slice(1))})))),a.createElement(j,{type:w,value:(N.db||"").toLowerCase(),valueIntegration:(N.integration||"").toLowerCase(),name:"description."+w+".db",onClick:this._handleChange,databases:this.memberDB}),a.createElement(me,{type:w,search:f,onChange:this._handleChange})),a.createElement("fieldset",{className:Te("fieldset")},a.createElement("legend",null,"Filters"),a.createElement("div",null,"Add a filter:",a.createElement("div",{className:Te("button-group")},b.filter((e=>{var[t]=e;return t!==w&&!d[t].isFilter})).map((e=>{var[t]=e;return a.createElement(p.z,{key:t,value:t,"data-key":"description."+t+".isFilter","data-value":!0,onClick:this._handleChange},t.charAt(0).toUpperCase()+t.slice(1))}))),a.createElement("ul",{className:Te("no-bullet")},E.map((e=>{var[t,n]=e;return a.createElement("li",{key:t},a.createElement("fieldset",{className:Te("fieldset")},a.createElement("legend",null,t),a.createElement(_,{label:"filter type:",input:a.createElement("input",{type:"text",readOnly:!0,value:t,name:"description."+t+".isFilter"}),button:a.createElement(p.z,{"data-key":"description."+t+".isFilter",onClick:this._handleChange},"Remove")}),a.createElement(j,{type:t,value:(n.db||"").toLowerCase(),valueIntegration:(n.integration||"").toLowerCase(),name:"description."+t+".db",onClick:this._handleChange,databases:this.memberDB}),a.createElement(_,{label:t+" accession:",input:a.createElement("input",{type:"text",disabled:!d[t].db,defaultValue:n.accession||"",name:"description."+t+".accession",className:Te("input-group-field"),"data-reset":"description."+t}),button:a.createElement(p.z,{"data-key":"description."+t+".accession",onClick:this._handleChange},"Remove")})))}))))),a.createElement("h4",null,"Select Output Format"),a.createElement(A,{fileType:y,mainEndpoint:d.main.key,hasSelectedDB:!!(null===(r=null==d?void 0:d[d.main.key])||void 0===r?void 0:r.db),hasSelectedAccession:!!(null===(o=null==d?void 0:d[d.main.key])||void 0===o?void 0:o.accession)}),a.createElement("h4",null,"Results"),a.createElement(C,{url:g}),a.createElement(I,{url:g,fileType:y,subset:v},(e=>{var{data:t,download:n,isStale:r}=e;if(!t)return null;var s=t.payload&&t.payload.count||0,{db:o,integration:i}=N,l=0===s&&(null!==o||null!==i);return a.createElement(a.Fragment,null,a.createElement(L,{data:t,isStale:r}),N.db&&!N.accession&&a.createElement(te,{fileType:y,url:g,subset:v,columns:$.map((e=>e.selector+(e.selectorInGroup?'[*]["'+e.selectorInGroup+'"]':""))),path2code:P,path2perl:O}),a.createElement("div",null,a.createElement("h4",null,"Download"),a.createElement(k,{fileType:y,description:d,subset:v,isStale:!!r,count:s,noData:l}),a.createElement(ne.ZP,{fileType:y,subset:v,entityType:w,url:g,download:n,isStale:r,count:s,noData:l,interProVersion:S})),c||a.createElement(re,{download:n}))})))}}var Ce=(0,r.P1)((e=>e.customLocation),(e=>e.settings.api),(e=>e.settings.ui.lowGraphics),((e,t,n)=>({customLocation:e,api:t,lowGraphics:n})));const Se=(0,i.Z)({getUrl:c.g$,mapStateToProps:Ce,mapDispatchToProps:{goToCustomLocation:m.xb}})(Pe)},24644:(e,t,n)=>{n.d(t,{e:()=>a}),n(76801);var a=function(e,t,n){void 0===n&&(n=!1);var a=[];return n?["taxonomy","proteome","set"].includes(t)&&(a.push("protein"),a.push("entry")):["entry","taxonomy","set"].includes(e)&&["taxonomy","proteome"].includes(t)&&a.push("protein"),a.length?"counters:"+a.join("-"):""}},94028:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(76853),r=n(9033);const s=e=>{var t,n={getUrl:r.F6,fetchOptions:{},propNamespace:"",weight:1,mapStateToProps:a.Z,mapDispatchToProps:{}};return e?"object"!=typeof e?(n.getUrl="string"==typeof e?r.Gr(e):e,n):(n.getUrl=(void 0===(t=e.getUrl)&&(t=r.F6),"string"==typeof t?r.Gr(t):t),n.fetchOptions=e.fetchOptions||n.fetchOptions,n.propNamespace=e.propNamespace||n.propNamespace,n.weight=e.weight||n.weight,n.mapStateToProps=e.mapStateToProps||n.mapStateToProps,n.mapDispatchToProps=e.mapDispatchToProps||n.mapDispatchToProps,n):n}},72004:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(5350);const r=function(e){var{method:t,responseType:n}=void 0===e?{}:e;return"text"===n?a.OJ:"yaml"===n?a.JA:"gzip"===n?a.x2:"HEAD"!==t?a.r_:a.ZP}},34287:(e,t,n)=>{n.d(t,{Z:()=>h}),n(73964),n(60429),n(752),n(51090),n(76265);var a=n(67294),r=n(45007),s=n(19119),o=n(74482),i=n(66467),l=n(87616),c=n(94028),u=n(72004),m=n(27262),p=function(e,t,n,a,r){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?r.call(e,n):r?r.value=n:t.set(e,n),n},d=function(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)},f=(0,s.P1)((e=>e),(e=>({appState:e})));const h=e=>{var{getUrl:t,fetchOptions:n,propNamespace:s,weight:h,mapStateToProps:v,mapDispatchToProps:y}=(0,c.Z)(e),g=(0,u.Z)(n),_=e=>({loading:!!e,progress:0,ok:!0,status:null,payload:null,url:e});return e=>{var c,u;class b extends a.PureComponent{constructor(e){super(e),c.set(this,void 0),u.set(this,void 0),this.timeoutID=0,this._cancel=()=>{var e,t;d(this,u,"f")&&d(this,u,"f").cancel(),null===(t=(e=this.props).dataProgressUnload)||void 0===t||t.call(e,d(this,c,"f"))},this._progress=e=>{var t,n;this.setState((t=>{var{data:n}=t;return{data:Object.assign(Object.assign({},n),{progress:e})}})),null===(n=(t=this.props).dataProgressInfo)||void 0===n||n.call(t,d(this,c,"f"),e,h)},this._load=e=>{return t=this,a=void 0,s=function*(){var t,a,r,s,o,l,m;if(e){null===(a=(t=this.props).dataProgressInfo)||void 0===a||a.call(t,d(this,c,"f"),0,h),p(this,u,(0,i.Z)((t=>g(e,Object.assign(Object.assign({},n),{signal:t}),this._progress,this.props.addToast))),"f");var f=d(this,u,"f");try{var v=yield f.promise;gtag("event","data",{event_category:"data",event_response:v.status,event_label:e,event_clientcache:v.headers.has("Client-Cache")?1:0,event_cache:v.headers.has("Cached")?1:0}),this.setState((e=>{var{data:t}=e,n=Object.assign(Object.assign(Object.assign({},t),v),{progress:1,loading:!1});return{data:n,staleData:n}})),null===(s=(r=this.props).dataProgressInfo)||void 0===s||s.call(r,d(this,c,"f"),1,h);var y=1e3*((null===(o=this.props.appState)||void 0===o?void 0:o.settings.navigation.secondsToRetry)||0);408===v.status&&(this.timeoutID=window.setTimeout((()=>{console.log("Retrying the Timed out query"),this.setState({retries:this.state.retries+1})}),y))}catch(t){f.canceled||(gtag("event","error",{event_category:"data",event_status:"fail",event_label:e,event_online:window.navigator.onLine?1:0}),this.setState((e=>{var{data:n}=e;return{data:Object.assign(Object.assign({},n),{loading:!1,progress:1,ok:!1,error:t})}})),null===(m=(l=this.props).dataProgressInfo)||void 0===m||m.call(l,d(this,c,"f"),1,h))}}else this.setState({staleData:Object.assign({},this.state.data)})},new((r=void 0)||(r=Promise))((function(e,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function i(e){try{l(s.throw(e))}catch(e){n(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,i)}l((s=s.apply(t,a||[])).next())}));var t,a,r,s},p(this,c,(0,o.Z)("data-loader"),"f");var a=(null==t?void 0:t(e.appState||{},e))||"";this.state={url:a,data:_(a),staleData:void 0,retries:0}}static getDerivedStateFromProps(e,n){var a=(null==t?void 0:t(e.appState||{},e))||"";return n.url===a?null:{data:_(a),url:a}}componentDidMount(){this._load(this.state.url)}componentDidUpdate(e,t){t.url===this.state.url&&t.retries===this.state.retries||(this._cancel(),this._load(this.state.url))}componentWillUnmount(){this._cancel(),this.timeoutID&&window.clearTimeout(this.timeoutID)}render(){var t=this.props,{dataProgressInfo:n,dataProgressUnload:r,addToast:o,appState:i}=t,l=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(t,["dataProgressInfo","dataProgressUnload","addToast","appState"]),c="isStale"+s,u={["data"+s]:this.state.staleData||this.state.data,[c]:this.state.staleData!==this.state.data};return this.state.data&&!this.state.data.loading&&this.state.data.url===this.state.url&&(u["isStale"+s]=!1),a.createElement(m.m,{customLocation:null==i?void 0:i.customLocation},a.createElement(e,Object.assign({},l,u,(null==v?void 0:v(i,Object.assign(Object.assign({},l),u)))||{})))}}c=new WeakMap,u=new WeakMap,b.displayName="loadData("+(e.displayName||e.name)+")";var E=Object.assign({dataProgressInfo:l.fF,dataProgressUnload:l.ks,addToast:l.fz},y);return(0,r.$j)(f,E)(b)}}},66467:(e,t,n)=>{n.d(t,{Z:()=>a}),n(73964);const a=function(e){void 0===e&&(e=Promise.resolve());var t=e,n=new AbortController;"then"in e||(t=e(n.signal));var a={promise:t.then((e=>{if(a.canceled)throw{canceled:a.canceled};return e})),canceled:!1,cancel(){a.canceled=!0,n.abort()}};return a}},63139:(e,t,n)=>{n.d(t,{iZ:()=>i}),n(752),n(76265),n(28436),n(64043),n(57267);var a=n(52727),r=Object.keys(a.default.pages),s=Object.entries(a.default.pages).map((e=>{var[t,n]=e,a=n;return a&&a.plural&&"string"==typeof a.plural?a.plural:t+"s"})),o=/s$/i,i=function(e,t,n){void 0===t&&(t=1/0),void 0===n&&(n=!1);for(var a=e.trim(),i=0;i<r.length;i++)if(r[i]===a)return t>1?s[i]:a;if(n)return a.replace(o,"")+(t>1?"s":"");throw new Error("Not an existing page")}}}]);
//# sourceMappingURL=9439.module.download-form.ff3.js.map