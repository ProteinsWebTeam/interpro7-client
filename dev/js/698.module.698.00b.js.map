{"version":3,"file":"js/698.module.698.00b.js","mappings":"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","sources":["webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-links/src/links-parser.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-links/src/nightingale-links.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-manager/src/nightingale-manager.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-manager/src/index.ts","webpack://interpro7-client/./node_modules/lodash-es/clamp.js","webpack://interpro7-client/./node_modules/lodash-es/_baseClamp.js","webpack://interpro7-client/./node_modules/lodash-es/toFinite.js","webpack://interpro7-client/./node_modules/lodash-es/toInteger.js","webpack://interpro7-client/./node_modules/lodash-es/_createRound.js","webpack://interpro7-client/./node_modules/lodash-es/floor.js","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/utils/object2style.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Canvas/FakeScroll.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Canvas/DraggingComponent.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Canvas/CanvasTilingGrid.ts","webpack://interpro7-client/./node_modules/lodash-es/_baseLt.js","webpack://interpro7-client/./node_modules/lodash-es/minBy.js","webpack://interpro7-client/./node_modules/lodash-es/_baseExtremum.js","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Canvas/CanvasCache.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/utils/mouse.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/utils/math.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/schemeclass.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/aliphatic.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/buried.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/helix.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/purine.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/strand.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/turn.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/pid_colors.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/index.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/aromatic.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/charged.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/cinema.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/clustal2.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/clustal.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/hydrophobicity.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/lesk.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/mae.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/negative.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/nucleotide.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/polar.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/positive.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/serine_threonine.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/taylor.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/colorschemes/zappo.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/utils/ColorScheme.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Canvas/SequenceViewer.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/components/Labels.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/workers/conservation-inline-worker.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-msa/src/nightingale-msa.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-navigation/src/nightingale-navigation.ts","webpack://interpro7-client/./node_modules/@nightingale-elements/nightingale-navigation/src/index.ts","webpack://interpro7-client/./node_modules/stockholm-js/index.js","webpack://interpro7-client/./node_modules/stockholm-js/src/Stockholm.js","webpack://interpro7-client/./node_modules/core-js/internals/this-number-value.js","webpack://interpro7-client/./node_modules/core-js/modules/es.number.to-fixed.js","webpack://interpro7-client/./node_modules/core-js/modules/es.typed-array.float32-array.js"],"sourcesContent":["export type ArrayOfNumberArray = Array<Array<number>>;\nexport interface LinksObject {\n  contacts: ArrayOfNumberArray;\n}\nexport interface ContactObject {\n  contacts: Contacts;\n  maxNumberOfContacts: number;\n  selected?: number;\n  isHold?: boolean;\n}\n\nexport interface NumberArray {\n  [index: number]: number;\n}\n\nexport interface Contacts {\n  [contactPosition: number]: Set<number>;\n}\n\nexport type LinksData = string | ContactObject;\n\nexport type ContactEntry = [number, Set<number>];\n\nexport type ContactLink = Array<number>;\n\nexport const parseToRowData = (text: string): ArrayOfNumberArray =>\n  text\n    .split(\"\\n\")\n    .slice(1)\n    .filter((line) => line.trim() !== \"\")\n    .map((line): number[] => {\n      const values = line.trim().split(\" \");\n      if (values.length === 5) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const [n1, n2, _, __, p] = values;\n        return [+n1, +n2, +p];\n      }\n      if (values.length === 3) {\n        const [n1, n2, p] = values;\n        return [+n1, +n2, +p];\n      }\n      throw new Error(\"The file is not valid\");\n    });\n\nexport const filterContacts = (\n  data: ArrayOfNumberArray,\n  minDistance: number,\n  minProbability: number,\n): ArrayOfNumberArray =>\n  data.filter(([n1, n2, p]) => {\n    return Math.abs(n1 - n2) >= minDistance && p > minProbability;\n  });\n\nexport const parseLinksAssociative = (\n  text: string,\n  minDistance: number,\n  minProbability: number,\n): LinksObject => {\n  const rawData = filterContacts(\n    parseToRowData(text),\n    minDistance,\n    minProbability,\n  );\n  const n2set: NumberArray = {};\n  const sets: ArrayOfNumberArray = [];\n  rawData.forEach(([n1, n2]) => {\n    if (!n2set[n1] && !n2set[n2]) {\n      n2set[n1] = sets.length;\n      n2set[n2] = sets.length;\n      sets.push([n1, n2]);\n    } else if (n2set[n1] && !n2set[n2]) {\n      n2set[n2] = n2set[n1];\n      sets[n2set[n1]].push(n2);\n    } else if (!n2set[n1] && n2set[n2]) {\n      n2set[n1] = n2set[n2];\n      sets[n2set[n1]].push(n1);\n    } else if (n2set[n1] && n2set[n2] && n2set[n1] !== n2set[n2]) {\n      sets[n2set[n2]].forEach((n) => {\n        sets[n2set[n1]].push(n);\n        n2set[n] = n2set[n1];\n      });\n    }\n  });\n  return {\n    contacts: sets\n      .filter((_, i) => Object.values(n2set).includes(i))\n      .map((s) => s.sort((x, y) => x - y)),\n  };\n};\nexport const parseLinks = (\n  text: string,\n  minDistance: number,\n  minProbability: number,\n): ContactObject => {\n  const rawData = parseToRowData(text);\n  return getContactsObject(\n    filterContacts(rawData, minDistance, minProbability),\n  );\n};\n\nexport const getContactsObject = (\n  contacts: ArrayOfNumberArray,\n): ContactObject => {\n  const contactsObj: Contacts = {};\n  contacts.forEach(([n1, n2]) => {\n    if (!contactsObj[n1]) contactsObj[n1] = new Set<number>();\n    if (!contactsObj[n2]) contactsObj[n2] = new Set<number>();\n    contactsObj[n1].add(n2);\n    contactsObj[n2].add(n1);\n  });\n  return {\n    contacts: contactsObj,\n    maxNumberOfContacts: Math.max(\n      ...Object.values(contactsObj).map((s) => s.size),\n    ),\n  };\n};\n\nexport const contactObjectToLinkList = (\n  contacts: Contacts,\n): Array<ContactLink> => {\n  const linkList: Array<ContactLink> = [];\n  const keys: Set<string> = new Set();\n  Object.entries(contacts).forEach(([n1, n2s]) => {\n    n2s.forEach((n2: number) => {\n      let key = `${n1}-${n2}`;\n      let link = [+n1, +n2];\n      if (+n1 > +n2) {\n        key = `${n2}-${n1}`;\n        link = [+n2, +n1];\n      }\n      if (!keys.has(key)) {\n        keys.add(key);\n        linkList.push(link);\n      }\n    });\n  });\n  return linkList;\n};\n\nexport default parseLinks;\n","import { customElement, property } from \"lit/decorators.js\";\nimport { PropertyValues } from \"lit\";\nimport { scaleLinear, select, Selection } from \"d3\";\n\nimport NightingaleTrack from \"@nightingale-elements/nightingale-track\";\nimport {\n  parseToRowData,\n  contactObjectToLinkList,\n  getContactsObject,\n  filterContacts,\n  ArrayOfNumberArray,\n  ContactObject,\n  LinksData,\n} from \"./links-parser\";\nimport NightingaleElement from \"@nightingale-elements/nightingale-new-core\";\n\nconst OPACITY_MOUSEOUT = 0.4;\nconst DEFAULT_PROBABILITY = 0.7;\n\nconst d3Color = scaleLinear([0, 1], [\"orange\", \"blue\"]);\n\nconst getHighlightEvent = (\n  type: string,\n  target: NightingaleLinks,\n  residues?: Array<number>,\n): CustomEvent => {\n  return new CustomEvent(\"change\", {\n    detail: {\n      type,\n      target,\n      highlight: residues\n        ? residues.map((fr) => `${fr}:${fr}`).join(\",\")\n        : null,\n    },\n    bubbles: true,\n    cancelable: true,\n  });\n};\n\n@customElement(\"nightingale-links\")\nclass NightingaleLinks extends NightingaleTrack {\n  @property({ type: Number, attribute: \"min-distance\" })\n  minDistance?: number = 0;\n\n  @property({ type: Number, attribute: \"min-probability\" })\n  minProbability?: number = DEFAULT_PROBABILITY;\n\n  _rawData?: ArrayOfNumberArray | null = null;\n  _linksData?: ArrayOfNumberArray | null = null;\n  #contacts?: ContactObject;\n  contactPoints?: Selection<SVGCircleElement, number, SVGGElement, unknown>;\n\n  willUpdate(changedProperties: PropertyValues<this>) {\n    if (\n      changedProperties.has(\"minDistance\") ||\n      changedProperties.has(\"minProbability\")\n    ) {\n      if (this._rawData) {\n        this.#contacts = getContactsObject(\n          filterContacts(\n            this._rawData,\n            this.minDistance || 0,\n            this.minProbability || DEFAULT_PROBABILITY,\n          ),\n        );\n        this.createTrack();\n      }\n    }\n  }\n\n  set contacts(data: LinksData) {\n    if (typeof data === \"string\") {\n      this._rawData = parseToRowData(data);\n    } else if (Array.isArray(data)) {\n      this._rawData = data;\n    } else {\n      throw new Error(\"data is not in a valid format\");\n    }\n    this.#contacts = getContactsObject(\n      filterContacts(\n        this._rawData,\n        this.minDistance || 0,\n        this.minProbability || DEFAULT_PROBABILITY,\n      ),\n    );\n    this.createTrack();\n  }\n  get selected() {\n    return this.#contacts?.selected;\n  }\n\n  protected createTrack() {\n    if (!this.#contacts) {\n      return;\n    }\n\n    this.svg?.selectAll(\"g\").remove();\n\n    this.svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height)\n      .on(\"click\", (event: MouseEvent) => {\n        if (!this.#contacts) return;\n        if (\n          !(event.target as HTMLElement)?.classList.contains(\"contact-point\")\n        ) {\n          this.#contacts.selected = undefined;\n          this.#contacts.isHold = false;\n          this.refreshSelected();\n        }\n      });\n\n    if (!this.svg) return;\n    this.seqG = this.svg.append(\"g\").attr(\"class\", \"sequence-features\");\n    this.createFeatures();\n    // this.#highlighted = this.svg.append(\"g\").attr(\"class\", \"highlighted\");\n    this.margins = this.svg.append(\"g\").attr(\"class\", \"margin\");\n  }\n\n  _getColor(d: number): string {\n    if (!this.#contacts?.contacts[d]) return \"\";\n    return d3Color(\n      this.#contacts.contacts[d].size / this.#contacts.maxNumberOfContacts,\n    );\n  }\n\n  _dispatchSelectNode(d: number): void {\n    if (!this.#contacts) return;\n    this.#contacts.selected = d;\n    this.dispatchEvent(\n      getHighlightEvent(\n        \"mouseover\",\n        this,\n        Array.from(this.#contacts.contacts[d]).concat(+d).sort(),\n      ),\n    );\n  }\n\n  createFeatures(): void {\n    if (!this.#contacts) return;\n\n    this.seqG?.selectAll(\"g.contact-group\").remove();\n    const contactGroup = this.seqG?.append(\"g\").attr(\"class\", \"contact-group\");\n    this.seqG?.append(\"g\").attr(\"class\", \"links-group\");\n\n    if (contactGroup)\n      this.contactPoints = contactGroup\n        .selectAll(\".contact-point\")\n        .data(Object.keys(this.#contacts.contacts).map(Number))\n        .enter()\n        .append(\"circle\")\n        .attr(\"class\", \"contact-point\")\n        .attr(\"fill\", (d: number) => this._getColor(d))\n        .attr(\"id\", (d: number) => `cp_${d}`)\n        .style(\"stroke-width\", 2)\n        .on(\"mouseover\", (_: Event, d: number) => {\n          if (this.#contacts?.isHold) return;\n          this._dispatchSelectNode(d);\n          this.refreshSelected();\n        })\n        .on(\"mouseout\", () => {\n          if (!this.#contacts || this.#contacts?.isHold) return;\n          this.#contacts.selected = undefined;\n          this.dispatchEvent(getHighlightEvent(\"mouseout\", this));\n          this.refreshSelected();\n        })\n        .on(\"click\", (event: Event, d: number) => {\n          event.preventDefault();\n          if (!this.#contacts) return;\n          this.#contacts.isHold = true;\n          this._dispatchSelectNode(d);\n          this.refreshSelected();\n        });\n    this._linksData = contactObjectToLinkList(this.#contacts.contacts);\n  }\n\n  getRadius(isSelected: boolean): number {\n    return (\n      (isSelected ? 0.6 : 0.4) *\n      Math.max(2, Math.min(this.height, this.getSingleBaseWidth()))\n    );\n  }\n\n  arc(d: number[]): string {\n    const x1 = this.getXFromSeqPosition(d[0]) + this.getSingleBaseWidth() / 2;\n    const x2 = this.getXFromSeqPosition(d[1]) + this.getSingleBaseWidth() / 2;\n    const h = this.height * 0.5;\n    const p = this.getSingleBaseWidth();\n    return `M ${x1} ${h} C ${x1 - p} ${-h / 4} ${x2 + p} ${-h / 4} ${x2} ${h}`;\n  }\n\n  refreshSelected(): void {\n    if (!this.#contacts || !this.contactPoints) return;\n    this.contactPoints\n      .transition()\n      .attr(\"r\", (d: number) =>\n        this.getRadius(\n          d === this.#contacts?.selected ||\n            this.#contacts?.contacts[d].has(this.#contacts?.selected || 0) ||\n            false,\n        ),\n      )\n      .attr(\"stroke\", (d: number) =>\n        d === this.#contacts?.selected && this.#contacts.isHold\n          ? \"rgb(127 255 127)\"\n          : null,\n      )\n      .style(\"opacity\", (d: number) =>\n        d === this.#contacts?.selected ? 1 : OPACITY_MOUSEOUT,\n      );\n    const selectedLinks = this.#contacts.selected\n      ? this._linksData?.filter((link) =>\n          link.includes(+(this.#contacts?.selected || 0)),\n        ) || []\n      : [];\n\n    const links = this.seqG\n      ?.selectAll<SVGAElement, ArrayOfNumberArray>(\"g.links-group\")\n      .selectAll(\".contact-link\")\n      .data(selectedLinks, (x: unknown) => {\n        const n1 = (x as number[])[0];\n        const n2 = (x as number[])[1];\n        return `${n1}_${n2}`;\n      });\n\n    links?.exit().remove();\n    links\n      ?.enter()\n      .append(\"path\")\n      .attr(\"class\", \"contact-link\")\n      .attr(\"fill\", \"transparent\")\n      .attr(\"stroke\", this._getColor(this.#contacts?.selected || 0))\n      .attr(\"stroke-width\", this.#contacts.isHold ? 3 : 1)\n      .style(\"opacity\", 1)\n      .style(\"pointer-events\", \"none\")\n      .attr(\"d\", (d: number[]) => this.arc(d))\n      .attr(\"id\", ([n1, n2]: Array<number>) => `cn_${n1}_${n2}`);\n\n    links\n      ?.attr(\"d\", (d: number[]) => this.arc(d))\n      .attr(\"stroke-width\", this.#contacts.isHold ? 3 : 1);\n  }\n  refresh(): void {\n    if (!this.#contacts || !this.contactPoints) return;\n    this.contactPoints\n      .attr(\n        \"cx\",\n        (d: number) =>\n          this.getXFromSeqPosition(d) + this.getSingleBaseWidth() / 2,\n      )\n      .attr(\"cy\", this.height * 0.5);\n\n    this.refreshSelected();\n  }\n}\n\nexport default NightingaleLinks;\n","import { customElement, property, state } from \"lit/decorators.js\";\nimport NightingaleElement from \"@nightingale-elements/nightingale-new-core\";\n\n@customElement(\"nightingale-manager\")\nclass NightingaleManager extends NightingaleElement {\n  @property({\n    converter: {\n      fromAttribute: (value): Map<string, null> | null => {\n        if (!value) {\n          return null;\n        }\n        const attributes = value.split(\",\");\n        if (attributes.indexOf(\"type\") !== -1)\n          throw new Error(\"'type' can't be used as a protvista attribute\");\n        if (attributes.indexOf(\"value\") !== -1)\n          throw new Error(\"'value' can't be used as a protvista attribute\");\n        const mapToReturn = new Map(\n          attributes\n            .filter(\n              (attr: string) =>\n                !NightingaleManager.observedAttributes.includes(attr),\n            )\n            .map((attr: string) => [attr, null]),\n        );\n        return mapToReturn;\n      },\n      toAttribute: (value: []) => {\n        return value.join(\",\");\n      },\n    },\n  })\n  \"reflected-attributes\"?: Map<string, null> = new Map();\n\n  @property({ type: Number })\n  length?: number;\n\n  @property({ type: Number })\n  \"display-start\"?: number;\n\n  @property({ type: Number })\n  \"display-end\"?: number;\n\n  @property({ type: String })\n  \"highlight\"?: string;\n\n  @state()\n  protvistaElements = new Set<HTMLElement>();\n\n  @state()\n  propertyValues = new Map<string, string>();\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener(\"change\", this.changeListener as EventListener);\n    this.style.display = \"unset\";\n  }\n\n  override attributeChangedCallback(\n    attr: string,\n    previousValue: string | null,\n    newValue: string | null,\n  ) {\n    super.attributeChangedCallback(attr, previousValue, newValue);\n    this.applyAttributes();\n  }\n\n  applyAttributes() {\n    this.protvistaElements.forEach((element: HTMLElement) => {\n      this[\"reflected-attributes\"]?.forEach((value, type) => {\n        if (value === false || value === null || value === undefined) {\n          element.removeAttribute(type);\n        } else {\n          element.setAttribute(type, typeof value === \"boolean\" ? \"\" : value);\n        }\n      });\n      // Default properties\n      if (this.length) {\n        element.setAttribute(\"length\", `${this.length}`);\n      }\n      if (this[\"display-end\"]) {\n        element.setAttribute(\"display-end\", `${this[\"display-end\"]}`);\n      }\n      if (this[\"display-start\"]) {\n        element.setAttribute(\"display-start\", `${this[\"display-start\"]}`);\n      }\n      if (this.highlight) {\n        element.setAttribute(\"highlight\", this.highlight);\n      }\n    });\n  }\n\n  register(element: NightingaleElement) {\n    this.protvistaElements.add(element);\n    this.applyAttributes();\n  }\n\n  unregister(element: NightingaleElement) {\n    this.protvistaElements.delete(element);\n  }\n\n  applyProperties(forElementId: string) {\n    if (forElementId) {\n      const element = this.querySelector(`#${forElementId}`) as HTMLElement;\n      if (!element) {\n        return;\n      }\n      this.propertyValues.forEach((value, type) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (element as any)[type] = value;\n      });\n    } else {\n      this.protvistaElements.forEach((element: HTMLElement) => {\n        if (!element) {\n          return;\n        }\n        this.propertyValues.forEach((value, type) => {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (element as any)[type] = value;\n        });\n      });\n    }\n  }\n\n  isRegisteredAttribute(attributeName: string) {\n    if (!this[\"reflected-attributes\"]) {\n      return false;\n    }\n    return (\n      [...this[\"reflected-attributes\"].keys()].includes(attributeName) ||\n      NightingaleManager.observedAttributes.includes(attributeName)\n    );\n  }\n\n  changeListener(e: CustomEvent) {\n    if (!e.detail) {\n      return;\n    }\n    switch (e.detail.handler) {\n      case \"property\":\n        this.propertyValues.set(e.detail.type, e.detail.value);\n        this.applyProperties(e.detail.for);\n        break;\n      default:\n        if (this.isRegisteredAttribute(e.detail.type)) {\n          this[\"reflected-attributes\"]?.set(e.detail.type, e.detail.value);\n        }\n        Object.keys(e.detail).forEach((key) => {\n          if (this.isRegisteredAttribute(key)) {\n            this[\"reflected-attributes\"]?.set(key, e.detail[key]);\n          }\n        });\n        this.applyAttributes();\n    }\n  }\n}\n\nexport default NightingaleManager;\n","import NightingaleManager from \"./nightingale-manager\";\nexport default NightingaleManager;\n","import baseClamp from './_baseClamp.js';\nimport toNumber from './toNumber.js';\n\n/**\n * Clamps `number` within the inclusive `lower` and `upper` bounds.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Number\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n * @example\n *\n * _.clamp(-10, -5, 5);\n * // => -5\n *\n * _.clamp(10, -5, 5);\n * // => 5\n */\nfunction clamp(number, lower, upper) {\n  if (upper === undefined) {\n    upper = lower;\n    lower = undefined;\n  }\n  if (upper !== undefined) {\n    upper = toNumber(upper);\n    upper = upper === upper ? upper : 0;\n  }\n  if (lower !== undefined) {\n    lower = toNumber(lower);\n    lower = lower === lower ? lower : 0;\n  }\n  return baseClamp(toNumber(number), lower, upper);\n}\n\nexport default clamp;\n","/**\n * The base implementation of `_.clamp` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to clamp.\n * @param {number} [lower] The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the clamped number.\n */\nfunction baseClamp(number, lower, upper) {\n  if (number === number) {\n    if (upper !== undefined) {\n      number = number <= upper ? number : upper;\n    }\n    if (lower !== undefined) {\n      number = number >= lower ? number : lower;\n    }\n  }\n  return number;\n}\n\nexport default baseClamp;\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","import root from './_root.js';\nimport toInteger from './toInteger.js';\nimport toNumber from './toNumber.js';\nimport toString from './toString.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsFinite = root.isFinite,\n    nativeMin = Math.min;\n\n/**\n * Creates a function like `_.round`.\n *\n * @private\n * @param {string} methodName The name of the `Math` method to use when rounding.\n * @returns {Function} Returns the new round function.\n */\nfunction createRound(methodName) {\n  var func = Math[methodName];\n  return function(number, precision) {\n    number = toNumber(number);\n    precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n    if (precision && nativeIsFinite(number)) {\n      // Shift with exponential notation to avoid floating-point issues.\n      // See [MDN](https://mdn.io/round#Examples) for more details.\n      var pair = (toString(number) + 'e').split('e'),\n          value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n      pair = (toString(value) + 'e').split('e');\n      return +(pair[0] + 'e' + (+pair[1] - precision));\n    }\n    return func(number);\n  };\n}\n\nexport default createRound;\n","import createRound from './_createRound.js';\n\n/**\n * Computes `number` rounded down to `precision`.\n *\n * @static\n * @memberOf _\n * @since 3.10.0\n * @category Math\n * @param {number} number The number to round down.\n * @param {number} [precision=0] The precision to round down to.\n * @returns {number} Returns the rounded down number.\n * @example\n *\n * _.floor(4.006);\n * // => 4\n *\n * _.floor(0.046, 2);\n * // => 0.04\n *\n * _.floor(4060, -2);\n * // => 4000\n */\nvar floor = createRound('floor');\n\nexport default floor;\n","const object2style = (object: Record<string, unknown>): string =>\n  Object.entries(object)\n    .map(([k, v]) => `${k}: ${v};`)\n    .join(\" \");\n\nexport default object2style;\n","import { LitElement, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\nimport object2style from \"../../utils/object2style\";\n\n/**\n * Creates a DOM element with absolute position that can have scrollbars.\n * However, no actual content is displayed by this element.\n */\n@customElement(\"fake-scroll\")\nclass FakeScroll extends LitElement {\n  @property({ type: String })\n  overflow: \"hidden\" | \"auto\" | \"scroll\" = \"auto\";\n  @property({ type: String })\n  overflowX: \"hidden\" | \"auto\" | \"scroll\" | \"initial\" = \"initial\";\n  @property({ type: String })\n  overflowY: \"hidden\" | \"auto\" | \"scroll\" | \"initial\" = \"initial\";\n  @property({ type: Number })\n  width = 0;\n  @property({ type: Number })\n  height = 0;\n  @property({ type: Number })\n  fullHeight = 0;\n  @property({ type: Number })\n  fullWidth = 0;\n  @property({ type: String })\n  positionX: \"top\" | \"bottom\" = \"bottom\";\n  @property({ type: String })\n  positionY: \"left\" | \"right\" = \"right\";\n\n  el?: HTMLDivElement | null;\n\n  _x = 0;\n  set x(value: number) {\n    this._x = Number(value);\n    if (this.el) {\n      this.el.scrollLeft = this.x;\n    }\n  }\n  @property()\n  get x() {\n    return this._x;\n  }\n  _y = 0;\n  set y(value: number) {\n    this._y = Number(value);\n    if (this.el) {\n      this.el.scrollTop = this._y;\n    }\n  }\n  @property()\n  get y() {\n    return this._y;\n  }\n\n  onScroll = (e: Event) => {\n    const { showX, showY } = this.shouldShow();\n    const movement = {\n      xMovement: (this.el?.scrollLeft || 0) - (showX ? this.x : 0),\n      yMovement: (this.el?.scrollTop || 0) - (showY ? this.y : 0),\n    };\n\n    if (movement.xMovement !== 0 || movement.yMovement !== 0)\n      this.dispatchEvent(\n        new CustomEvent(\"fake-scroll\", {\n          bubbles: true,\n          detail: {\n            movement,\n            sourceEvent: e,\n          },\n        }),\n      );\n  };\n\n  checkOverflow(\n    overflow: \"hidden\" | \"auto\" | \"scroll\",\n    { withX = false, withY = false },\n  ) {\n    let show = false;\n    switch (overflow) {\n      case \"auto\":\n        if (withX) {\n          show = this.fullWidth > this.width;\n        }\n        if (withY) {\n          show = this.fullHeight > this.height;\n        }\n        break;\n      case \"hidden\":\n        show = false;\n        break;\n      case \"scroll\":\n        show = true;\n        break;\n      default:\n    }\n    return show;\n  }\n\n  shouldShow() {\n    const withX = { withX: true };\n    const withY = { withY: true };\n    const overflowX =\n      this.overflowX === \"initial\" ? this.overflow : this.overflowX;\n    const overflowY =\n      this.overflowY === \"initial\" ? this.overflow : this.overflowY;\n    const showX =\n      this.checkOverflow(overflowX, withX) &&\n      this.checkOverflow(this.overflow, withX);\n    const showY =\n      this.checkOverflow(overflowY, withY) &&\n      this.checkOverflow(this.overflow, withY);\n    return { showX, showY };\n  }\n\n  render() {\n    const style = {\n      position: \"absolute\",\n      \"overflow-x\": \"auto\",\n      \"overflow-y\": \"auto\",\n      width: `${this.width}px`,\n      height: `${this.height}px`,\n      transform: \"\",\n    };\n    const { showX, showY } = this.shouldShow();\n    const childStyle = {\n      height: \"1px\",\n      width: \"1px\",\n    };\n    if (!showY && !showX) {\n      return html`<div />`;\n    }\n    if (showX) {\n      childStyle.width = `${this.fullWidth}px`;\n      style[\"overflow-x\"] = \"scroll\";\n      if (this.positionX === \"top\") {\n        style.transform += \"rotateX(180deg)\";\n      }\n    }\n    if (showY) {\n      childStyle.height = `${this.fullHeight}px`;\n      style[\"overflow-y\"] = \"scroll\";\n      if (this.positionY === \"left\") {\n        style.transform += \"rotateY(180deg)\";\n      }\n    }\n    return html`<div style=${object2style(style)} id=\"fakescroll\">\n      <div style=${object2style(childStyle)}></div>\n    </div> `;\n  }\n  protected updated(): void {\n    const fakescroll = this.renderRoot.querySelector(\"#fakescroll\");\n    if (fakescroll !== this.el) {\n      this.el = fakescroll as HTMLDivElement;\n      if (this.el) {\n        this.el.addEventListener(\"scroll\", this.onScroll);\n      }\n    }\n  }\n}\n\nexport default FakeScroll;\n","import { html } from \"lit\";\nimport { state } from \"lit/decorators.js\";\nimport NightingaleElement, {\n  withDimensions,\n  withZoom,\n  withPosition,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nimport { RawPosition } from \"../../types/types\";\nimport \"./FakeScroll\";\nimport object2style from \"../../utils/object2style\";\nimport { select } from \"d3\";\n/**\nSub-classes are expected to implement:\n- drawScene\n- onPositionUpdate(oldPos, newPos)\n\n*/\nabstract class DraggingComponent extends withZoom(\n  withPosition(withDimensions(NightingaleElement)),\n) {\n  \"use-ctrl-to-zoom\" = true;\n  \"margin-right\" = 0;\n  \"margin-left\" = 0;\n\n  @state()\n  mouse = {\n    isMouseWithin: false,\n    cursorState: \"grab\",\n  };\n  @state()\n  fullWidth = 0;\n  @state()\n  fullHeight = 0;\n  @state()\n  x = 0;\n  @state()\n  y = 0;\n\n  protected uniqueId = `msa-${Math.round(Math.random() * 10000)}`;\n  protected ctxBuffers: (CanvasRenderingContext2D | null)[] = [];\n  protected ctx: CanvasRenderingContext2D | null = null;\n  protected canvasBuffers: HTMLCanvasElement[] = [];\n  protected container?: HTMLElement | null;\n  protected currentContext = 1;\n\n  protected isInDragPhase = false;\n  protected mouseHasMoved = false;\n  protected mouseMovePosition?: RawPosition = undefined;\n\n  /**\n   * Called on every movement to rerender the canvas.\n   */\n  abstract drawScene(): void;\n\n  /**\n   * Called on every position update.\n   */\n  abstract onPositionUpdate(\n    newPosition?: RawPosition,\n    oldPosition?: RawPosition,\n  ): void;\n\n  firstUpdated() {\n    this.container = document.getElementById(this.uniqueId);\n    window.requestAnimationFrame(() => {\n      this.svg = select(this).select(\"div\");\n    });\n\n    this.canvasBuffers = [\n      document.getElementById(`${this.uniqueId}-0`) as HTMLCanvasElement,\n      document.getElementById(`${this.uniqueId}-1`) as HTMLCanvasElement,\n    ];\n    this.ctxBuffers = this.canvasBuffers.map(\n      (buffer) =>\n        buffer.getContext(\"2d\", { alpha: \"false\" }) as CanvasRenderingContext2D,\n    );\n    // init\n    this.swapContexts();\n  }\n\n  /**\n   * We buffer the canvas to display and allow to be redrawn while not being visible.\n   * Only after it has been drawn, the canvas element will be flipped to a visible state.\n   * In other words, we have two canvas elements (1 visible, 1 hidden) and\n   * a new `draw` happens on the hidden one. After a `draw` operation these canvas\n   * elements are \"swapped\" by this method.\n   *\n   * This method swaps the visibility of the DOM nodes and sets `this.ctx`\n   * to the hidden canvas.\n   */\n  swapContexts() {\n    const current = this.currentContext;\n    // show the pre-rendered buffer\n    this.canvasBuffers[current].style.visibility = \"visible\";\n\n    // and prepare the next one\n    const next = (this.currentContext + 1) % 2;\n    this.canvasBuffers[next].style.visibility = \"hidden\";\n    this.currentContext = next;\n    this.ctx = this.ctxBuffers[next];\n  }\n\n  /**\n   * Starts a draw operation by essentially:\n   * - clearing the current context (the hidden canvas)\n   * - calling `drawScene` to render the current canvas\n   * - swapping canvas contexts with `swapContexts`\n   */\n  draw() {\n    if (!this.ctx) return;\n    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n    this.drawScene();\n    this.swapContexts();\n  }\n\n  zoomRefreshed() {\n    this.handleZooomChanged();\n  }\n  abstract handleZooomChanged(): void;\n\n  render() {\n    const style = {\n      width: `${this.width}px`,\n      height: `${this.height}px`,\n      cursor: this.mouse.cursorState,\n      position: \"relative\",\n      flexShrink: 0,\n    };\n    const canvasStyle = {\n      position: \"absolute\",\n      left: 0,\n      top: 0,\n    };\n    return html`\n      <div id=${this.uniqueId} style=${object2style(style)}>\n        <canvas\n          style=${object2style(canvasStyle)}\n          id=${`${this.uniqueId}-0`}\n          width=${this.width}\n          height=${this.height}\n        >\n          Your browser does not seem to support HTML5 canvas.\n        </canvas>\n        <canvas\n          style=${object2style(canvasStyle)}\n          id=${`${this.uniqueId}-1`}\n          width=${this.width}\n          height=${this.height}\n        >\n          Your browser does not seem to support HTML5 canvas.\n        </canvas>\n        <fake-scroll\n          overflowX=\"hidden\"\n          overflowY=\"initial\"\n          width=${this.width}\n          height=${this.height}\n          fullWidth=${this.fullWidth}\n          fullHeight=${this.fullHeight}\n          x=${this.x}\n          y=${this.y}\n        ></fake-scroll>\n      </div>\n    `;\n  }\n}\n\nexport default DraggingComponent;\n","import CanvasCache from \"./CanvasCache\";\nimport ColorScheme from \"../../utils/ColorScheme\";\nimport { ConservationManager, SequencesType } from \"../../types/types\";\n\ntype TilingGridOptions = {\n  ctx: CanvasRenderingContext2D;\n  startYTile: number;\n  startXTile: number;\n  endYTile: number;\n  endXTile: number;\n  tileWidth: number;\n  tileHeight: number;\n  sequences: SequencesType;\n  //TODO: correct this types when migrated\n  residueTileCache: CanvasCache;\n  colorScheme: ColorScheme;\n  overlayConservation?: boolean;\n  conservation?: ConservationManager | null;\n  border: boolean;\n  borderWidth: number;\n  borderColor: string;\n  textColor: string;\n  textFont: string;\n};\n\nconst aLetterOffset = \"A\".charCodeAt(0);\nconst lettersInAlphabet = 26;\n\n/**\n * Allows rendering in tiles of grids.\n *\n * |---|---|---|\n * |-1-|-2-|-3-|\n * |---|---|---|\n * \n * |---|---|---|\n * |-4-|-5-|-6-|\n * |---|---|---|\n *\n * where 1..6 are TilingGrid component of xGridSize and yGridSize of 3.\n *\n * This split-up is required to avoid frequent repaints and keeps the React\n * Tree calculations slim.\n */\n\nclass CanvasTilingGridComponent {\n  private props?: TilingGridOptions;\n\n  drawTile({ row, column }: { row: number; column: number }) {\n    if (!this.props) return;\n    const tileWidth = this.props.tileWidth;\n    const tileHeight = this.props.tileHeight;\n    const yPos = tileHeight * (row - this.props.startYTile);\n    const xPos = tileWidth * (column - this.props.startXTile);\n    if (row >= this.props.sequences.raw.length) return undefined;\n    const sequence = this.props.sequences.raw[row].sequence;\n    if (column >= sequence.length) return undefined;\n    const text = sequence[column];\n    if (text !== undefined) {\n      const colorSchemeName = this.props.colorScheme.getColor(text, column);\n      const overlayFactor = this.getOverlayFactor(text, column);\n      const key = `${text}-${colorSchemeName}-${overlayFactor}`;\n      const canvasTile = this.props.residueTileCache.createTile({\n        key,\n        tileWidth,\n        tileHeight,\n        create: ({ ctx }) => {\n          return this.drawResidue({\n            text,\n            canvas: ctx,\n            // row,\n            // column,\n            colorSchemeName,\n            overlayFactor,\n          });\n        },\n      });\n      this.props.ctx.drawImage(\n        canvasTile,\n        0,\n        0,\n        tileWidth,\n        tileHeight,\n        xPos,\n        yPos,\n        tileWidth,\n        tileHeight,\n      );\n    }\n  }\n\n  getOverlayFactor(text: string, column: number) {\n    if (!this.props?.overlayConservation || !this.props.conservation) return 1;\n\n    const letterIndex = text.charCodeAt(0) - aLetterOffset;\n    if (letterIndex < 0 || letterIndex >= lettersInAlphabet) {\n      // outside of bounds of \"A\" to \"Z\", ignore\n      return 0;\n    }\n    const raw =\n      this.props.conservation.map[column * lettersInAlphabet + letterIndex] ||\n      0;\n\n    return Math.floor(raw * 5) / 5.0;\n  }\n\n  drawResidue({\n    // row,\n    // column,\n    canvas,\n    colorSchemeName,\n    text,\n    overlayFactor = 1,\n  }: {\n    // row: number;\n    // column: number;\n    canvas: CanvasRenderingContext2D;\n    colorSchemeName: string;\n    text: string;\n    overlayFactor: number;\n  }) {\n    if (!this.props) return;\n    canvas.globalAlpha = 0.7 * overlayFactor;\n    canvas.fillStyle = colorSchemeName;\n    canvas.fillRect(0, 0, this.props.tileWidth, this.props.tileHeight);\n    const minW = 4;\n    const fullOpacityW = 10;\n    if (this.props.tileWidth < minW) return;\n\n    if (this.props.border) {\n      canvas.globalAlpha = 1;\n      canvas.lineWidth = this.props.borderWidth;\n      canvas.strokeStyle = this.props.borderColor;\n      canvas.strokeRect(0, 0, this.props.tileWidth, this.props.tileHeight);\n    }\n    const m = 1.0 / (fullOpacityW - minW);\n    const b = -m * minW;\n    canvas.globalAlpha = Math.min(1, m * this.props.tileWidth + b);\n    // 1.0;\n    canvas.fillStyle = this.props.textColor;\n    canvas.font = this.props.textFont;\n    canvas.textBaseline = \"middle\";\n    canvas.textAlign = \"center\";\n    canvas.fillText(\n      text,\n      this.props.tileWidth / 2,\n      this.props.tileHeight / 2 + 1,\n      this.props.tileWidth,\n    );\n  }\n\n  draw(props: TilingGridOptions) {\n    this.props = props;\n    for (let i = this.props.startYTile; i < this.props.endYTile; i++) {\n      for (let j = this.props.startXTile; j < this.props.endXTile; j++) {\n        this.drawTile({ row: i, column: j });\n      }\n    }\n  }\n}\n\nexport default CanvasTilingGridComponent;\n","/**\n * The base implementation of `_.lt` which doesn't coerce arguments.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is less than `other`,\n *  else `false`.\n */\nfunction baseLt(value, other) {\n  return value < other;\n}\n\nexport default baseLt;\n","import baseExtremum from './_baseExtremum.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseLt from './_baseLt.js';\n\n/**\n * This method is like `_.min` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * the value is ranked. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Math\n * @param {Array} array The array to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {*} Returns the minimum value.\n * @example\n *\n * var objects = [{ 'n': 1 }, { 'n': 2 }];\n *\n * _.minBy(objects, function(o) { return o.n; });\n * // => { 'n': 1 }\n *\n * // The `_.property` iteratee shorthand.\n * _.minBy(objects, 'n');\n * // => { 'n': 1 }\n */\nfunction minBy(array, iteratee) {\n  return (array && array.length)\n    ? baseExtremum(array, baseIteratee(iteratee, 2), baseLt)\n    : undefined;\n}\n\nexport default minBy;\n","import isSymbol from './isSymbol.js';\n\n/**\n * The base implementation of methods like `_.max` and `_.min` which accepts a\n * `comparator` to determine the extremum value.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The iteratee invoked per iteration.\n * @param {Function} comparator The comparator used to compare values.\n * @returns {*} Returns the extremum value.\n */\nfunction baseExtremum(array, iteratee, comparator) {\n  var index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    var value = array[index],\n        current = iteratee(value);\n\n    if (current != null && (computed === undefined\n          ? (current === current && !isSymbol(current))\n          : comparator(current, computed)\n        )) {\n      var computed = current,\n          result = value;\n    }\n  }\n  return result;\n}\n\nexport default baseExtremum;\n","import { minBy, isEqual } from \"lodash-es\";\nimport { ResidueTileOptions, TileOptions } from \"../../types/types\";\n\n// type TileOptions = Record<string, string | number | object>;\n/**\n * A simple, in-memory cache for Canvas tiles outside of the DOM.\n * Gets automatically invalidated when called with different widths.\n * If `maxElements` are exceed, the oldest element (by insertion time) will be\n * removed from the cache.\n *\n * @param {Number} maxElements Maximal elements to keep in the cache (default: 200)\n */\nclass CanvasCache {\n  private maxElements: number;\n  private cache: Record<\n    string,\n    {\n      value: HTMLCanvasElement;\n      insertionTime: number;\n    }\n  > = {};\n  private spec: ResidueTileOptions | TileOptions | {} = {};\n  private cachedElements = 0;\n\n  constructor({ maxElements }: { maxElements?: number } = {}) {\n    this.maxElements = maxElements || 200;\n    this.invalidate();\n  }\n\n  /**\n   * Creates a canvas element outside of the DOM that can be used for caching.\n   * @param {string} key Unique cache key of the element\n   * @param {Number} tileWidth Width of the to be created canvas\n   * @param {Number} tileWidth Width of the to be created canvas\n   * @param {function} create Callback to be called if for the given `key` to canvas exists in the cache\n   */\n  createTile({\n    key,\n    tileWidth,\n    tileHeight,\n    create,\n  }: {\n    key: string;\n    tileWidth: number;\n    tileHeight: number;\n    create: ({ ctx }: { ctx: CanvasRenderingContext2D }) => void;\n  }): HTMLCanvasElement {\n    // check if cache needs to be regenerated\n    if (key in this.cache) {\n      return this.cache[key].value;\n    }\n    if (this.cachedElements >= this.maxElements) {\n      // purge oldest key from cache if maxSize is reached\n      const oldestKey = minBy(\n        Object.keys(this.cache),\n        (k) => this.cache[k].insertionTime,\n      );\n      if (oldestKey) delete this.cache[oldestKey];\n    }\n    const canvas = document.createElement(\"canvas\");\n    this.cache[key] = {\n      value: canvas,\n      insertionTime: Date.now(),\n    };\n    canvas.width = tileWidth;\n    canvas.height = tileHeight;\n    const ctx = canvas.getContext(\"2d\");\n    this.cachedElements++;\n\n    if (ctx) create({ ctx });\n    return canvas;\n  }\n\n  /**\n   * Checks whether the tile specification has changed and the cache needs\n   * to be refreshed.\n   * Pass in an object of all the properties that would result in the cache to be refreshed\n   * Like React.PureComponents the passed-in properties are compared by their\n   * shallow equality.\n   *\n   * @param {object} spec Object of all parameters that depend on this cache\n   * Returns: `true` when the cache has been invalidated\n   */\n  updateTileSpecs(spec: ResidueTileOptions) {\n    if (!isEqual(this.spec, spec)) {\n      this.invalidate();\n      this.spec = spec;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Invalidates the entire cache and removed all elements.\n   */\n  invalidate() {\n    this.cache = {};\n    this.spec = {};\n    this.cachedElements = 0;\n  }\n}\n\nexport default CanvasCache;\n","import { RawPosition } from \"../types/types\";\n\nclass Mouse {\n  static relative = function (\n    event: MouseEvent | TouchEvent | Touch,\n  ): RawPosition {\n    if ((event as TouchEvent).changedTouches !== undefined)\n      return Mouse.relative((event as TouchEvent).changedTouches[0]);\n\n    const e = event as MouseEvent;\n    let mouseX = e.offsetX;\n    let mouseY = e.offsetY;\n    if (mouseX === undefined) {\n      const target = e.target as HTMLElement;\n      const rect = target.getBoundingClientRect();\n      mouseX = e.clientX - rect.left;\n      mouseY = e.clientY - rect.top;\n      if (mouseX === undefined) {\n        mouseX = e.pageX - target.offsetLeft;\n        mouseY = e.pageY - target.offsetTop;\n        if (mouseX === undefined) {\n          console.log(e, \"No mouse event defined.\");\n          return { xPos: -1, yPos: -1 };\n        }\n      }\n    }\n    return { xPos: mouseX, yPos: mouseY };\n  };\n\n  static absolute = function (\n    event: MouseEvent | TouchEvent | Touch,\n  ): RawPosition {\n    if ((event as TouchEvent).changedTouches !== undefined)\n      //return Mouse.abs(e.changedTouches[e.targetTouches.length - 1]);\n      return Mouse.absolute((event as TouchEvent).changedTouches[0]);\n\n    const e = event as MouseEvent;\n    let mouseX = e.pageX;\n    let mouseY = e.pageY;\n    if (mouseX === undefined) {\n      mouseX = e.offsetX;\n      mouseY = e.offsetY;\n    }\n    if (mouseX === undefined) {\n      mouseX = e.clientX;\n      mouseY = e.clientY;\n    }\n    if (mouseX === undefined) {\n      mouseX = e.x;\n      mouseY = e.y;\n    }\n    return { xPos: mouseX, yPos: mouseY };\n  };\n\n  static wheelDelta = function (e: WheelEvent) {\n    let delta = [e.deltaX, e.deltaY];\n    if (delta[0] === undefined) {\n      // in case there is a more detailed scroll sensor - use it\n      if (e.movementX) {\n        delta = [e.movementX, e.movementY];\n      }\n    }\n    // safety first\n    if (isNaN(delta[0])) {\n      delta[0] = 0;\n    }\n    if (isNaN(delta[1])) {\n      delta[1] = 0;\n    }\n    return delta;\n  };\n}\n\nexport default Mouse;\n","/**\n * @param {Number} number\n * @param {Number} mod\n * @returns {Number} number - number % mod (the number rounded by its modulo\n *\n * Example:\n *\n * 25 % 5 = 25\n * 26 % 5 = 25\n * 31 % 5 = 30\n */\nexport function roundMod(number: number, mod: number): number {\n  return number - (number % mod);\n}\n","export class StaticSchemeClass {\n  defaultColor = \"#ffffff\";\n  type = \"static\";\n  map: Record<string, string>;\n  constructor(map: Record<string, string>) {\n    this.map = map;\n  }\n  getColor(letter: string) {\n    if (this.map[letter] !== undefined) {\n      return this.map[letter];\n    } else {\n      return this.defaultColor;\n    }\n  }\n}\n\ntype BaseColorFunction = (base: string, ...args: unknown[]) => string;\n\nexport type ColorStructure = {\n  init: () => void;\n  run: BaseColorFunction;\n  map: Record<string, string>;\n};\ntype ColorFunction = ColorStructure | BaseColorFunction;\n\nexport class DynSchemeClass {\n  type = \"dyn\";\n  opt?: unknown;\n  getColor: BaseColorFunction;\n  reset?: () => void;\n  map?: Record<string, string>;\n\n  constructor(fun: ColorFunction, opt?: unknown) {\n    this.opt = opt;\n    const funCS = fun as ColorStructure;\n    if (funCS.init !== undefined) {\n      funCS.init.call(this);\n      this.getColor = funCS.run;\n      this.reset = funCS.init;\n      this.map = funCS.map;\n    } else {\n      this.getColor = fun as BaseColorFunction;\n    }\n  }\n}\n","export default {\n  A: \"#00639a\",\n  V: \"#00639a\",\n  L: \"#00639a\",\n  I: \"#00639a\",\n  P: \"#00639a\",\n};\n","export default {\n  A: \"#00a35c\",\n  R: \"#00fc03\",\n  N: \"#00eb14\",\n  D: \"#00eb14\",\n  C: \"#0000ff\",\n  Q: \"#00f10e\",\n  E: \"#00f10e\",\n  G: \"#009d62\",\n  H: \"#00d52a\",\n  I: \"#0054ab\",\n  L: \"#007b84\",\n  K: \"#00ff00\",\n  M: \"#009768\",\n  F: \"#008778\",\n  P: \"#00e01f\",\n  S: \"#00d52a\",\n  T: \"#00db24\",\n  W: \"#00a857\",\n  Y: \"#00e619\",\n  V: \"#005fa0\",\n  B: \"#00eb14\",\n  X: \"#00b649\",\n  Z: \"#00f10e\",\n};\n","export default {\n  A: \"#e718e7\",\n  R: \"#6f906f\",\n  N: \"#1be41b\",\n  D: \"#778877\",\n  C: \"#23dc23\",\n  Q: \"#926d92\",\n  E: \"#ff00ff\",\n  G: \"#00ff00\",\n  H: \"#758a75\",\n  I: \"#8a758a\",\n  L: \"#ae51ae\",\n  K: \"#a05fa0\",\n  M: \"#ef10ef\",\n  F: \"#986798\",\n  P: \"#00ff00\",\n  S: \"#36c936\",\n  T: \"#47b847\",\n  W: \"#8a758a\",\n  Y: \"#21de21\",\n  V: \"#857a85\",\n  B: \"#49b649\",\n  X: \"#758a75\",\n  Z: \"#c936c9\",\n};\n","export default {\n  A: \" #FF83FA\",\n  C: \" #40E0D0\",\n  G: \" #FF83FA\",\n  R: \" #FF83FA\",\n  T: \" #40E0D0\",\n  U: \" #40E0D0\",\n  Y: \" #40E0D0\",\n};\n","export default {\n  A: \"#5858a7\",\n  R: \"#6b6b94\",\n  N: \"#64649b\",\n  D: \"#2121de\",\n  C: \"#9d9d62\",\n  Q: \"#8c8c73\",\n  E: \"#0000ff\",\n  G: \"#4949b6\",\n  H: \"#60609f\",\n  I: \"#ecec13\",\n  L: \"#b2b24d\",\n  K: \"#4747b8\",\n  M: \"#82827d\",\n  F: \"#c2c23d\",\n  P: \"#2323dc\",\n  S: \"#4949b6\",\n  T: \"#9d9d62\",\n  W: \"#c0c03f\",\n  Y: \"#d3d32c\",\n  V: \"#ffff00\",\n  B: \"#4343bc\",\n  X: \"#797986\",\n  Z: \"#4747b8\",\n};\n","export default {\n  A: \"#2cd3d3\",\n  R: \"#708f8f\",\n  N: \"#ff0000\",\n  D: \"#e81717\",\n  C: \"#a85757\",\n  Q: \"#3fc0c0\",\n  E: \"#778888\",\n  G: \"#ff0000\",\n  H: \"#708f8f\",\n  I: \"#00ffff\",\n  L: \"#1ce3e3\",\n  K: \"#7e8181\",\n  M: \"#1ee1e1\",\n  F: \"#1ee1e1\",\n  P: \"#f60909\",\n  S: \"#e11e1e\",\n  T: \"#738c8c\",\n  W: \"#738c8c\",\n  Y: \"#9d6262\",\n  V: \"#07f8f8\",\n  B: \"#f30c0c\",\n  X: \"#7c8383\",\n  Z: \"#5ba4a4\",\n};\n","import { ConservationManager } from \"../types/types\";\nimport { ColorStructure } from \"./schemeclass\";\n\nconst aLetterOffset = \"A\".charCodeAt(0);\nconst lettersInAlphabet = 26;\nconst gaps = new Set([\"\", \" \", \"-\", \"_\", \".\"]);\n\nconst pid: ColorStructure = {\n  // calculating the conservation is expensive\n  // we only want to do it once\n  init: function () {},\n  run: function (baseRaw: string, ...args: unknown[]) {\n    const pos = args[0] as number;\n    const base = baseRaw.toUpperCase();\n    const conservation = args[1] as ConservationManager;\n    if (\n      !conservation ||\n      conservation.progress !== 1 ||\n      gaps.has(base) ||\n      pos > conservation.map.length / lettersInAlphabet\n    )\n      return \"#ffffff\";\n\n    const letterIndex = base.charCodeAt(0) - aLetterOffset;\n    if (letterIndex < 0 || letterIndex >= lettersInAlphabet) {\n      // outside of bounds of \"A\" to \"Z\", ignore\n      return \"#ffffff\";\n    }\n    const cons = conservation.map[pos * lettersInAlphabet + letterIndex] || 0;\n    if (cons > 0.8) {\n      return \"#6464ff\";\n    } else if (cons > 0.6) {\n      return \"#9da5ff\";\n    } else if (cons > 0.4) {\n      return \"#cccccc\";\n    } else {\n      return \"#ffffff\";\n    }\n  },\n\n  map: {\n    \"> 0.8\": \"#6464ff\",\n    \"> 0.6\": \"#9da5ff\",\n    \"> 0.4\": \"#cccccc\",\n    \"> 0\": \"#ffffff\",\n  },\n};\n\nexport default pid;\n","import {\n  StaticSchemeClass,\n  DynSchemeClass,\n  ColorStructure,\n} from \"./schemeclass\";\n\nimport Aliphatic from \"./aliphatic\";\nimport Aromatic from \"./aromatic\";\nimport Charged from \"./charged\";\nimport Negative from \"./negative\";\nimport Polar from \"./polar\";\nimport Positive from \"./positive\";\nimport SerineThreonine from \"./serine_threonine\";\nimport Buried from \"./buried\";\nimport Cinema from \"./cinema\";\nimport Clustal from \"./clustal\";\nimport Clustal2 from \"./clustal2\";\nimport Helix from \"./helix\";\nimport Hydro from \"./hydrophobicity\";\nimport Lesk from \"./lesk\";\nimport Mae from \"./mae\";\nimport Nucleotide from \"./nucleotide\";\nimport Purine from \"./purine\";\nimport Strand from \"./strand\";\nimport Taylor from \"./taylor\";\nimport Turn from \"./turn\";\nimport Zappo from \"./zappo\";\n\n// TODO: reenable dynamis colors!\nimport pid from \"./pid_colors\";\n\nexport const staticSchemes: Record<string, Record<string, string>> = {\n  aliphatic: Aliphatic,\n  aromatic: Aromatic,\n  buried: Buried,\n  buried_index: Buried,\n  charged: Charged,\n  cinema: Cinema,\n  clustal2: Clustal2,\n  clustal: Clustal,\n  helix: Helix,\n  helix_propensity: Helix,\n  hydro: Hydro,\n  lesk: Lesk,\n  mae: Mae,\n  negative: Negative,\n  nucleotide: Nucleotide,\n  polar: Polar,\n  positive: Positive,\n  purine: Purine,\n  purine_pyrimidine: Purine,\n  serine_threonine: SerineThreonine,\n  strand: Strand,\n  strand_propensity: Strand,\n  taylor: Taylor,\n  turn: Turn,\n  turn_propensity: Turn,\n  zappo: Zappo,\n};\n\nexport const dynSchemes: Record<string, ColorStructure> = {\n  conservation: pid,\n};\n\nexport const defaultSchemes = [\n  ...Object.keys(staticSchemes),\n  ...Object.keys(dynSchemes),\n];\n\nclass Colors {\n  private maps = { ...staticSchemes };\n  private dyn = { ...dynSchemes };\n  private opt;\n  constructor(opt?: unknown) {\n    this.opt = opt;\n  }\n  // getScheme  (scheme: string) {\n  //   return staticSchemes[scheme];\n  // };\n  getScheme(scheme: string) {\n    let color = this.maps[scheme];\n    if (color === undefined) {\n      color = {};\n      if (this.dyn[scheme] !== undefined) {\n        return new DynSchemeClass(this.dyn[scheme], this.opt);\n      }\n    }\n    return new StaticSchemeClass(color);\n  }\n  addStaticScheme(name: string, scheme: Record<string, string>) {\n    this.maps[name] = scheme;\n  }\n  addDynScheme(name: string, scheme: ColorStructure) {\n    this.dyn[name] = scheme;\n  }\n}\n\n// Colors.getScheme = function (scheme: string) {\n//   return staticSchemes[scheme];\n// };\n\nexport default Colors;\n","export default {\n  F: \"#00639a\",\n  W: \"#00639a\",\n  Y: \"#00639a\",\n  H: \"#00639a\",\n};\n","export default {\n  D: \"#00639a\",\n  E: \"#00639a\",\n  K: \"#00639a\",\n  R: \"#00639a\",\n  H: \"#00639a\",\n};\n","export default {\n  A: \"#BBBBBB\",\n  B: \"grey\",\n  C: \"yellow\",\n  D: \"red\",\n  E: \"red\",\n  F: \"magenta\",\n  G: \"brown\",\n  H: \"#00FFFF\",\n  I: \"#BBBBBB\",\n  J: \"#fff\",\n  K: \"#00FFFF\",\n  L: \"#BBBBBB\",\n  M: \"#BBBBBB\",\n  N: \"green\",\n  O: \"#fff\",\n  P: \"brown\",\n  Q: \"green\",\n  R: \"#00FFFF\",\n  S: \"green\",\n  T: \"green\",\n  U: \"#fff\",\n  V: \"#BBBBBB\",\n  W: \"magenta\",\n  X: \"grey\",\n  Y: \"magenta\",\n  Z: \"grey\",\n  Gap: \"grey\",\n};\n","export default {\n  A: \"#80a0f0\",\n  R: \"#f01505\",\n  N: \"#00ff00\",\n  D: \"#c048c0\",\n  C: \"#f08080\",\n  Q: \"#00ff00\",\n  E: \"#c048c0\",\n  G: \"#f09048\",\n  H: \"#15a4a4\",\n  I: \"#80a0f0\",\n  L: \"#80a0f0\",\n  K: \"#f01505\",\n  M: \"#80a0f0\",\n  F: \"#80a0f0\",\n  P: \"#ffff00\",\n  S: \"#00ff00\",\n  T: \"#00ff00\",\n  W: \"#80a0f0\",\n  Y: \"#15a4a4\",\n  V: \"#80a0f0\",\n  B: \"#fff\",\n  X: \"#fff\",\n  Z: \"#fff\",\n};\n","export default {\n  A: \"orange\",\n  B: \"#fff\",\n  C: \"green\",\n  D: \"red\",\n  E: \"red\",\n  F: \"blue\",\n  G: \"orange\",\n  H: \"red\",\n  I: \"green\",\n  J: \"#fff\",\n  K: \"red\",\n  L: \"green\",\n  M: \"green\",\n  N: \"#fff\",\n  O: \"#fff\",\n  P: \"orange\",\n  Q: \"#fff\",\n  R: \"red\",\n  S: \"orange\",\n  T: \"orange\",\n  U: \"#fff\",\n  V: \"green\",\n  W: \"blue\",\n  X: \"#fff\",\n  Y: \"blue\",\n  Z: \"#fff\",\n  Gap: \"#fff\",\n};\n","export default {\n  A: \"#ad0052\",\n  B: \"#0c00f3\",\n  C: \"#c2003d\",\n  D: \"#0c00f3\",\n  E: \"#0c00f3\",\n  F: \"#cb0034\",\n  G: \"#6a0095\",\n  H: \"#1500ea\",\n  I: \"#ff0000\",\n  J: \"#fff\",\n  K: \"#0000ff\",\n  L: \"#ea0015\",\n  M: \"#b0004f\",\n  N: \"#0c00f3\",\n  O: \"#fff\",\n  P: \"#4600b9\",\n  Q: \"#0c00f3\",\n  R: \"#0000ff\",\n  S: \"#5e00a1\",\n  T: \"#61009e\",\n  U: \"#fff\",\n  V: \"#f60009\",\n  W: \"#5b00a4\",\n  X: \"#680097\",\n  Y: \"#4f00b0\",\n  Z: \"#0c00f3\",\n};\n","export default {\n  A: \" orange\",\n  B: \" #fff\",\n  C: \" green\",\n  D: \" red\",\n  E: \" red\",\n  F: \" green\",\n  G: \" orange\",\n  H: \" magenta\",\n  I: \" green\",\n  J: \" #fff\",\n  K: \" red\",\n  L: \" green\",\n  M: \" green\",\n  N: \" magenta\",\n  O: \" #fff\",\n  P: \" green\",\n  Q: \" magenta\",\n  R: \" red\",\n  S: \" orange\",\n  T: \" orange\",\n  U: \" #fff\",\n  V: \" green\",\n  W: \" green\",\n  X: \" #fff\",\n  Y: \" green\",\n  Z: \" #fff\",\n  Gap: \" #fff\",\n};\n","export default {\n  A: \" #77dd88\",\n  B: \" #fff\",\n  C: \" #99ee66\",\n  D: \" #55bb33\",\n  E: \" #55bb33\",\n  F: \" #9999ff\",\n  G: \" #77dd88\",\n  H: \" #5555ff\",\n  I: \" #66bbff\",\n  J: \" #fff\",\n  K: \" #ffcc77\",\n  L: \" #66bbff\",\n  M: \" #66bbff\",\n  N: \" #55bb33\",\n  O: \" #fff\",\n  P: \" #eeaaaa\",\n  Q: \" #55bb33\",\n  R: \" #ffcc77\",\n  S: \" #ff4455\",\n  T: \" #ff4455\",\n  U: \" #fff\",\n  V: \" #66bbff\",\n  W: \" #9999ff\",\n  X: \" #fff\",\n  Y: \" #9999ff\",\n  Z: \" #fff\",\n  Gap: \" #fff\",\n};\n","export default {\n  D: \"#00639a\",\n  E: \"#00639a\",\n};\n","export default {\n  A: \" #64F73F\",\n  C: \" #FFB340\",\n  G: \" #EB413C\",\n  T: \" #3C88EE\",\n  U: \" #3C88EE\",\n};\n","export default {\n  R: \"#00639a\",\n  N: \"#00639a\",\n  D: \"#00639a\",\n  Q: \"#00639a\",\n  E: \"#00639a\",\n  G: \"#00639a\",\n  H: \"#00639a\",\n  K: \"#00639a\",\n  S: \"#00639a\",\n  T: \"#00639a\",\n  Y: \"#00639a\",\n};\n","export default {\n  K: \"#00639a\",\n  R: \"#00639a\",\n  H: \"#00639a\",\n};\n","export default {\n  S: \"#00639a\",\n  T: \"#00639a\",\n};\n","export default {\n  A: \"#ccff00\",\n  R: \"#0000ff\",\n  N: \"#cc00ff\",\n  D: \"#ff0000\",\n  C: \"#ffff00\",\n  Q: \"#ff00cc\",\n  E: \"#ff0066\",\n  G: \"#ff9900\",\n  H: \"#0066ff\",\n  I: \"#66ff00\",\n  L: \"#33ff00\",\n  K: \"#6600ff\",\n  M: \"#00ff00\",\n  F: \"#00ff66\",\n  P: \"#ffcc00\",\n  S: \"#ff3300\",\n  T: \"#ff6600\",\n  W: \"#00ccff\",\n  Y: \"#00ffcc\",\n  V: \"#99ff00\",\n  B: \"#fff\",\n  X: \"#fff\",\n  Z: \"#fff\",\n};\n","export default {\n  A: \"#ffafaf\",\n  R: \"#6464ff\",\n  N: \"#00ff00\",\n  D: \"#ff0000\",\n  C: \"#ffff00\",\n  Q: \"#00ff00\",\n  E: \"#ff0000\",\n  G: \"#ff00ff\",\n  H: \"#6464ff\",\n  I: \"#ffafaf\",\n  L: \"#ffafaf\",\n  K: \"#6464ff\",\n  M: \"#ffafaf\",\n  F: \"#ffc800\",\n  P: \"#ff00ff\",\n  S: \"#00ff00\",\n  T: \"#00ff00\",\n  W: \"#ffc800\",\n  Y: \"#ffc800\",\n  V: \"#ffafaf\",\n  B: \"#fff\",\n  X: \"#fff\",\n  Z: \"#fff\",\n};\n","import schemes from \"../colorschemes\";\nimport { DynSchemeClass, StaticSchemeClass } from \"../colorschemes/schemeclass\";\nimport { ConservationManager } from \"../types/types\";\nconst schemesMgr = new schemes();\n\n/**\n * Simple color scheme abstraction over msa-colorschemes. To be extended.\n */\nclass ColorScheme {\n  scheme: DynSchemeClass | StaticSchemeClass;\n  conservation?: ConservationManager;\n\n  constructor(colorScheme: string) {\n    this.scheme = schemesMgr.getScheme(colorScheme);\n  }\n\n  // TODO: enable conservation\n  updateConservation(conservation: ConservationManager) {\n    this.conservation = conservation;\n  }\n\n  getColor(element: string, position: number) {\n    if (this.scheme.type === \"dyn\") {\n      return (this.scheme as DynSchemeClass).getColor(\n        element,\n        position,\n        this.conservation,\n      );\n    }\n    return this.scheme.getColor(element); // , position, schemesMgr.conservation);\n  }\n}\nexport default ColorScheme;\nexport { ColorScheme };\n","import { property, state, customElement } from \"lit/decorators.js\";\nimport { PropertyValues } from \"lit\";\n\nimport { clamp, floor, isEqual } from \"lodash-es\";\n\nimport DraggingComponent from \"./DraggingComponent\";\nimport TilingGrid from \"./CanvasTilingGrid\";\nimport CanvasCache from \"./CanvasCache\";\n\nimport Mouse from \"../../utils/mouse\";\nimport { roundMod } from \"../../utils/math\";\nimport {\n  SequencesType,\n  Movement,\n  Position,\n  TilePositions,\n  Region,\n  Stats,\n  RawPosition,\n  SequencePosition,\n  ResidueTileOptions,\n  TileOptions,\n  ConservationManager,\n} from \"../../types/types\";\n\nimport ColorScheme from \"../../utils/ColorScheme\";\n\nconst debug = false;\n\nconst DEFAULT_COLOR_SCHEME = \"clustal\";\n\n/**\n * Component to draw the main sequence alignment.\n */\n@customElement(\"msa-sequence-viewer\")\nclass SequenceViewerComponent extends DraggingComponent {\n  private tileCache: CanvasCache;\n  private residueTileCache: CanvasCache;\n  private tilingGridManager: TilingGrid;\n\n  private redrawStarted = 0;\n  private redrawnTiles = 0;\n  private colorSchemeManager = new ColorScheme(DEFAULT_COLOR_SCHEME);\n\n  @property({\n    type: Number,\n    attribute: \"tile-width\",\n  })\n  tileWidth = 20;\n\n  @property({\n    type: Number,\n    attribute: \"tile-height\",\n  })\n  tileHeight = 20;\n\n  @property({\n    type: String,\n    attribute: \"color-scheme\",\n  })\n  colorScheme: string = DEFAULT_COLOR_SCHEME;\n  @property({\n    type: Boolean,\n    attribute: \"overlay-conservation\",\n  })\n  overlayConservation = false;\n\n  @state()\n  props: SequenceViewerComponentProps = {\n    showModBar: false,\n    xGridSize: 10,\n    yGridSize: 10,\n    border: false,\n    borderColor: \"black\",\n    borderWidth: 1,\n    cacheElements: 20,\n    textColor: \"black\",\n    textFont: \"18px Arial\",\n    overflow: \"hidden\",\n    overflowX: \"auto\",\n    overflowY: \"auto\",\n    scrollBarPositionX: \"bottom\",\n    scrollBarPositionY: \"right\",\n    // TODO: deal with conservation\n    conservation: null,\n    sequenceDisableDragging: false,\n  };\n\n  private _position?: Position;\n  @state()\n  sequences?: SequencesType;\n\n  set position(position: RawPosition) {\n    this._position = {\n      xPosOffset: -(position.xPos % this.tileWidth),\n      yPosOffset: -(position.yPos % this.tileHeight),\n      currentViewSequence: clamp(\n        floor(position.yPos / this.tileHeight),\n        0,\n        (this.sequences?.length || 1) - 1,\n      ),\n      currentViewSequencePosition: clamp(\n        floor(position.xPos / this.tileWidth),\n        0,\n        this.sequences?.maxLength || 0,\n      ),\n      ...position,\n    };\n    this.x = position.xPos;\n    this.y = position.yPos;\n  }\n  @state()\n  get position(): Position {\n    return this._position as Position;\n  }\n\n  /**\n   * Displays a highlight\n   */\n\n  @state()\n  highlight?: Region | Array<Region>;\n\n  /**\n   * An array of features which can be clicked\n   */\n  @state()\n  features?: Array<Region>;\n\n  protected stats: Stats | undefined;\n  private mouseOverFeatureIds: string[] = [];\n\n  constructor() {\n    super();\n    // cache fully drawn tiles\n    this.tileCache = new CanvasCache();\n    // cache individual residue cells\n    this.residueTileCache = new CanvasCache();\n    // the manager which is in charge of drawing residues\n    this.tilingGridManager = new TilingGrid();\n\n    this.onClick = this.onClick.bind(this);\n    this.onDoubleClick = this.onDoubleClick.bind(this);\n    this.draw = this.draw.bind(this);\n  }\n\n  setProp(key: string, value: unknown) {\n    this.props = {\n      ...this.props,\n      [key]: value,\n    };\n    if (key === \"conservation\") {\n      this.colorSchemeManager.updateConservation(value as ConservationManager);\n      this.draw();\n    }\n  }\n  getColorMap() {\n    return {\n      name: this.colorScheme,\n      map: this.colorSchemeManager.scheme.map,\n    };\n  }\n\n  willUpdate(changedProperties: PropertyValues<this>) {\n    // only need to check changed properties for an expensive computation.\n    if (\n      changedProperties.has(\"sequences\") ||\n      changedProperties.has(\"tileWidth\") ||\n      changedProperties.has(\"width\") ||\n      changedProperties.has(\"height\")\n    ) {\n      this.stats = this.sequences\n        ? {\n            nrXTiles: Math.ceil(this.width / this.tileWidth) + 1,\n            nrYTiles: Math.ceil(this.height / this.tileHeight) + 1,\n            fullWidth: this.tileWidth * this.sequences.maxLength,\n            fullHeight: this.tileHeight * this.sequences.length,\n          }\n        : undefined;\n      this.fullWidth = this.tileWidth * (this.sequences?.maxLength || 0);\n      this.fullHeight = this.tileHeight * (this.sequences?.length || 0);\n    }\n    if (changedProperties.has(\"colorScheme\")) {\n      this.colorSchemeManager = new ColorScheme(this.colorScheme);\n      if (this.props.conservation) {\n        this.colorSchemeManager.updateConservation(this.props.conservation);\n      }\n    }\n  }\n\n  firstUpdated() {\n    super.firstUpdated();\n    this.container?.addEventListener(\"mousemove\", this.onMouseMove);\n    this.container?.addEventListener(\"click\", this.onClick);\n    this.container?.addEventListener(\"dblclick\", this.onDoubleClick);\n    this.addEventListener(\"fake-scroll\", ((e: CustomEvent) => {\n      this.movePosition(e.detail.movement);\n    }) as EventListener);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.container?.removeEventListener(\"mousemove\", this.onMouseMove);\n  }\n\n  handleZooomChanged(): void {\n    this.tileWidth = this.getSingleBaseWidth();\n    this.position = {\n      xPos: ((this[\"display-start\"] || 1) - 1) * this.tileWidth,\n      yPos: this.position.yPos,\n    };\n  }\n\n  // starts the drawing process\n  drawScene() {\n    const positions = this.getTilePositions();\n    if (!positions) {\n      if (debug)\n        console.error(\n          \"Failed to draw scene because couldn't get the tile positions\",\n        );\n      return;\n    }\n\n    this.updateTileSpecs();\n    if (debug) {\n      this.redrawStarted = Date.now();\n      this.redrawnTiles = 0;\n    }\n    this.drawTiles(positions);\n    this.drawHighlightedRegions();\n    if (this.ctx) {\n      this.ctx.canvas.dispatchEvent(\n        new CustomEvent(\"drawCompleted\", {\n          bubbles: true,\n        }),\n      );\n    }\n    if (debug) {\n      const elapsed = Date.now() - this.redrawStarted;\n      if (elapsed > 5) {\n        console.log(\n          `Took ${elapsed} msecs to redraw for ${positions.startXTile} ${positions.startYTile} (redrawnTiles: ${this.redrawnTiles})`,\n        );\n      }\n    }\n  }\n\n  // figures out from where to start drawing\n  getTilePositions(): TilePositions | null {\n    if (!this.position || !this.sequences || !this.stats) return null;\n    const startXTile = Math.max(\n      0,\n      this.position.currentViewSequencePosition - this.props.cacheElements,\n    );\n    const startYTile = Math.max(\n      0,\n      this.position.currentViewSequence - this.props.cacheElements,\n    );\n    const endYTile = Math.min(\n      this.sequences.length,\n      startYTile + this.stats.nrYTiles + 2 * this.props.cacheElements,\n    );\n    const endXTile = Math.min(\n      this.sequences.maxLength,\n      startXTile + this.stats.nrXTiles + 2 * this.props.cacheElements,\n    );\n    return { startXTile, startYTile, endXTile, endYTile };\n  }\n\n  renderTile = ({ row, column }: { row: number; column: number }) => {\n    const key = row + \"-\" + column;\n    return this.tileCache.createTile({\n      key: key,\n      tileWidth: this.tileWidth * this.props.xGridSize,\n      tileHeight: this.tileHeight * this.props.yGridSize,\n      create: ({ ctx }) => {\n        if (!this.sequences) return;\n        if (debug) {\n          this.redrawnTiles++;\n        }\n        this.tilingGridManager.draw({\n          ctx,\n          startYTile: row,\n          startXTile: column,\n          residueTileCache: this.residueTileCache,\n          endYTile: row + this.props.yGridSize,\n          endXTile: column + this.props.xGridSize,\n          sequences: this.sequences,\n          colorScheme: this.colorSchemeManager,\n          textFont: this.props.textFont,\n          textColor: this.props.textColor,\n          tileHeight: this.tileHeight,\n          tileWidth: this.tileWidth,\n          border: this.props.border,\n          borderWidth: this.props.borderWidth,\n          borderColor: this.props.borderColor,\n          overlayConservation: this.overlayConservation,\n          conservation: this.props.conservation,\n        });\n      },\n    });\n  };\n\n  drawTiles({ startXTile, startYTile, endXTile, endYTile }: TilePositions) {\n    if (!this.position) throw Error(\"This method requires position to be set\");\n\n    const xGridSize = this.props.xGridSize;\n    const yGridSize = this.props.yGridSize;\n    const startY = roundMod(startYTile, yGridSize);\n    const startX = roundMod(startXTile, xGridSize);\n\n    for (let i = startY; i < endYTile; i = i + yGridSize) {\n      for (let j = startX; j < endXTile; j = j + xGridSize) {\n        const canvas = this.renderTile({ row: i, column: j }); //, canvas: this.ctx });\n        const width = xGridSize * this.tileWidth;\n        const height = yGridSize * this.tileHeight;\n        const yPos =\n          (i - this.position.currentViewSequence) * this.tileHeight +\n          this.position.yPosOffset;\n        const xPos =\n          (j - this.position.currentViewSequencePosition) * this.tileWidth +\n          this.position.xPosOffset;\n        this.ctx?.drawImage(\n          canvas,\n          0,\n          0,\n          width,\n          height,\n          xPos,\n          yPos,\n          width,\n          height,\n        );\n      }\n    }\n  }\n\n  drawHighlightedRegions() {\n    if (this.highlight) {\n      if (Array.isArray(this.highlight)) {\n        for (const h of this.highlight) {\n          this.drawHighlightedRegion(h);\n        }\n      } else {\n        this.drawHighlightedRegion(this.highlight);\n      }\n    }\n    if (this.features) {\n      this.features.forEach((feature) => {\n        this.drawHighlightedRegion(feature);\n      });\n    }\n  }\n\n  drawHighlightedRegion(region: Region) {\n    if (!this.ctx || !region || !this.position) return;\n    const regionWidth =\n      this.tileWidth * (1 + region.residues.to - region.residues.from);\n    const regionHeight =\n      this.tileHeight * (1 + region.sequences.to - region.sequences.from);\n    const yPosFrom =\n      (region.sequences.from - this.position.currentViewSequence) *\n        this.tileHeight +\n      this.position.yPosOffset;\n    const xPosFrom =\n      (region.residues.from - 1 - this.position.currentViewSequencePosition) *\n        this.tileWidth +\n      this.position.xPosOffset;\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = regionWidth;\n    canvas.height = regionHeight;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n    const mouseOver = this.mouseOverFeatureIds?.some((id) => id === region.id);\n    ctx.globalAlpha = 0.3;\n    ctx.fillStyle = mouseOver\n      ? region.mouseOverFillColor || \"green\"\n      : region.fillColor || \"#9999FF\";\n    ctx.fillRect(0, 0, regionWidth, regionHeight);\n    ctx.globalAlpha = 1;\n    ctx.strokeStyle = mouseOver\n      ? region.mouseOverBorderColor || \"black \"\n      : region.borderColor || \"777700\";\n    ctx.lineWidth = 4;\n    ctx.rect(0, 0, regionWidth, regionHeight);\n\n    ctx.stroke();\n    this.ctx.drawImage(\n      canvas,\n      0,\n      0,\n      regionWidth,\n      regionHeight,\n      xPosFrom,\n      yPosFrom,\n      regionWidth,\n      regionHeight,\n    );\n  }\n  movePosition = (m: Movement) => {\n    if (!this.position) throw Error(\"This method requires position to be set\");\n    if (!m.xMovement && !m.yMovement) return;\n    this.position = {\n      xPos: this.position.xPos + m.xMovement,\n      yPos: this.position.yPos + m.yMovement,\n    };\n  };\n  onPositionUpdate = (oldPos: RawPosition, newPos: RawPosition) => {\n    const relativeMovement = {\n      xMovement: oldPos.xPos - newPos.xPos,\n      yMovement: oldPos.yPos - newPos.yPos,\n    };\n    this.sendEvent(\"onPositionUpdate\", newPos);\n    this.movePosition(relativeMovement);\n  };\n\n  positionToSequence(pos: RawPosition): SequencePosition {\n    if (!this.position || !this.sequences)\n      throw Error(\"This method requires position and sequence to be set\");\n    const sequences = this.sequences.raw;\n    const seqNr = clamp(\n      floor((this.position.yPos + pos.yPos) / this.tileHeight),\n      0,\n      sequences.length - 1,\n    );\n    const sequence = sequences[seqNr];\n\n    const position = clamp(\n      floor((this.position.xPos + pos.xPos) / this.tileWidth),\n      0,\n      sequence.sequence.length - 1,\n    );\n    return {\n      i: seqNr,\n      sequence,\n      position,\n      residue: sequence.sequence[position],\n    };\n  }\n\n  sequencePositionToFeatureIds(sequencePosition: SequencePosition): string[] {\n    if (!this.features) {\n      return [];\n    }\n    return this.features\n      .filter(\n        (feature) =>\n          feature.id &&\n          sequencePosition.position >= feature.residues.from - 1 &&\n          sequencePosition.position <= feature.residues.to - 1 &&\n          sequencePosition.i >= feature.sequences.from &&\n          sequencePosition.i <= feature.sequences.to,\n      )\n      .map((feature) => feature.id || \"\");\n  }\n\n  updateScrollPosition = () => {\n    this.draw();\n  };\n\n  /**\n   * Returns the position of the mouse position relative to the sequences\n   */\n  currentPointerPosition(e: MouseEvent) {\n    return this.positionToSequence(Mouse.relative(e));\n  }\n\n  /**\n   * Only sends an event if the actual function is set.\n   */\n  sendEvent(name: string, data: unknown) {\n    if (this.ctx) {\n      this.ctx.canvas.dispatchEvent(\n        new CustomEvent(name, {\n          bubbles: true,\n          detail: data,\n        }),\n      );\n    }\n\n    // if (this.props[name] !== undefined) {\n    //   this.props[name](data);\n    // }\n  }\n\n  private currentMouseSequencePosition?: SequencePosition;\n\n  onMouseMove = (event: MouseEvent) => {\n    // if (typeof this.isInDragPhase === \"undefined\") {\n    // if (this.hasOnMouseMoveProps()) {\n    const eventData = this.currentPointerPosition(event);\n    const lastValue = this.currentMouseSequencePosition;\n    if (!isEqual(lastValue, eventData)) {\n      if (lastValue !== undefined) {\n        this.sendEvent(\"onResidueMouseLeave\", lastValue);\n      }\n      this.currentMouseSequencePosition = eventData;\n      this.sendEvent(\"onResidueMouseEnter\", eventData);\n\n      if (this.features && this.features.length > 0) {\n        const lastMouseOverFeatureIds = this.mouseOverFeatureIds || [];\n        const mouseOverFeatureIds =\n          this.sequencePositionToFeatureIds(eventData);\n        if (!isEqual(lastMouseOverFeatureIds, mouseOverFeatureIds)) {\n          this.mouseOverFeatureIds = mouseOverFeatureIds;\n          super.draw();\n        }\n      }\n      // }\n    }\n    // }\n    // super.onMouseMove(event);\n  };\n\n  onMouseLeave = (/*event: MouseEvent*/) => {\n    this.sendEvent(\"onResidueMouseLeave\", this.currentMouseSequencePosition);\n    this.currentMouseSequencePosition = undefined;\n    if (this.mouseOverFeatureIds) {\n      this.mouseOverFeatureIds = [];\n      super.draw();\n    }\n    // super.onMouseLeave(event);\n  };\n\n  onClick = (event: MouseEvent) => {\n    if (!this.mouseHasMoved) {\n      const eventData = this.currentPointerPosition(event);\n      this.sendEvent(\"onResidueClick\", eventData);\n      if (this.features) {\n        this.sequencePositionToFeatureIds(eventData).forEach((id) => {\n          this.sendEvent(\"onFeatureClick\", { event, id });\n        });\n      }\n    }\n    // super.onClick(event);\n  };\n\n  onDoubleClick = (event: MouseEvent) => {\n    const eventData = this.currentPointerPosition(event);\n    this.sendEvent(\"onResidueDoubleClick\", eventData);\n    // super.onDoubleClick(event);\n  };\n\n  componentWillUnmount() {\n    this.tileCache.invalidate();\n    this.residueTileCache.invalidate();\n  }\n\n  updateTileSpecs() {\n    const residueTileSpecs = {\n      tileWidth: this.tileWidth,\n      tileHeight: this.tileHeight,\n      colorScheme: this.colorSchemeManager,\n      textFont: this.props.textFont,\n      borderColor: this.props.borderColor,\n      overlayConservation: this.overlayConservation,\n      conservation: this.props.conservation,\n    };\n    this.tileCache.updateTileSpecs({\n      ...residueTileSpecs,\n      xGridSize: this.props.xGridSize,\n      yGridSize: this.props.yGridSize,\n      sequences: this.sequences,\n    } as TileOptions);\n    this.residueTileCache.updateTileSpecs(\n      residueTileSpecs as ResidueTileOptions,\n    );\n  }\n\n  render() {\n    return super.render();\n  }\n  updated() {\n    this.draw();\n  }\n}\n\ntype SequenceViewerComponentProps = {\n  /**\n   * Show the custom ModBar\n   */\n  showModBar: boolean;\n\n  /**\n   * Number of residues to cluster in one tile (x-axis) (default: 10)\n   */\n  xGridSize: number;\n\n  /**\n   * Number of residues to cluster in one tile (y-axis) (default: 10)\n   */\n  yGridSize: number;\n\n  /**\n   * Number of residues to prerender outside of the visible viewbox.\n   */\n  cacheElements: number;\n\n  /**\n   * Whether to draw a border.\n   */\n  border: boolean;\n\n  /**\n   * Color of the border. Name, hex or RGB value.\n   */\n  borderColor: string;\n\n  /**\n   * Width of the border.\n   */\n  borderWidth: number;\n\n  /**\n   * Color of the text residue letters (name, hex or RGB value)\n   */\n  textColor: string;\n\n  /**\n   * Font to use when drawing the individual residues.\n   */\n  textFont: string;\n\n  /**\n   * What should happen if content overflows.\n   */\n  overflow: \"hidden\" | \"auto\" | \"scroll\";\n\n  /**\n   * What should happen if x-axis content overflows (overwrites \"overflow\")\n   */\n  overflowX: \"hidden\" | \"auto\" | \"scroll\" | \"initial\";\n\n  /**\n   * What should happen if y-axis content overflows (overwrites \"overflow\")\n   */\n  overflowY: \"hidden\" | \"auto\" | \"scroll\" | \"initial\";\n\n  /**\n   * X Position of the scroll bar (\"top or \"bottom\")\n   */\n  scrollBarPositionX: \"top\" | \"bottom\";\n\n  /**\n   * Y Position of the scroll bar (\"left\" or \"right\")\n   */\n  scrollBarPositionY: \"left\" | \"right\";\n\n  conservation?: ConservationManager | null;\n  /**\n   * The conservation data can be used to define an overlay that\n   * defines the opacity of the background color of each residue.\n   */\n  overlayConservation?: boolean;\n  // onPositionUpdate?: () => void;\n  sequenceDisableDragging?: boolean;\n\n  // TODO: deal with this as external events\n  //\n  //  /**\n  //   * Callback fired when the mouse pointer is entering a residue.\n  //   */\n  //  onResidueMouseEnter: PropTypes.func,\n\n  //  /**\n  //   * Callback fired when the mouse pointer is leaving a residue.\n  //   */\n  //  onResidueMouseLeave: PropTypes.func,\n\n  //  /**\n  //   * Callback fired when the mouse pointer clicked a residue.\n  //   */\n  //  onResidueClick: PropTypes.func,\n\n  //  /**\n  //   * Callback fired when the mouse pointer clicked a feature.\n  //   */\n  //  onFeatureClick: PropTypes.func,\n  //  /**\n  //  * Callback fired when the mouse pointer clicked a residue.\n  //  */\n  //   onResidueDoubleClick: PropTypes.func,\n};\n\nexport default SequenceViewerComponent;\n","import { LitElement, html, PropertyValues } from \"lit\";\nimport { customElement, state, property } from \"lit/decorators.js\";\nimport object2style from \"../utils/object2style\";\n\n@customElement(\"msa-labels\")\nclass Labels extends LitElement {\n  @property({ type: Number })\n  width = 0;\n  @property({ type: Number })\n  height = 0;\n  @property({ type: Number })\n  y = 0;\n  @state()\n  labels: string[] = [];\n  @property({\n    type: Number,\n    attribute: \"tile-height\",\n  })\n  tileHeight = 20;\n  @property({\n    attribute: \"active-label\",\n    reflect: true,\n  })\n  activeLabel = \"\";\n\n  willUpdate(changedProperties: PropertyValues<this>) {\n    if (changedProperties.has(\"y\")) {\n      const ul = this.renderRoot.querySelector(\"ul\");\n      if (ul) ul.scrollTop = this.y;\n    }\n  }\n  render() {\n    const ulStyle = {\n      width: `${this.width}px`,\n      height: `${this.height}px`,\n      \"list-style\": \"none\",\n      padding: 0,\n      margin: 0,\n      \"line-height\": `${this.tileHeight}px`,\n      color: \"rgb(0, 99, 154)\",\n      \"text-transform\": \"uppercase\",\n      overflow: \"hidden\",\n      \"font-weight\": \"normal\",\n      \"font-size\": \"14px\",\n      cursor: \"pointer\",\n    };\n    return html`<ul style=${object2style(ulStyle)}>\n      ${this.labels.map(\n        (label) =>\n          html`<li\n            style=${`font-weight: ${\n              this.activeLabel === label ? \"bold\" : \"normal\"\n            }`}\n            @click=${() => {\n              this.activeLabel = label;\n              this.dispatchEvent(\n                new CustomEvent(\"msa-active-label\", {\n                  bubbles: true,\n                  detail: { label },\n                }),\n              );\n            }}\n          >\n            ${label}\n          </li>`,\n      )}\n    </ul>`;\n  }\n}\n\nexport default Labels;\n","import { SequencesMSA } from \"../types/types\";\n\ndeclare const self: Worker & { previous: unknown };\n\n// This file exports the JavaScript source code string of a function which calculates conversvation that is used for an inline worker.\n// The point of doing this is so we can avoid rollup/webpack issues which were arising when using a normal worker.\n// See this article for more information on inline workers: https://web.dev/articles/workers-basics#inline_workers\n\nexport const calculateConservation = (\n  sequences: SequencesMSA,\n  sampleSize: number | null = null,\n  isWorker = false\n) => {\n  const aLetterOffset = \"A\".charCodeAt(0);\n  const lettersInAlphabet = 26;\n  const length =\n    (sequences && sequences.length && sequences[0].sequence.length) || 0;\n  const finalSampleSize = sampleSize\n    ? Math.min(sampleSize, sequences.length)\n    : sequences.length;\n\n  const sequencesToLoopThrough = sampleSize\n    ? sequences.slice(0, finalSampleSize)\n    : sequences;\n  const conservation = new Float32Array(length * lettersInAlphabet);\n  for (let i = 0; i < sequencesToLoopThrough.length; i++) {\n    const { sequence } = sequencesToLoopThrough[i];\n    for (let j = 0; j < sequence.length; j++) {\n      const aa = sequence[j].toUpperCase();\n      const loopOffset = j * lettersInAlphabet;\n      const letterIndex = aa.charCodeAt(0) - aLetterOffset;\n      if (letterIndex < 0 || letterIndex >= lettersInAlphabet) {\n        // outside of bounds of \"A\" to \"Z\", ignore\n        continue;\n      }\n      conservation[loopOffset + letterIndex]++;\n    }\n  }\n\n  for (let i = 0; i < conservation.length; i++) {\n    conservation[i] /= finalSampleSize;\n  }\n  if (isWorker) {\n    self.postMessage({ progress: 1, conservation }, [conservation.buffer]);\n  }\n  return conservation;\n};\n\n// Note that the line `const f = ${calculateConservation.toString()};` allows us to keep that\n// function's source code in TypeScript while also being transpiled into JavaScript.\nconst conservationInlineWorkerString = `\nself.addEventListener('message', (e) => {\n  if (self.previous !== e.data) {\n    const f = ${calculateConservation.toString()};\n    f(e.data.sequences, e.data.sampleSize, true);\n  }\n  self.previous = e.data;\n})`;\n\nexport default conservationInlineWorkerString;\n","import { customElement, property } from \"lit/decorators.js\";\nimport \"./components/Canvas/SequenceViewer\";\nimport \"./components/Labels\";\nimport LabelsComponent from \"./components/Labels\";\nimport SequenceViewerComponent from \"./components/Canvas/SequenceViewer\";\nimport { html } from \"lit\";\nimport NightingaleElement, {\n  withManager,\n  withPosition,\n  withMargin,\n  withDimensions,\n  withHighlight,\n  withResizable,\n} from \"@nightingale-elements/nightingale-new-core\";\nimport conservationInlineWorkerString from \"./workers/conservation-inline-worker\";\nimport object2style from \"./utils/object2style\";\nimport { Region, SequencesMSA } from \"./types/types\";\n\nconst DEAFULT_TILE_HEIGHT = 20;\nconst DEAFULT_COLOR_SCHEME = \"clustal2\";\n@customElement(\"nightingale-msa\")\nclass NightingaleMSA extends withManager(\n  withResizable(\n    withHighlight(withMargin(withDimensions(withPosition(NightingaleElement))))\n  )\n) {\n  @property({\n    attribute: \"color-scheme\",\n  })\n  colorScheme?: string = DEAFULT_COLOR_SCHEME;\n  @property({\n    type: Number,\n    attribute: \"label-width\",\n  })\n  labelWidth?: number = 0;\n  @property({\n    type: Number,\n    attribute: \"tile-height\",\n  })\n  tileHeight?: number = DEAFULT_TILE_HEIGHT;\n  @property({\n    attribute: \"active-label\",\n    reflect: true,\n  })\n  activeLabel?: string = \"\";\n  @property({\n    type: Number,\n    attribute: \"conservation-sample-size\",\n  })\n  sampleSize?: number = 20;\n  @property({\n    type: Boolean,\n    attribute: \"overlay-conservation\",\n  })\n  overlayConservtion?: boolean = false;\n\n  worker = new Worker(\n    window.URL.createObjectURL(new Blob([conservationInlineWorkerString]))\n  );\n\n  private sequenceViewer?: SequenceViewerComponent | null;\n  private labelPanel?: LabelsComponent | null;\n\n  constructor() {\n    super();\n    this.worker.onmessage = (e) => {\n      this.dispatchEvent(\n        new CustomEvent(\"conservationProgress\", {\n          bubbles: true,\n          detail: e.data,\n        })\n      );\n      if (e.data.progress === 1) {\n        const conservation = {\n          ...e.data,\n          map: e.data.conservation,\n        };\n        this.sequenceViewer?.setProp(\"conservation\", conservation);\n      }\n    };\n  }\n\n  set data(sequences: SequencesMSA) {\n    this.length = Math.max(...sequences.map(({ sequence }) => sequence.length));\n    const seqs = {\n      raw: sequences,\n      length: sequences.length,\n      maxLength: this.length,\n    };\n    if (this.sequenceViewer) this.sequenceViewer.sequences = seqs;\n    if (this.labelPanel)\n      this.labelPanel.labels = sequences.map(({ name }) => name);\n\n    this.worker.postMessage({ sequences, sampleSize: this.sampleSize });\n  }\n\n  set features(features: Array<Region>) {\n    if (this.sequenceViewer) this.sequenceViewer.features = features;\n  }\n\n  getColorMap() {\n    return this.sequenceViewer?.getColorMap();\n  }\n\n  render() {\n    const containerStyle = {\n      display: \"flex\",\n      \"align-items\": \"stretch\",\n    };\n    const topMarginStyle = {\n      height: `${this[\"margin-top\"]}px`,\n      width: \"100%\",\n      background: this[\"margin-color\"],\n    };\n    const leftMarginStyle = {\n      width: `${this[\"margin-left\"]}px`,\n      background: this[\"margin-color\"],\n    };\n    const rightMarginStyle = {\n      width: `${this[\"margin-right\"]}px`,\n      background: this[\"margin-color\"],\n    };\n    const bottomMarginStyle = {\n      height: `${this[\"margin-bottom\"]}px`,\n      width: \"100%\",\n      background: this[\"margin-color\"],\n    };\n    const labelWidth = this.labelWidth || 0;\n    const tileHeight = this.tileHeight || DEAFULT_TILE_HEIGHT;\n    return html`\n      ${this[\"margin-top\"] > 0\n        ? html`<div style=${object2style(topMarginStyle)}></div>`\n        : \"\"}\n      <div style=${object2style(containerStyle)}>\n        ${labelWidth > 0\n          ? html`<msa-labels\n              width=${labelWidth}\n              height=${this.height}\n              tile-height=${tileHeight}\n              active-label=${this.activeLabel || \"\"}\n            ></msa-labels>`\n          : \"\"}\n\n        <div style=${object2style(leftMarginStyle)}></div>\n        <msa-sequence-viewer\n          height=${this.height}\n          width=${this.getWidthWithMargins() - labelWidth}\n          color-scheme=${this.colorScheme || DEAFULT_COLOR_SCHEME}\n          tile-height=${tileHeight}\n          display-start=${this[\"display-start\"] || 0}\n          display-end=${this[\"display-end\"] || 0}\n          length=${this.length || 0}\n          ?overlay-conservation=${this.overlayConservtion}\n        ></msa-sequence-viewer>\n        <div style=${object2style(rightMarginStyle)}></div>\n      </div>\n      ${this[\"margin-bottom\"] > 0\n        ? html`<div style=${object2style(bottomMarginStyle)}></div>`\n        : \"\"}\n    `;\n  }\n  updated() {\n    if (!this.sequenceViewer?.sequences) return;\n    this.sequenceViewer.highlight = this.highlightedRegion.segments.map(\n      ({ start, end }) =>\n        ({\n          sequences: {\n            from: 0,\n            to: (this.sequenceViewer?.sequences || []).length - 1,\n          },\n          residues: {\n            from: start,\n            to: end,\n          },\n          fillColor: this[\"highlight-color\"],\n          borderColor: this[\"highlight-color\"],\n        }) as Region\n    );\n  }\n  protected firstUpdated() {\n    this.sequenceViewer = this.renderRoot.querySelector(\"msa-sequence-viewer\");\n    this.labelPanel = this.renderRoot.querySelector(\"msa-labels\");\n\n    if (!this.sequenceViewer) return;\n\n    this.sequenceViewer.position = {\n      xPos: 0,\n      yPos: 0,\n    };\n\n    this.addEventListener(\"fake-scroll\", () => {\n      if (this.labelPanel && this.sequenceViewer)\n        this.labelPanel.y = this.sequenceViewer.position.yPos;\n    });\n    this.addEventListener(\"msa-active-label\", () => {\n      if (this.labelPanel) this.activeLabel = this.labelPanel.activeLabel;\n    });\n  }\n}\n\nexport default NightingaleMSA;\n","import { html } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\nimport {\n  scaleLinear,\n  ScaleLinear,\n  Selection,\n  axisBottom,\n  Axis,\n  brushX,\n  BrushBehavior,\n  BrushSelection,\n  select,\n  NumberValue,\n} from \"d3\";\n\nimport NightingaleElement, {\n  withDimensions,\n  withPosition,\n  withMargin,\n  withResizable,\n  withManager,\n  withHighlight,\n} from \"@nightingale-elements/nightingale-new-core\";\n\nconst HANDLE_SIZE = 6;\n\n@customElement(\"nightingale-navigation\")\nclass NightingaleNavigation extends withManager(\n  withResizable(\n    withMargin(withPosition(withDimensions(withHighlight(NightingaleElement)))),\n  ),\n) {\n  #x: ScaleLinear<number, number> | null;\n  #dontDispatch: boolean;\n  #svg?: Selection<SVGSVGElement, unknown, HTMLElement | null, unknown>;\n  #displaystartLabel?: Selection<\n    SVGTextElement,\n    unknown,\n    HTMLElement | null,\n    unknown\n  >;\n  #displayendLabel?: Selection<\n    SVGTextElement,\n    unknown,\n    HTMLElement | null,\n    unknown\n  >;\n  #axis?: Selection<SVGGElement, unknown, HTMLElement | null, unknown>;\n  #brushG?: Selection<SVGGElement, unknown, HTMLElement | null, unknown>;\n  #polygon?: Selection<SVGPolygonElement, unknown, HTMLElement | null, unknown>;\n  #xAxis?: Axis<NumberValue>;\n  #viewport?: BrushBehavior<unknown>;\n  #highlighted?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #margins?: Selection<\n    SVGGElement,\n    unknown,\n    HTMLElement | SVGElement | null,\n    unknown\n  >;\n  #currentSelection: BrushSelection | null = null;\n\n  @property({ type: Number })\n  \"ruler-start\"?: number = 1;\n  @property({ type: Number })\n  \"ruler-padding\"?: number = 10;\n  @property({ type: Number })\n  \"scale-factor\"?: number = (this.length || 0) / 5 || 10;\n  @property({ type: Boolean })\n  \"show-highlight\"?: boolean = false;\n\n  constructor() {\n    super();\n    this.#x = null;\n    this.#dontDispatch = false;\n  }\n\n  private createNavRuler() {\n    const limit =\n      this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number);\n    this.#x = scaleLinear()\n      .range([this[\"margin-left\"] + (this[\"ruler-padding\"] as number), limit])\n      .domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1),\n      ]);\n    this.#svg = select(this as unknown as NightingaleElement)\n      .selectAll<SVGSVGElement, unknown>(\"svg\")\n      .attr(\"id\", \"\")\n      .attr(\"width\", this.width)\n      .attr(\"height\", this.height);\n\n    this.#xAxis = axisBottom(this.#x);\n\n    this.#displaystartLabel = this.#svg\n      .append(\"text\")\n      .attr(\"class\", \"start-label\")\n      .attr(\"x\", this[\"margin-left\"])\n      .attr(\"y\", this.height - this[\"margin-bottom\"] - 2)\n      .style(\"font-family\", \"sans-serif\")\n      .style(\"font-size\", 12);\n\n    this.#displayendLabel = this.#svg\n      .append(\"text\")\n      .attr(\"class\", \"end-label\")\n      .attr(\"x\", this.width - this[\"margin-right\"])\n      .attr(\"y\", this.height - this[\"margin-bottom\"] - 2)\n      .attr(\"text-anchor\", \"end\")\n      .style(\"font-family\", \"sans-serif\")\n      .style(\"font-size\", 12);\n\n    this.#axis = this.#svg\n      .append(\"g\")\n      .attr(\"class\", \"x axis\")\n      .call(this.#xAxis);\n\n    this.#viewport = brushX()\n      .extent([\n        [this[\"margin-left\"] + (this[\"ruler-padding\"] as number), 0],\n        [limit, this.height * 0.5 + HANDLE_SIZE / 2],\n      ])\n      .handleSize(HANDLE_SIZE)\n      .on(\"end\", ({ selection }) => {\n        // In case is a click outside the brush, reset brush to previous position\n        if (\n          selection === null &&\n          this.#currentSelection &&\n          this.#brushG &&\n          this.#viewport\n        ) {\n          this.#brushG.call(this.#viewport.move, this.#currentSelection);\n        }\n      })\n      .on(\"brush\", ({ selection, transform }) => {\n        if (selection && this.#x) {\n          this.#currentSelection = selection;\n          this[\"display-start\"] =\n            Math.round(this.#x.invert(selection[0]) * 100) / 100;\n          this[\"display-end\"] =\n            Math.round(this.#x.invert(selection[1]) * 100) / 100;\n          if (!this.#dontDispatch)\n            this.dispatchEvent(\n              new CustomEvent(\"change\", {\n                detail: {\n                  \"display-end\": this[\"display-end\"],\n                  \"display-start\": this[\"display-start\"],\n                  extra: { transform },\n                },\n                bubbles: true,\n                cancelable: true,\n              }),\n            );\n          this.updateLabels();\n          this.updatePolygon();\n        }\n      });\n\n    this.#brushG = this.#svg.append(\"g\").attr(\"class\", \"brush\");\n\n    if (limit > 0) {\n      this.#brushG.call(this.#viewport);\n\n      this.#brushG.call(this.#viewport.move, [\n        this.#x(this.getStart()),\n        this.#x(this.getEnd()),\n      ]);\n    }\n\n    this.#polygon = this.#svg\n      .append(\"polygon\")\n      .attr(\"class\", \"zoom-polygon\")\n      .attr(\"fill\", \"#777\")\n      .attr(\"fill-opacity\", \"0.3\");\n\n    this.#margins = this.#svg.append(\"g\").attr(\"class\", \"margin\");\n    this.createHighlight();\n    this.renderD3();\n  }\n  private createHighlight() {\n    if (!this.#svg) return;\n    this.#highlighted = this.#svg.append(\"g\").attr(\"class\", \"highlighted\");\n    this.updateHighlight();\n  }\n\n  onDimensionsChange() {\n    if (!this.#x) return;\n    this.#x.range([\n      this[\"margin-left\"] + (this[\"ruler-padding\"] as number),\n      this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n    ]);\n    this.#svg?.attr(\"width\", this.width);\n    this.#svg?.attr(\"height\", this.height);\n    this.#viewport?.extent([\n      [this[\"margin-left\"] + (this[\"ruler-padding\"] as number), 0],\n      [\n        this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n        this.height * 0.5 + HANDLE_SIZE / 2,\n      ],\n    ]);\n    if (this.#viewport) this.#brushG?.call(this.#viewport);\n  }\n\n  render() {\n    return html`<svg class=\"container\"></svg>`;\n  }\n  updated(changedProperties: Map<string, unknown>) {\n    this.renderD3();\n    super.updated(changedProperties);\n  }\n\n  firstUpdated() {\n    this.createNavRuler();\n  }\n  renderD3() {\n    if (this.#x && this.#axis && this.#xAxis && this.#viewport) {\n      this.#x.domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1) - 1,\n      ]);\n      this.#axis.call(this.#xAxis);\n      this.updatePolygon();\n      this.updateLabels();\n      const position: BrushSelection = [\n        this.#x(this.getStart()),\n        this.#x(this.getEnd()),\n      ];\n      if (this.#brushG && position[0] >= 0 && position[1] >= 0) {\n        this.#dontDispatch = true;\n        this.#brushG.call(this.#viewport.move, position);\n        this.#dontDispatch = false;\n      }\n      this.updateHighlight();\n      this.renderMarginOnGroup(this.#margins);\n    }\n  }\n\n  locate(start: number, end: number) {\n    if (this.#brushG && this.#viewport && this.#x)\n      this.#brushG.call(this.#viewport.move, [this.#x(start), this.#x(end)]);\n  }\n  zoomOut() {\n    this.locate(\n      Math.max(\n        (this[\"ruler-start\"] as number) || 1,\n        this.getStart() - (this[\"scale-factor\"] as number),\n      ),\n      Math.min(\n        (this.length || 1) + (this[\"ruler-start\"] as number) - 1,\n        this.getEnd() + (this[\"scale-factor\"] as number),\n      ),\n    );\n  }\n  zoomIn() {\n    const newStart = Math.min(\n      this.getStart() + (this[\"scale-factor\"] as number),\n      this.getEnd() - 1,\n    );\n    this.locate(\n      newStart,\n      Math.max(this.getEnd() - (this[\"scale-factor\"] as number), newStart + 1),\n    );\n  }\n  protected updateHighlight() {\n    if (!this.#highlighted) return;\n    // Scale to match the range of the tracks [1,length+1]\n    const s1 = scaleLinear()\n      .domain([\n        this[\"display-start\"] || 1,\n        (this[\"display-end\"] || this.length || 1) + 1,\n      ])\n      .range([this[\"margin-left\"], this.width - this[\"margin-right\"]]);\n\n    // Scale to match the range of the navigation brush [1,length]\n    const s2 = scaleLinear()\n      .domain([\n        this[\"ruler-start\"] as number,\n        (this[\"ruler-start\"] as number) + (this.length || 1),\n      ])\n      .range([\n        this[\"margin-left\"] + (this[\"ruler-padding\"] as number),\n        this.width - this[\"margin-right\"] - (this[\"ruler-padding\"] as number),\n      ]);\n\n    // Highlight Polygon\n    const highlighs = this.#highlighted\n      .selectAll<\n        SVGPolygonElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"polygon\")\n      .data(this[\"show-highlight\"] ? this.highlightedRegion.segments : []);\n\n    highlighs\n      .enter()\n      .append(\"polygon\")\n      .attr(\"class\", \"highlight-polygon\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighs)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"points\", (segment) => {\n        const start = Math.max(1, segment.start);\n        const end = Math.min(this.length || 1, segment.end) + 1;\n        return `${s2(start)},${this.height / 2}\n        ${s2(end)},${this.height / 2}\n        ${s1(end)},${this.height}\n        ${s1(start)},${this.height}`;\n      });\n\n    highlighs.exit().remove();\n    const highlighsRect = this.#highlighted\n      .selectAll<\n        SVGRectElement,\n        {\n          start: number;\n          end: number;\n        }[]\n      >(\"rect\")\n      .data(this[\"show-highlight\"] ? this.highlightedRegion.segments : []);\n\n    // Highlight Rectangle\n    highlighsRect\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"highlight-rectangle\")\n      .style(\"pointer-events\", \"none\")\n      .merge(highlighsRect)\n      .attr(\"fill\", this[\"highlight-color\"])\n      .attr(\"x\", (segment) => s2(Math.max(1, segment.start)))\n      .attr(\n        \"width\",\n        (segment) =>\n          s2(Math.min(this.length || 1, segment.end) + 1) -\n          s2(Math.max(1, segment.start)),\n      )\n      .attr(\"y\", this[\"margin-top\"])\n      .attr(\"height\", this.height / 2);\n\n    highlighsRect.exit().remove();\n  }\n  private updateLabels() {\n    if (this.#displaystartLabel)\n      this.#displaystartLabel\n        .attr(\"x\", this[\"margin-left\"])\n        .text(Math.round(this.getStart()));\n    if (this.#displayendLabel)\n      this.#displayendLabel\n        .attr(\"x\", this.width - this[\"margin-right\"])\n        .text(Math.round(this.getEnd()));\n  }\n\n  private updatePolygon() {\n    if (this.#polygon && this.#x)\n      this.#polygon.attr(\n        \"points\",\n        `${this.#x(this.getStart())},${this.height / 2}\n        ${this.#x(this.getEnd())},${this.height / 2}\n        ${this.width - this[\"margin-right\"]},${this.height}\n        ${this[\"margin-left\"]},${this.height}`,\n      );\n  }\n  private getStart(): number {\n    return this[\"display-start\"] || 1;\n  }\n  private getEnd(): number {\n    return (\n      ((this[\"display-end\"] || 0) > 0 ? this[\"display-end\"] : this.length) || 1\n    );\n  }\n}\n\nexport default NightingaleNavigation;\n","import NightingaleNavigation from \"./nightingale-navigation\";\nexport default NightingaleNavigation;\n","module.exports = require('./src/Stockholm')\n","const Stockholm = function() {\n  let obj = { gf: {},  // gf[tag] = ARRAY\n              gc: {},  // gc[tag] = STRING\n              gs: {},  // gs[tag][seqname] = ARRAY\n              gr: {},  // gr[tag][seqname] = STRING\n              seqname: [],  // optional, specify ordering of rows\n              seqdata: {}  // seqdata[seqname] = STRING\n            }\n  Object.keys(obj).forEach ((prop) => this[prop] = obj[prop])\n  return this\n}\n\nconst formatStartRegex = /^# STOCKHOLM 1.0/;\nconst formatEndRegex = /^\\/\\/\\s*$/;\nconst gfRegex = /^#=GF\\s+(\\S+)\\s+(.*?)\\s*$/;\nconst gcRegex = /^#=GC\\s+(\\S+)\\s+(.*?)\\s*$/;\nconst gsRegex = /^#=GS\\s+(\\S+)\\s+(\\S+)\\s+(.*?)\\s*$/;\nconst grRegex = /^#=GR\\s+(\\S+)\\s+(\\S+)\\s+(.*?)\\s*$/;\nconst lineRegex = /^\\s*(\\S+)\\s+(\\S+)\\s*$/;\nconst nonwhiteRegex = /\\S/;\n\nconst noFormatStart = \"No format header: # STOCKHOLM 1.0\";\nconst noFormatEnd = \"No format footer: //\";\nconst badLine = \"Malformed line\";\nconst atLine = (n) => \"(At line \" + (n+1) + \") \";\n\nconst sniff = (text) => formatStartRegex.test (text);\n\nconst validate = (text) => {\n  try {\n    parseAll (text, { strict: true })\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nconst error = (err) => { throw new Error (err); }\nconst warning = (err) => console.warn(err);\n\nconst parseAll = (text, opts) => {\n  opts = opts || {}\n  const maybeWarning = opts.quiet ? (() => null) : warning;\n  const maybeError = opts.strict ? error : maybeWarning;\n  let db = [], stock = null\n  const lines = text.split(\"\\n\")\n  lines.forEach ((line, n) => {\n    const makeStock = () => {\n      if (!stock) {\n        maybeError (atLine(n) + noFormatStart);\n        stock = new Stockholm();\n      }\n    };\n    let match;\n    if (formatStartRegex.test(line)) {\n      if (stock) maybeError (atLine(n) + noFormatEnd);\n      stock = new Stockholm();\n    } else if (formatEndRegex.test(line)) {\n      if (stock)\n        db.push (stock);\n      else\n        maybeError (atLine(n) + noFormatStart);\n      stock = null;\n    } else if (match = gfRegex.exec(line)) {\n      makeStock();\n      stock.gf[match[1]] = stock.gf[match[1]] || [];\n      stock.gf[match[1]].push (match[2]);\n    } else if (match = gcRegex.exec(line)) {\n      makeStock();\n      stock.gc[match[1]] = stock.gc[match[1]] || '';\n      stock.gc[match[1]] += match[2];\n    } else if (match = gsRegex.exec(line)) {\n      makeStock();\n      stock.gs[match[2]] = stock.gs[match[2]] || {};\n      stock.gs[match[2]][match[1]] = stock.gs[match[2]][match[1]] || [];\n      stock.gs[match[2]][match[1]].push (match[3]);\n    } else if (match = grRegex.exec(line)) {\n      makeStock();\n      stock.gr[match[2]] = stock.gr[match[2]] || {};\n      stock.gr[match[2]][match[1]] = stock.gr[match[2]][match[1]] || '';\n      stock.gr[match[2]][match[1]] += match[3];\n    } else if (match = lineRegex.exec(line)) {\n      makeStock();\n      if (!stock.seqdata[match[1]]) {\n        stock.seqdata[match[1]] = '';\n        stock.seqname.push (match[1]);\n      }\n      stock.seqdata[match[1]] += match[2];\n    } else if (nonwhiteRegex.test (line)) {\n      error (atLine(n) + badLine);\n    }\n  })\n  if (stock) {\n    maybeError (\"Warning: no end line //\");\n    db.push (stock);\n  }\n  return db;\n}\n\nconst parse = (text, opts) => {\n  const db = parseAll (text, opts);\n  if (db.length === 0)\n    error (\"No alignments found\");\n  if (db.length > 1)\n    error (\"More than one alignment found\");\n  return db[0];\n}\n\nconst fromSeqIndex = (seqdata, names) => {\n  let stock = new Stockholm()\n  names = names || Object.keys(seqdata)  // specifying order is optional\n  names.forEach ((name) => stock.addRow (name, seqdata[name]))\n  return stock\n}\n\nconst fromRowList = (array) => {\n  let stock = new Stockholm()\n  array.forEach ((row) => stock.addRow (row[0], row[1]))\n  return stock\n}\n\nStockholm.prototype.rows = function() {\n  return this.seqname.length\n}\n\nStockholm.prototype.columns = function() {\n  let cols = 0\n  this.seqname.forEach ((name) => { cols = Math.max (cols, this.seqdata[name].length) })\n  Object.keys(this.gr).forEach ((tag) => Object.keys(this.gr[tag]).forEach ((name) => {\n    cols = Math.max (cols, this.gr[tag][name].length)\n  }))\n  return cols\n}\n\nStockholm.prototype.allNames = function() {\n  let isName = {},\n      names = [],\n      addName = (name) => { if (!isName[name]) { isName[name] = true; names.push (name) } },\n      addNames = (list) => list.forEach (addName);\n  addNames (this.seqname);\n  addNames (Object.keys (this.seqdata));  // just in case seqdata has been independently modified\n  Object.keys(this.gr).forEach ((tag) => addNames (Object.keys(this.gr[tag])));\n  Object.keys(this.gs).forEach ((tag) => addNames (Object.keys(this.gs[tag])));\n  return names\n}\n\nStockholm.prototype.allTags = function() {\n  let isTag = {}\n  const addTags = (obj) => Object.keys(obj).forEach ((tag) => isTag[tag] = true)\n  addTags (this.gc)\n  addTags (this.gf)\n  addTags (this.gr)\n  addTags (this.gs)\n  return Object.keys(isTag).sort()\n}\n\nStockholm.prototype.addRow = function (name, data) {\n  if (this.seqdata[name])\n    error (\"Duplicate row name\")\n  this.seqname.push (name)\n  this.seqdata[name] = data || ''\n  return this\n}\n\nStockholm.prototype.deleteRow = function (name) {\n  if (!this.seqdata[name])\n    error (\"Row not found\")\n  this.seqname = this.seqname.filter ((n) => n !== name);\n  delete this.seqdata[name];\n  Object.keys(this.gr).forEach ((tag) => delete this.gr[tag][name]);\n  Object.keys(this.gs).forEach ((tag) => delete this.gs[tag][name]);\n  return this\n}\n\nconst copy = (obj, copyFunc) => { let copy = {}; Object.keys(obj).forEach ((key) => copy[key] = copyFunc (obj[key])); return copy; };\nconst copyObject = (obj) => copy (obj, (a) => a.slice(0));\nconst copyObject2 = (obj) => copy (obj, (a) => copyObject(a));\n\nStockholm.prototype.copy = function() {\n  let stock = new Stockholm();\n  stock.seqname = this.seqname.slice(0);\n  stock.seqdata = copyObject (this.seqdata);\n  stock.gf = copyObject (this.gf);\n  stock.gc = copyObject (this.gc);\n  stock.gs = copyObject2 (this.gs);\n  stock.gr = copyObject2 (this.gr);\n  return stock;\n}\n\nconst getStrChars = (s, cols) => cols.map ((col) => s[col]).join('');\nconst copyObjectStrChars = (obj, cols) => copy (obj, (s) => getStrChars (s, cols));\nconst copyObjectStrChars2 = (obj, cols) => copy (obj, (s) => copyObjectStrChars (s, cols));\n\nStockholm.prototype.extractColumns = function (colArray) {  // 0-indexed\n  const cols = this.columns();\n  const badCols = colArray.filter ((col) => col < 0 || col >= cols);\n  if (badCols.length)\n    error (\"Bad column indices: \" + badCols.join(','));\n  let stock = new Stockholm();\n  stock.seqname = this.seqname.slice(0);\n  stock.seqdata = copyObjectStrChars (this.seqdata, colArray);\n  stock.gf = copyObject (this.gf);\n  stock.gc = copyObjectStrChars (this.gc, colArray);\n  stock.gs = copyObject2 (this.gs);\n  stock.gr = copyObjectStrChars2 (this.gr, colArray);\n  return stock;\n}\n\nStockholm.prototype.extractColumnRange = function (startCol, endCol) {  // 0-indexed\n  return this.extractColumns (new Array(endCol+1-startCol).fill(0).map ((_val, n) => startCol + n));\n}\n\nStockholm.prototype.defaultGapChars = \".-\";\n\nStockholm.prototype.seqpos2col = function (seqname, gapChars) {\n  gapChars = gapChars || this.defaultGapChars;\n  if (!this.seqdata[seqname])\n    error (\"Row not found\");\n  const seq = this.seqdata[seqname];\n  return seq.split('').map ((c, col) => gapChars.indexOf (seq[col]) < 0 ? col : -1).filter ((col) => col >= 0);\n}\n\nStockholm.prototype.col2seqpos = function (seqname, gapChars) {\n  gapChars = gapChars || this.defaultGapChars;\n  if (!this.seqdata[seqname])\n    error (\"Row not found\");\n  const seq = this.seqdata[seqname];\n  let pos = -1;\n  return seq.split('').map ((c, col) => gapChars.indexOf (seq[col]) < 0 ? ++pos : (pos + 0.5));\n}\n\nfunction leftPad (text, width) {\n  while (text.length < width)\n    text = ' ' + text\n  return text\n}\n\nfunction rightPad (text, width) {\n  while (text.length < width)\n    text = text + ' '\n  return text\n}\n\nfunction space (width) {\n  return leftPad (\"\", width)\n}\n\nStockholm.prototype.toString = function (opts) {\n  opts = opts || { width: 80, indentNames: false }\n  const names = this.allNames(), cols = this.columns()\n  const nameWidth = Math.max.apply (null, names.map ((name) => name.length).concat([0]))\n  const tagWidth = Math.max.apply (null, this.allTags().map ((tag) => tag.length).concat([0]))\n  const seqIndent = tagWidth ? (tagWidth + 6) : 0;\n  const width = opts.width ? Math.max (1, opts.width - nameWidth - seqIndent - 1) : cols\n  const pad = opts.indentNames ? leftPad : rightPad\n  const padTagName = (opts.indentNames\n                      ? ((tag, name) => leftPad(tag,tagWidth) + \" \" + leftPad(name,nameWidth))\n                      : ((tag, name) => rightPad(tag+\" \"+name,tagWidth+nameWidth+1)))\n  let offsets = [0]\n  for (let offset = width; offset < cols; offset += width)\n    offsets.push (offset)\n  return \"# STOCKHOLM 1.0\\n\"\n    + Object.keys(this.gf).sort().map (tag => this.gf[tag].map((line) => \"#=GF \" + pad(tag,tagWidth) + \" \" + line + \"\\n\").join('')).join('')\n    + Object.keys(this.gs).sort().map (tag => Object.keys(this.gs[tag]).map((name) => this.gs[tag][name].map ((line) => \"#=GS \" + padTagName(tag,name) + \" \" + line + \"\\n\").join('')).join('')).join('')\n    + offsets.map ((offset) =>\n                   Object.keys(this.gc).sort().map (tag => \"#=GC \" + pad(tag,tagWidth) + space(nameWidth+2) + this.gc[tag].substr(offset,width) + \"\\n\").join('')\n                   + names.map ((name) => Object.keys(this.gr).filter ((tag) => this.gr[tag][name]).sort().map ((tag) => \"#=GR \" + padTagName(tag,name) + \" \" + this.gr[tag][name].substr(offset,width) + \"\\n\").join('')\n                                + (this.seqdata[name]\n                                   ? (pad(name,nameWidth+seqIndent)\n                                      + \" \" + this.seqdata[name].substr(offset,width) + \"\\n\")\n                                   : '')).join('')).join(\"\\n\")\n    + \"//\\n\"\n}\n\nStockholm.prototype.toFasta = function (opts) {\n  opts = opts || { width: 80 }\n  const cols = this.columns()\n  const width = opts.width || cols\n  let offsets = [0]\n  for (let offset = width; offset < cols; offset += width)\n    offsets.push (offset)\n  return this.allNames()\n    .map ((name) =>\n          (this.seqdata[name]\n           ? (\">\" + name + \"\\n\"\n              + offsets.map ((offset) => this.seqdata[name].substr (offset, width) + \"\\n\").join(''))\n           : ''))\n    .join('')\n}\n\nStockholm.prototype.toRowList = function (opts) {\n  return this.allNames()\n    .filter ((name) => this.seqdata[name])\n    .map ((name) => [name, this.seqdata[name]])\n}\n\nif (typeof(module) !== 'undefined')\n  module.exports = { sniff, validate, parse, parseAll, fromSeqIndex, fromRowList, Stockholm }\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\n// `thisNumberValue` abstract operation\n// https://tc39.es/ecma262/#sec-thisnumbervalue\nmodule.exports = uncurryThis(1.0.valueOf);\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar thisNumberValue = require('../internals/this-number-value');\nvar $repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar $RangeError = RangeError;\nvar $String = String;\nvar floor = Math.floor;\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar nativeToFixed = uncurryThis(1.0.toFixed);\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar multiply = function (data, n, c) {\n  var index = -1;\n  var c2 = c;\n  while (++index < 6) {\n    c2 += n * data[index];\n    data[index] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\n\nvar divide = function (data, n) {\n  var index = 6;\n  var c = 0;\n  while (--index >= 0) {\n    c += data[index];\n    data[index] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\n\nvar dataToString = function (data) {\n  var index = 6;\n  var s = '';\n  while (--index >= 0) {\n    if (s !== '' || index === 0 || data[index] !== 0) {\n      var t = $String(data[index]);\n      s = s === '' ? t : s + repeat('0', 7 - t.length) + t;\n    }\n  } return s;\n};\n\nvar FORCED = fails(function () {\n  return nativeToFixed(0.00008, 3) !== '0.000' ||\n    nativeToFixed(0.9, 0) !== '1' ||\n    nativeToFixed(1.255, 2) !== '1.25' ||\n    nativeToFixed(1000000000000000128.0, 0) !== '1000000000000000128';\n}) || !fails(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.es/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toIntegerOrInfinity(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    // TODO: ES2018 increased the maximum number of fraction digits to 100, need to improve the implementation\n    if (fractDigits < 0 || fractDigits > 20) throw new $RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (number !== number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return $String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(data, 0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(data, 1e7, 0);\n          j -= 7;\n        }\n        multiply(data, pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(data, 1 << 23);\n          j -= 23;\n        }\n        divide(data, 1 << j);\n        multiply(data, 1, 1);\n        divide(data, 2);\n        result = dataToString(data);\n      } else {\n        multiply(data, 0, z);\n        multiply(data, 1 << -e, 0);\n        result = dataToString(data) + repeat('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat('0', fractDigits - k) + result\n        : stringSlice(result, 0, k - fractDigits) + '.' + stringSlice(result, k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","'use strict';\nvar createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float32Array` constructor\n// https://tc39.es/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float32', function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n"],"names":["parseToRowData","text","split","slice","filter","line","trim","map","values","length","n1","n2","_","__","p","Error","filterContacts","data","minDistance","minProbability","_ref","Math","abs","getContactsObject","contacts","contactsObj","forEach","_ref3","Set","add","maxNumberOfContacts","max","Object","s","size","d3Color","scaleLinear","getHighlightEvent","type","target","residues","CustomEvent","detail","highlight","fr","join","bubbles","cancelable","NightingaleLinks","NightingaleTrack","constructor","_rawData","_linksData","_NightingaleLinks_contacts","set","willUpdate","changedProperties","has","this","__classPrivateFieldSet","createTrack","Array","isArray","selected","_a","__classPrivateFieldGet","svg","selectAll","remove","select","attr","width","height","on","event","classList","contains","undefined","isHold","refreshSelected","seqG","append","createFeatures","margins","_getColor","d","_dispatchSelectNode","dispatchEvent","from","concat","sort","linkList","keys","contactGroup","_b","_c","contactPoints","Number","enter","style","preventDefault","entries","_ref4","n2s","key","link","push","getRadius","isSelected","min","getSingleBaseWidth","arc","x1","getXFromSeqPosition","x2","h","transition","selectedLinks","includes","links","x","exit","refresh","__decorate","property","attribute","customElement","NightingaleManager","NightingaleManager_1","NightingaleElement","Map","protvistaElements","propertyValues","connectedCallback","super","addEventListener","changeListener","display","attributeChangedCallback","previousValue","newValue","applyAttributes","element","value","removeAttribute","setAttribute","register","unregister","delete","applyProperties","forElementId","querySelector","isRegisteredAttribute","attributeName","observedAttributes","e","handler","for","converter","fromAttribute","attributes","indexOf","toAttribute","String","state","number","lower","upper","toNumber","baseClamp","result","toFinite","remainder","nativeIsFinite","root","isFinite","nativeMin","func","precision","toInteger","pair","toString","object","k","v","FakeScroll","LitElement","overflow","overflowX","overflowY","fullHeight","fullWidth","positionX","positionY","_x","_y","onScroll","showX","showY","shouldShow","movement","xMovement","el","scrollLeft","yMovement","scrollTop","y","sourceEvent","checkOverflow","withX","withY","show","render","position","transform","childStyle","html","_templateObject2","_taggedTemplateLiteralLoose","object2style","_templateObject","updated","fakescroll","renderRoot","DraggingComponent","withZoom","withPosition","withDimensions","mouse","isMouseWithin","cursorState","uniqueId","round","random","ctxBuffers","ctx","canvasBuffers","currentContext","isInDragPhase","mouseHasMoved","mouseMovePosition","firstUpdated","container","document","getElementById","window","requestAnimationFrame","buffer","getContext","alpha","swapContexts","current","visibility","next","draw","clearRect","canvas","drawScene","zoomRefreshed","handleZooomChanged","cursor","flexShrink","canvasStyle","left","top","aLetterOffset","charCodeAt","drawTile","row","column","props","tileWidth","tileHeight","yPos","startYTile","xPos","startXTile","sequences","raw","sequence","colorSchemeName","colorScheme","getColor","overlayFactor","getOverlayFactor","canvasTile","residueTileCache","createTile","create","_ref2","drawResidue","drawImage","overlayConservation","conservation","letterIndex","floor","globalAlpha","fillStyle","fillRect","border","lineWidth","borderWidth","strokeStyle","borderColor","strokeRect","textColor","font","textFont","textBaseline","textAlign","fillText","i","endYTile","j","endXTile","other","array","iteratee","comparator","index","computed","isSymbol","baseExtremum","baseIteratee","baseLt","_temp","maxElements","cache","spec","cachedElements","invalidate","oldestKey","minBy","insertionTime","createElement","Date","now","updateTileSpecs","isEqual","Mouse","relative","changedTouches","mouseX","offsetX","mouseY","offsetY","rect","getBoundingClientRect","clientX","clientY","pageX","offsetLeft","pageY","offsetTop","console","log","absolute","wheelDelta","delta","deltaX","deltaY","movementX","movementY","isNaN","roundMod","mod","StaticSchemeClass","defaultColor","letter","DynSchemeClass","fun","opt","funCS","init","call","run","reset","A","R","N","D","C","Q","E","G","H","I","L","K","M","F","P","S","T","W","Y","V","B","X","Z","U","gaps","staticSchemes","aliphatic","aromatic","buried","Buried","buried_index","charged","cinema","J","O","Gap","clustal2","clustal","helix","Helix","helix_propensity","hydro","lesk","mae","negative","nucleotide","polar","positive","purine","Purine","purine_pyrimidine","serine_threonine","strand","Strand","strand_propensity","taylor","turn","Turn","turn_propensity","zappo","dynSchemes","baseRaw","pos","arguments","base","toUpperCase","progress","cons","schemesMgr","maps","assign","dyn","getScheme","scheme","color","addStaticScheme","name","addDynScheme","updateConservation","DEFAULT_COLOR_SCHEME","SequenceViewerComponent","_position","xPosOffset","yPosOffset","currentViewSequence","clamp","currentViewSequencePosition","maxLength","redrawStarted","redrawnTiles","colorSchemeManager","ColorScheme","showModBar","xGridSize","yGridSize","cacheElements","scrollBarPositionX","scrollBarPositionY","sequenceDisableDragging","mouseOverFeatureIds","renderTile","tileCache","tilingGridManager","movePosition","m","onPositionUpdate","oldPos","newPos","relativeMovement","sendEvent","updateScrollPosition","onMouseMove","eventData","currentPointerPosition","lastValue","currentMouseSequencePosition","features","lastMouseOverFeatureIds","sequencePositionToFeatureIds","onMouseLeave","onClick","id","onDoubleClick","CanvasCache","TilingGrid","bind","setProp","getColorMap","stats","nrXTiles","ceil","nrYTiles","disconnectedCallback","removeEventListener","positions","getTilePositions","drawTiles","drawHighlightedRegions","startY","startX","drawHighlightedRegion","feature","region","regionWidth","to","regionHeight","yPosFrom","xPosFrom","mouseOver","some","mouseOverFillColor","fillColor","mouseOverBorderColor","stroke","positionToSequence","seqNr","residue","sequencePosition","componentWillUnmount","residueTileSpecs","Boolean","Labels","labels","activeLabel","ul","ulStyle","padding","margin","label","reflect","conservationInlineWorkerString","sampleSize","isWorker","finalSampleSize","sequencesToLoopThrough","Float32Array","loopOffset","self","postMessage","DEAFULT_COLOR_SCHEME","NightingaleMSA","withManager","withResizable","withHighlight","withMargin","labelWidth","overlayConservtion","worker","Worker","URL","createObjectURL","Blob","onmessage","sequenceViewer","seqs","labelPanel","topMarginStyle","background","leftMarginStyle","rightMarginStyle","bottomMarginStyle","_templateObject3","getWidthWithMargins","_templateObject4","highlightedRegion","segments","start","end","NightingaleNavigation","_NightingaleNavigation_x","_NightingaleNavigation_dontDispatch","_NightingaleNavigation_svg","_NightingaleNavigation_displaystartLabel","_NightingaleNavigation_displayendLabel","_NightingaleNavigation_axis","_NightingaleNavigation_brushG","_NightingaleNavigation_polygon","_NightingaleNavigation_xAxis","_NightingaleNavigation_viewport","_NightingaleNavigation_highlighted","_NightingaleNavigation_margins","_NightingaleNavigation_currentSelection","createNavRuler","limit","range","domain","axisBottom","brushX","extent","HANDLE_SIZE","handleSize","selection","move","invert","extra","updateLabels","updatePolygon","getStart","getEnd","createHighlight","renderD3","updateHighlight","onDimensionsChange","_d","renderMarginOnGroup","locate","zoomOut","zoomIn","newStart","s1","s2","highlighs","merge","segment","highlighsRect","module","exports","Stockholm","obj","gf","gc","gs","gr","seqname","seqdata","prop","formatStartRegex","formatEndRegex","gfRegex","gcRegex","gsRegex","grRegex","lineRegex","nonwhiteRegex","noFormatStart","atLine","n","error","err","warning","warn","parseAll","opts","maybeWarning","quiet","maybeError","strict","db","stock","makeStock","match","test","exec","prototype","rows","columns","cols","tag","allNames","isName","names","addName","addNames","list","allTags","isTag","addTags","addRow","deleteRow","copy","copyFunc","copyObject","a","copyObject2","copyObjectStrChars","col","getStrChars","leftPad","rightPad","extractColumns","colArray","badCols","copyObjectStrChars2","extractColumnRange","startCol","endCol","fill","_val","defaultGapChars","seqpos2col","gapChars","seq","c","col2seqpos","indentNames","nameWidth","apply","tagWidth","seqIndent","pad","padTagName","offsets","offset","space","substr","toFasta","toRowList","sniff","validate","parse","fromSeqIndex","fromRowList","uncurryThis","valueOf","$","toIntegerOrInfinity","thisNumberValue","$repeat","fails","$RangeError","RangeError","$String","repeat","stringSlice","nativeToFixed","toFixed","pow","acc","multiply","c2","divide","dataToString","t","proto","forced","fractionDigits","z","fractDigits","sign","createTypedArrayConstructor","byteOffset"],"sourceRoot":""}